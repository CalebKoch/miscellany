{"version":3,"file":"/js/location/map.js","mappings":"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","sources":["webpack:///./resources/assets/js/location/map.js"],"sourcesContent":["/**\n * Map\n */\n\nvar mapModal, mapAdmin, locationInput, mapImage, mapImageOriginalWidth;\nvar mapPositionX, mapPositionY;\nvar mapZoomIn, mapZoomOut, mapZoomReset;\nvar mapToggleShow, mapToggleHide;\nvar mapZoomValue = 100, mapZoomIncrements = 0;\nvar mapDraggable, mapIsMoving = false, mapPointIsMoving = false;\nvar mapPointModalBody, mapPointModalLoading;\nvar mapMouseX, mapMouseY;\n\n// V2\nvar mapElement, mapPanel, mapPanelTarget, mapPanelLoader;\nvar mapAdminMode, mapViewMode, mapAdminModeActivated = false;\nvar mapHelper;\nvar mapEventFirstClick = true;\n\n$(document).ready(function() {\n    // Look for a form to save\n    mapAdmin = $('#location-map-admin');\n    mapPanel = $('#location-map-panel');\n    mapPanelTarget = $('#location-map-panel-target');\n    mapPanelLoader = $('#location-map-panel-loading');\n    mapModal = $('#point-location');\n    locationInput = $('#location_id');\n\n    mapImage = $('#location-map-image');\n    mapZoomIn = $('#map-zoom-in');\n    mapZoomOut = $('#map-zoom-out');\n    mapZoomReset = $('#map-zoom-reset');\n    mapToggleHide = $('#map-toggle-hide');\n    mapToggleShow = $('#map-toggle-show');\n\n    mapPointModalBody = $('#map-point-body');\n    mapPointModalLoading = $('.modal-loading');\n    mapDraggable = $('#draggable-map');\n\n    mapAdminMode = $('#map-admin-mode');\n    mapViewMode = $('#map-view-mode');\n    mapElement = $('.map');\n    mapHelper = $('.map-helper');\n\n    initLocationMap();\n});\n\nfunction initLocationMap() {\n    // Reset the zoom to the biggest value\n    var imgWidth = mapImage.width();\n\n    // If the image hasn't finished loading, let's try again in half a second\n    if (!imgWidth || imgWidth === 0) {\n        //console.log('map', 'waiting another 500 ms for the map to properly load');\n        setTimeout(initLocationMap, 500);\n        return false;\n    }\n\n    if (mapAdmin.length === 1) {\n        initMapAdmin();\n    }\n\n    initMapControls();\n    initPointClick();\n    initMapModeSwitch();\n    initMovePoints();\n    disableMovePoints();\n    //initAddPoints();\n    initMapScroll();\n    resizeMapToPage();\n    initMapLegend();\n}\n\n\n/**\n * Init Clicking on the Map\n */\nfunction initMapAdmin() {\n    var mapModalSubmit = $('#point-location-submit');\n    mapModalSubmit.on('click', function(e) {\n        // Check that a location was selected\n        if (locationInput.val()) {\n            mapAdmin.append(\n                '<div class=\"point admin\" style=\"top:' + mapPositionY + 'px;left:' + mapPositionX + 'px\">' +\n                '<input type=\"hidden\" name=\"map_point[]\" value=\"' + mapPositionX + '-' + mapPositionY + '-' + locationInput.val() + '\" />' +\n                '</div>'\n            );\n            mapModal.modal('toggle');\n        } else {\n\n        }\n    });\n\n    // Handle deleting already loaded points\n    initPointClick();\n}\n\n/**\n * Register click on the map zoom controls\n */\nfunction initMapControls() {\n    if (mapDraggable.length === 1) {\n\n        $('#draggable-map').draggable({\n            drag: function () {\n                mapIsMoving = true;\n            },\n            stop: function () {\n                // Don't update right away, this is a small hack to make sure we're not loading map points when moving\n                setTimeout(function() {\n                    mapIsMoving = false;\n                }, 200);\n            }\n        });\n\n        mapDraggable.mousemove(function (event) {\n            var offset = mapElement.offset();\n            mapMouseX = event.pageX - offset.left;\n            mapMouseY = event.pageY - offset.top;\n        });\n    }\n\n    if (mapZoomIn.length === 1) {\n        mapZoomIn.on('click', function (e) {\n            e.preventDefault();\n            mapZoom(25);\n        });\n        mapZoomOut.on('click', function (e) {\n            e.preventDefault();\n            mapZoom(-25);\n        });\n        mapZoomReset.on('click', function (e) {\n            e.preventDefault();\n            mapZoomValue = 100;\n            mapZoom(0);\n        });\n        mapToggleHide.on('click', function (e) {\n            e.preventDefault();\n            mapTogglePoints(false);\n        });\n        mapToggleShow.on('click', function (e) {\n            e.preventDefault();\n            mapTogglePoints(true);\n        });\n    }\n}\n\n/**\n * Zoom on the map\n * @param change\n * @returns {boolean}\n */\nfunction mapZoom(change) {\n    // Don't have the size yet? Calculate it. We don't calc on page load because if it's on a hidden tab,\n    // it evaluates to 0\n    var min = 10;\n    var max = 300;\n\n    if (!mapImageOriginalWidth) {\n        mapImageOriginalWidth = mapImage.width();\n    }\n    // Min/Max\n    var newZoom = mapZoomValue + change;\n    if (newZoom > max || newZoom < min) {\n        return false;\n    }\n\n    // mapDraggable.addClass('zooming-animation');\n    mapZoomOut.removeAttr('disabled');\n    mapZoomIn.removeAttr('disabled');\n    mapZoomValue = newZoom;\n\n    var magnifier = (mapZoomValue / 100);\n    mapImage.width(mapImageOriginalWidth * magnifier);\n\n    if (change > 0) {\n        mapZoomIncrements++;\n    } else {\n        mapZoomIncrements--;\n    }\n\n    $.each($('.point'), function() {\n        repositionPoint($(this), magnifier);\n    });\n\n    if (mapZoomValue <= min) {\n        mapZoomOut.attr('disabled', 'disabled');\n    } else if (newZoom >= max) {\n        mapZoomIn.attr('disabled', 'disabled');\n    }\n\n    // Move the map towards the position of the mouse\n    var pos = mapDraggable.position();\n    if (change > 0) {\n        // Zoom In, move the map to the top and left as an amount based on the mouse position\n        // new_map_x = map_x - (cursor_x / screen_max_width * (new_map_width - map_width))\n        mapDraggable\n            .css('left', pos.left - (mapMouseX / mapElement.width() * 100))\n            .css('top', pos.top - (mapMouseY / mapElement.height() * 100))\n            //.css('top', pos.top - (mapMouseY * 0.1))\n        ;\n    } else if (change < 0) {\n        mapDraggable\n            .css('left', pos.left + (mapMouseX / mapElement.width() * 100))\n            .css('top', pos.top + (mapMouseY / mapElement.height() * 100))\n            //.css('top', pos.top + (mapMouseY * 0.1))\n        ;\n    }\n\n    // setTimeout(() => {\n    //     mapDraggable.removeClass('zooming-animation');\n    // }, 300);\n}\n\n/**\n * Add update click on all points\n */\nfunction initPointClick() {\n    $.each($('.point'), function (index) {\n        $(this).unbind('click'); // remove previous bindings\n        $(this).on('click', function(e) {\n            // Need this first, so that if we are still moving, it doesn't move to location\n            e.preventDefault();\n\n            if (mapPointIsMoving === true) {\n                return;\n            }\n            loadMapPoint($(this));\n        });\n    });\n}\n\n/**\n * Toggle showing or hiding of points on the map\n * @param show\n */\nfunction mapTogglePoints(show) {\n    if (show) {\n        mapToggleHide.show();\n        mapToggleShow.hide();\n\n        $.each($('.map .point'), function() {\n            $(this).show();\n        });\n    } else {\n        mapToggleHide.hide();\n        mapToggleShow.show();\n\n        $.each($('.map .point'), function() {\n            $(this).hide();\n        });\n    }\n}\n\n/**\n * V2\n */\n\n/**\n * Load a map point into the side panel\n * @param element\n */\nfunction loadMapPoint(element) {\n    if (mapIsMoving === true || mapPointIsMoving === true) {\n        return;\n    }\n\n    // First things first, resize the map area to show the panel on the first click.\n    if (mapEventFirstClick) {\n        mapHelper.fadeOut();\n        mapEventFirstClick = false;\n    }\n\n    // Admin mode? Load the form modal\n    if (mapAdminModeActivated) {\n        showLoadingModal();\n\n        $.ajax({\n            url: element.data('url-modal')\n        }).done(function (result, textStatus, xhr) {\n            if (result) {\n                mapPointModalLoading.hide();\n                mapPointModalBody.html(result).show();\n                initModalForm();\n            }\n        }).fail(function (result, textStatus, xhr) {\n            console.log('map point error', result);\n        });\n\n        return;\n    }\n\n    // Want to load the side panel with the content.\n    if (mapPanel.hasClass('hidden')) {\n        mapPanel.removeClass('hidden');\n        $('#location-map-main').removeClass('col-md-12').addClass('col-md-9 col-sm-8');\n    }\n\n    mapPanelLoader.show();\n    mapPanelTarget.html('');\n\n    // Show the point as being focused, removing any previously focused point\n    $('.point-focus').removeClass('point-focus');\n    element.addClass('point-focus');\n\n    $.ajax(\n        element.data('url-show')\n    ).done(function(data) {\n        mapPanelLoader.hide();\n        mapPanelTarget.html(data);\n\n        // Closing the modal\n        $('.entity-close').on('click', function(e) {\n            //console.log('clicky');\n            hideMapPointDetails();\n        });\n    });\n}\n\n/**\n *\n */\nfunction hideMapPointDetails() {\n    mapPanel.addClass('hidden');\n    $('#location-map-main').removeClass('col-md-9 col-sm-8').addClass('col-md-12');\n}\n\n/**\n * Switch between Admin and View Mode\n */\nfunction initMapModeSwitch() {\n    mapAdminMode.click(function() {\n        $(this).hide();\n        mapAdminModeActivated = true;\n        mapViewMode.show();\n        mapElement.addClass('map-admin-mode');\n\n        activateMovePoints();\n        hideMapPointDetails();\n    });\n\n    mapViewMode.click(function() {\n        $(this).hide();\n        mapAdminModeActivated = false;\n        mapAdminMode.show();\n        mapElement.removeClass('map-admin-mode');\n\n        disableMovePoints();\n    });\n}\n\n/**\n * Open the modal to add a map point\n */\nfunction initAddPoints() {\n    mapImage.click(function(e) {\n        if (mapAdminModeActivated === false) {\n            return;\n        }\n\n        // Don't click if moving\n        if (mapPointIsMoving === true || mapIsMoving === true) {\n            return;\n        }\n\n        showLoadingModal();\n\n        var offset = $(this).offset();\n        mapPositionX = e.pageX - offset.left - 25;\n        mapPositionY = e.pageY - offset.top - 25;\n\n        // Don't allow negative positions\n        if (mapPositionX < 0) {\n            mapPositionX = 0;\n        }\n        if (mapPositionY < 0) {\n            mapPositionY = 0;\n        }\n\n        // Need to adapt the map position to the magnifier to know where we really are.\n        var magnifier = (mapZoomValue / 100);\n        mapPositionY = parseInt(mapPositionY) / magnifier;\n        mapPositionX = parseInt(mapPositionX) / magnifier;\n\n        $.ajax({\n            url: $(this).data('url') + '?axis_y=' + parseInt(mapPositionY) + '&axis_x=' + parseInt(mapPositionX)\n        }).done(function (result, textStatus, xhr) {\n            if (result) {\n                mapPointModalLoading.hide();\n                mapPointModalBody.html(result).show();\n                initModalForm();\n            }\n        }).fail(function (result, textStatus, xhr) {\n            console.log('map point error', result);\n        });\n    });\n}\n\n/**\n * Show the modal in a loading state\n */\nfunction showLoadingModal() {\n    mapPointModalLoading.show();\n    mapPointModalBody.html('');\n    mapModal.modal();\n}\n\n/**\n *\n */\nfunction initMovePoints() {\n    $.each($('.point'), function(index) {\n        addPointMove($(this));\n    });\n}\n\n/**\n * Enable dragging map points\n */\nfunction activateMovePoints() {\n    $.each($('.point'), function(index) {\n        $(this)\n            .draggable({disabled: false});\n    });\n}\n\n/**\n * Disable draggin map points\n */\nfunction disableMovePoints() {\n    $.each($('.point'), function(index) {\n        $(this)\n            .draggable({disabled: true});\n    });\n}\n\n/**\n * Add movable points\n * @param point\n */\nfunction addPointMove(point) {\n    point.draggable({\n        revert: false,\n        start: function(event, ui) {\n            //console.log('start moving point');\n            mapPointIsMoving = true;\n\n            var target = $(event.target);\n            target.addClass('point-moving');\n        },\n        stop: function (event, ui) {\n            // event.preventDefault();\n            var location = $(event.target);\n            location.removeClass('point-moving');\n\n            mapPositionX = ui.position.left;\n            mapPositionY = ui.position.top;\n\n            // Recalculate position based on zoom\n            var magnifier = (mapZoomValue / 100);\n            mapPositionX = mapPositionX / magnifier;\n            mapPositionY = mapPositionY / magnifier;\n\n            data = {\n                axis_x: mapPositionX,\n                axis_y: mapPositionY\n            };\n\n            console.log('url move', location.data('url-move'));\n            $.post(\n                location.data('url-move'),\n                data\n            ).done(function (result, textStatus, xhr) {\n                //event.preventDefault();\n            }).fail(function (result, textStatus, xhr) {\n                // console.log('map point error', result);\n            });\n\n            // We can wait for the ajax request to finish, as the user doesn't need to know that\n            // the event was done properly. This also allows directly clicking on a point\n            // after it was moved to view the form modal\n            setTimeout(() => {\n                mapPointIsMoving = false;\n            }, 50);\n\n\n            //$(this).removeClass('ui-draggable-dragging');\n\n            return true;\n        }\n    });\n}\n\n/**\n * Modal form submit catcher\n */\nfunction initModalForm() {\n    window.initForeignSelect();\n    initDeleteMapPoint();\n    initIconSelect();\n\n    var phaseFirst = $('.phase-first');\n    var phaseSecond = $('.phase-second');\n    var pointSave = $('.point-save');\n    var pointEntity = $('.point-entity');\n    var pointLabel = $('.point-label');\n\n    $('#phase-first-entity').on('click', function (e) {\n        e.preventDefault();\n        pointEntity.show();\n        phaseFirst.hide();\n        phaseSecond.show();\n        pointSave.show();\n    });\n\n    $('#phase-first-label').on('click', function (e) {\n        e.preventDefault();\n        pointLabel.show();\n        phaseFirst.hide();\n        phaseSecond.show();\n        pointSave.show();\n    });\n\n    $('.phase-undo').on('click', function (e) {\n        e.preventDefault();\n        phaseSecond.hide();\n        pointSave.hide();\n        pointEntity.hide();\n        pointLabel.hide();\n        phaseFirst.show();\n    })\n\n    $('.map-point-form').submit(function (e) {\n        var formData = $(this).serialize();\n\n        $.ajax({\n            type        : $(this).attr('method'),\n            url         : $(this).attr('action'),\n            data        : formData,\n            dataType    : 'json',\n            encode          : true\n        }).done(function (data) {\n            mapModal.modal('hide');\n            if (data.point) {\n                // Remove existing one?\n                var existing = $('#' + data.id);\n                if (existing.length === 1) {\n                    existing.remove();\n                }\n\n                $('.map-container').append(data.point);\n                initPointClick();\n\n                // Make the new point movable and add tooltip\n                var newPoint = $('#' + data.id);\n                addPointMove(newPoint);\n\n                var magnifier = (mapZoomValue / 100);\n                repositionPoint(newPoint, magnifier);\n\n                newPoint.tooltip();\n            }\n        }).fail(function (data) {\n            console.log('fail', data);\n            if (data.responseJSON.errors) {\n                $('.location-map-errors').html(buildErrors(data.responseJSON.errors)).fadeIn();\n            }\n        });\n\n        e.preventDefault();\n    });\n\n    $('[data-toggle=\"popover\"]').popover({html:true});\n}\n\n/**\n * Register an event listener on map point delete button. Since this is in a popover,\n * we need to register on the document listener rather than the element directly.\n */\nfunction initDeleteMapPoint() {\n    $(document).on('click', '.map-point-delete', function(e) {\n        var url = $(this).attr('href');\n        e.preventDefault();\n\n        mapPointModalBody.hide();\n        mapPointModalLoading.show();\n\n        $.post({\n            url: url,\n            dataType: 'json',\n            data: {\n                '_method': 'DELETE'\n            },\n            context: this\n        }).done(function (result, textStatus, xhr) {\n            // Hide this\n            if (result.id) {\n                $('#' + result.id).remove();\n            }\n            mapModal.modal('hide');\n        });\n\n        return false;\n    });\n}\n\n/**\n *\n * @param data\n * @returns {string}\n */\nfunction buildErrors(data) {\n    var errors = '';\n    for (var key in data) {\n        // skip loop if the property is from prototype\n        if (!data.hasOwnProperty(key)) continue;\n\n        errors += data[key] + \"<br>\";\n    }\n    return errors;\n}\n\n/**\n * Handle scroll\n */\nfunction initMapScroll() {\n    $(mapImage).bind('wheel', function(event) {\n        if (event.ctrlKey === true) {\n            event.preventDefault();\n            // console.log('wheel', event.originalEvent.deltaY);\n            if (event.originalEvent.deltaY > 0) {\n                mapZoom(-10);\n            } else {\n                mapZoom(10);\n            }\n        }\n    });\n}\n\n/**\n * Reposition a point on the map\n * @param point\n * @param magnifier\n */\nfunction repositionPoint(point, magnifier) {\n    point.css('top', (point.data('top') * magnifier) + 'px');\n    point.css('left', (point.data('left') * magnifier)+ 'px');\n    point.css('width', (point.data('size') * magnifier)+ 'px');\n    point.css('height', (point.data('size')  * magnifier)+ 'px');\n    //$(this).css('border-radius', (25 * magnifier)+ 'px');\n\n    var fontSize = 24;\n    if (point.data('size') === 10) {\n        fontSize = 5;\n    } else if (point.data('size') === 25) {\n        fontSize = 12;\n    } else if (point.data('size') === 100) {\n        fontSize = 56;\n    } else if (point.data('size') === 200) {\n        fontSize = 108;\n    }\n    point.css('font-size', (fontSize * magnifier) + 'px');\n}\n\n/**\n * Resize the map to the map div on page load\n */\nfunction resizeMapToPage() {\n    // Reset the zoom to the biggest value\n    var imgWidth = mapImage.width();\n\n    $('.loading-map').hide();\n\n    var imgHeight = mapImage.height();\n    //console.log('img width, height', imgWidth, imgHeight);\n\n    // Get the view box width and height\n    var mapWidth = mapElement.width();\n    var mapHeight = mapElement.height();\n    //console.log('div width, height', mapWidth, mapHeight);\n\n    // Resize zoom. Always use the width.\n    var ratio = mapWidth / imgWidth;\n\n    mapZoomValue = Math.floor(100 * ratio);\n    mapZoom(0);\n}\n\n/**\n *\n * @param state\n * @returns {*}\n */\nfunction formatState (state) {\n    // Searching...\n    if (!state.id) {\n        return state.text;\n    }\n\n    var element = $(state.element);\n    if (!element) {\n        return state.text;\n    }\n    var icon = element.data('icon');\n    // If there is no icon, use the id\n    if (!icon) {\n        icon = 'ra ra-' + state.id;\n    }\n    else if (icon === 'entity') {\n        return state.text;\n    }\n    // If the icon has no space, it's probably not rpg-awesome\n    else if (!icon.includes(' ')) {\n        icon = 'ra ra-' + icon;\n    }\n\n    var $state = $(\n        '<span><i class=\"' + icon + '\"></i> ' + state.text + '</span>'\n    );\n    return $state;\n};\n\n/**\n * Shape state\n * @param state\n * @returns {jQuery|HTMLElement|*}\n */\nfunction formatShapeState (state) {\n    if (state.id === 'none') {\n        return state.text;\n    }\n\n    var $state = $(\n        '<span><i class=\"fa-solid fa-' + state.id + '\"></i> ' + state.text + '</span>'\n    );\n    return $state;\n}\n/**\n *\n */\nfunction initIconSelect() {\n    $(\".select2-icon\").select2({\n        templateResult: formatState,\n        templateSelection: formatState,\n        language: $(this).data('language')\n    });\n    $(\".spectrum\").spectrum({\n        preferredFormat: \"hex\",\n        showInput: true,\n        showPalette: true,\n        allowEmpty:true\n    });\n    $(\".select2-shape\").select2({\n        templateResult: formatShapeState,\n        templateSelection: formatShapeState,\n        language: $(this).data('language')\n    });\n}\n\n/**\n * Clicking on a map legend should center the map on the point\n */\nfunction initMapLegend() {\n    $(\".map-point-legend\").click(function() {\n        // Reposition the map to center on the clicked part\n        let target = $($(this).attr('href'));\n        // let targetPosition = target.position();\n        // let left =  (mapElement.width() - targetPosition.left) / 3;\n        // let top = (mapElement.height() - targetPosition.top) / 2 ;\n        // let mapWidth = mapElement.width();\n        // mapDraggable\n        //     .css('top', top + 'px')\n        //     .css('left', left + 'px');\n        target.click();\n    });\n}\n"],"names":["mapModal","mapAdmin","locationInput","mapImage","mapImageOriginalWidth","mapPositionX","mapPositionY","mapZoomIn","mapZoomOut","mapZoomReset","mapToggleShow","mapToggleHide","mapZoomValue","mapZoomIncrements","mapDraggable","mapIsMoving","mapPointIsMoving","mapPointModalBody","mapPointModalLoading","mapMouseX","mapMouseY","mapElement","mapPanel","mapPanelTarget","mapPanelLoader","mapAdminMode","mapViewMode","mapAdminModeActivated","mapHelper","mapEventFirstClick","$","document","ready","initLocationMap","imgWidth","width","setTimeout","length","initMapAdmin","initMapControls","initPointClick","initMapModeSwitch","initMovePoints","disableMovePoints","initMapScroll","resizeMapToPage","initMapLegend","mapModalSubmit","on","e","val","append","modal","draggable","drag","stop","mousemove","event","offset","pageX","left","pageY","top","preventDefault","mapZoom","mapTogglePoints","change","min","max","newZoom","removeAttr","magnifier","each","repositionPoint","attr","pos","position","css","height","index","unbind","loadMapPoint","show","hide","element","fadeOut","showLoadingModal","ajax","url","data","done","result","textStatus","xhr","html","initModalForm","fail","console","log","hasClass","removeClass","addClass","hideMapPointDetails","click","activateMovePoints","initAddPoints","parseInt","addPointMove","disabled","point","revert","start","ui","target","location","axis_x","axis_y","post","window","initForeignSelect","initDeleteMapPoint","initIconSelect","phaseFirst","phaseSecond","pointSave","pointEntity","pointLabel","submit","formData","serialize","type","dataType","encode","existing","id","remove","newPoint","tooltip","responseJSON","errors","buildErrors","fadeIn","popover","context","key","hasOwnProperty","bind","ctrlKey","originalEvent","deltaY","fontSize","imgHeight","mapWidth","mapHeight","ratio","Math","floor","formatState","state","text","icon","includes","$state","formatShapeState","select2","templateResult","templateSelection","language","spectrum","preferredFormat","showInput","showPalette","allowEmpty"],"sourceRoot":""}