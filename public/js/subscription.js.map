{"version":3,"file":"/js/subscription.js","mappings":"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","sources":["webpack:///./resources/assets/js/subscription.js"],"sourcesContent":["// Strip variables for the page\nvar stripe, elements, card;\n\n// Form status\nvar formSubmit = false;\nvar formSubmitBtn;\n\n// Coupon stuff\nvar couponBtn, couponField, couponSuccess, couponError, couponId;\n\nvar subscribeModal;\n\n$(document).ready(function() {\n    initStripe();\n    initPeriodToggle();\n    subscribeModal = $('#subscribe-confirm');\n    subscribeModal.on('shown.bs.modal', () => {\n        initConfirmListener();\n    });\n});\n\n// Initialize the stripe API\nfunction initStripe() {\n    let token = $('#stripe-token');\n    stripe = Stripe(token.val());\n\n    // Create an instance of Elements.\n    elements = stripe.elements();\n}\n\n// When the modal is opened and loaded, inject stripe if needed and the form validator\nfunction initConfirmListener()\n{\n    formSubmitBtn = $('.subscription-confirm-button');\n\n    let cardSelector = $('#card-element');\n    if (cardSelector.length === 1) {\n        // First time opening the modal, initiate a new card\n        if (!card) {\n            // Custom styling can be passed to options when creating an Element.\n            // (Note that this demo uses a wider set of styles than the guide below.)\n            let style = {\n                base: {\n                    color: '#555555',\n                    fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n                    fontSmoothing: 'antialiased',\n                    fontSize: '14px',\n                    '::placeholder': {\n                        color: '#777777'\n                    }\n                },\n                invalid: {\n                    color: '#fa755a',\n                    iconColor: '#fa755a'\n                }\n            };\n\n            // Create an instance of the card Element.\n            card = elements.create('card', {hidePostalCode: true, style: style});\n        }\n\n        // Add an instance of the card Element into the `card-element` <div>.\n        card.mount('#card-element');\n    }\n\n    $('#subscription-confirm').submit(function (e) {\n        // If we've passed the strip validation, we can go further\n        if (formSubmit) {\n            return true;\n        }\n\n        e.preventDefault();\n        formSubmitBtn.addClass('disabled');\n        formSubmitBtn.find('span').hide();\n        formSubmitBtn.find('.spinner').show();\n\n        let intentToken = $('input[name=\"subscription-intent-token\"]');\n        let errorMessage = $('.alert-danger');\n        errorMessage.hide();\n\n        // If the form already has a payment id, we don't need stripe to add the new one\n        let cardID = $('input[name=\"payment_id\"]');\n        if (cardID.val()) {\n            formSubmit = true;\n            $('#subscription-confirm').submit();\n            return false;\n        }\n\n        stripe.confirmCardSetup(\n            intentToken.val(), {\n                payment_method: {\n                    card: card,\n                    billing_details: {\n                        name: $('input[name=\"card-holder-name\"]').val()\n                    }\n                }\n            }\n        ).then(function (result) {\n            if (result.error) {\n                formSubmitBtn.removeClass('disabled').text(formSubmitBtn.data('text'));\n                errorMessage.text(result.error.message).show();\n                return false;\n            } else {\n                cardID.val(result.setupIntent.payment_method);\n                formSubmit = true;\n                $('#subscription-confirm').submit();\n\n            }\n        }.bind(this));\n    });\n\n    $('.subscription-form').submit(function () {\n        formSubmitBtn.addClass('disabled')\n            .find('span').hide()\n            .parent().find('.spinner').show();\n\n        return true;\n    });\n\n    couponBtn = $('#coupon-check-btn');\n    couponField = $('#coupon-check');\n    couponSuccess = $('#coupon-success');\n    couponError = $('#coupon-invalid');\n    couponId = $('#coupon');\n\n    couponBtn.click(function () {\n        checkCoupon();\n    });\n    couponField.change(function() {\n        checkCoupon();\n    });\n    couponField.focus(function () {\n        formSubmitBtn.addClass('disabled').prop('disabled', true);\n    });\n    couponField.focusout(function () {\n        let coupon = couponField.val();\n        if (!coupon) {\n            formSubmitBtn.removeClass('disabled').prop('disabled', false);\n        }\n    });\n}\n\nfunction checkCoupon() {\n    let coupon = couponField.val();\n    let url = couponField.data('url');\n\n    couponBtn.prop('disabled', true)\n        .find('.check').hide()\n        .parent().find('.spinner').show();\n\n    if (!coupon) {\n        formSubmitBtn.removeClass('disabled').prop('disabled', false);\n    }\n\n    $.ajax({\n        url: url + '?coupon=' + coupon,\n        context: this\n    }).done(function (result) {\n        couponBtn\n            .prop('disabled', false)\n            .find('.check').show()\n            .parent().find('.spinner').hide();\n\n        formSubmitBtn.removeClass('disabled').prop('disabled', false);\n\n        if (!result.valid) {\n            couponSuccess.hide();\n            couponError.html(result.error).show();\n            couponId.val('');\n            subscribeModal.removeClass('valid-coupon');\n\n            return;\n        }\n\n        couponError.hide();\n        couponSuccess.html(result.discount).show();\n        couponId.val(result.coupon);\n        subscribeModal.addClass('valid-coupon');\n    }).fail(function (result) {\n        couponBtn\n            .prop('disabled', false)\n            .find('.check').show()\n            .parent().find('.spinner').hide();\n\n        if (result.responseJSON) {\n            couponError.html(result.responseJSON.message).show();\n        }\n    });\n}\n\nfunction initPeriodToggle() {\n    $('input[name=\"period\"]').change(function () {\n        let box = $('#pricing-overview');\n        console.log('checked?', this.checked);\n        if (this.checked) {\n            box.removeClass('period-month').addClass('period-year');\n        } else {\n            box.removeClass('period-year').addClass('period-month');\n        }\n    });\n}\n"],"names":["stripe","elements","card","formSubmit","formSubmitBtn","couponBtn","couponField","couponSuccess","couponError","couponId","subscribeModal","$","document","ready","initStripe","initPeriodToggle","on","initConfirmListener","token","Stripe","val","cardSelector","length","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","create","hidePostalCode","mount","submit","e","preventDefault","addClass","find","hide","show","intentToken","errorMessage","cardID","confirmCardSetup","payment_method","billing_details","name","then","result","error","removeClass","text","data","message","setupIntent","bind","parent","click","checkCoupon","change","focus","prop","focusout","coupon","url","ajax","context","done","valid","html","discount","fail","responseJSON","box","console","log","checked"],"sourceRoot":""}