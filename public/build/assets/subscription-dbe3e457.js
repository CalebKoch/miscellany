var p,C,r,c=!1,o,a,u,s,m,d,f,t;$(document).ready(function(){g(),y(),f=$("#subscribe-confirm"),$(document).on("shown.bs.modal",()=>{S()})});function g(){let n=$("#stripe-token");p=Stripe(n.val()),C=p.elements()}function S(){if(o=$(".subscription-confirm-button"),$("#card-element").length===1){if(!r){let i={base:{color:"#555555",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:"#777777"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}};r=C.create("card",{hidePostalCode:!0,style:i})}r.mount("#card-element")}$("#subscription-confirm").submit(function(i){if(c)return!0;i.preventDefault(),o.addClass("disabled").addClass("loading"),o.prop("disabled","disabled");let e=$('input[name="subscription-intent-token"]'),h=$(".alert-error");h.hide();let v=$('input[name="payment_id"]');if(v.val())return c=!0,$("#subscription-confirm").submit(),!1;p.confirmCardSetup(e.val(),{payment_method:{card:r,billing_details:{name:$('input[name="card-holder-name"]').val()}}}).then((function(l){if(l.error)return o.removeClass("disabled").removeClass("loading"),o.prop("disabled",""),h.text(l.error.message).show(),!1;v.val(l.setupIntent.payment_method),c=!0,$("#subscription-confirm").submit()}).bind(this))}),$(".subscription-form").submit(function(){return o.addClass("disabled").find("span").hide().parent().find(".spinner").show(),!0}),a=$("#coupon-check"),u=$("#coupon-success"),s=$("#coupon-invalid"),m=$("#coupon"),d=$("#coupon-validating"),a.change(function(){b()}),a.focusout(function(){b()})}function b(){let n=a.val(),i=a.data("url");n||o.removeClass("disabled").prop("disabled",!1),d.removeClass("hidden"),fetch(i+"&coupon="+n).then(e=>e.json()).then(e=>{if(o.removeClass("disabled").prop("disabled",!1),d.addClass("hidden"),!e.valid){u.hide(),s.html(e.error).show(),m.val(""),f.removeClass("valid-coupon");return}$("#pricing-now").html(e.price),s.hide(),u.html(e.discount).show(),m.val(e.coupon),f.addClass("valid-coupon")}).catch(e=>{d.addClass("hidden"),e.responseJSON&&s.html(e.responseJSON.message).show()})}function y(){t=$("#pricing-overview"),$('input[name="period"]').change(function(){this.checked?t.removeClass("period-month").addClass("period-year"):t.removeClass("period-year").addClass("period-month")}),$('input[name="period"]').is(":checked")&&t.removeClass("period-month").addClass("period-year")}
