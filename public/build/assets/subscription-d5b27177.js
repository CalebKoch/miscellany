var c,v,t,l=!1,o,a,i,p,r,u,f;$(document).ready(function(){C(),k(),f=$("#subscribe-confirm"),$(document).on("shown.bs.modal",()=>{g()})});function C(){let n=$("#stripe-token");c=Stripe(n.val()),v=c.elements()}function g(){if(o=$(".subscription-confirm-button"),$("#card-element").length===1){if(!t){let s={base:{color:"#555555",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:"#777777"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}};t=v.create("card",{hidePostalCode:!0,style:s})}t.mount("#card-element")}$("#subscription-confirm").submit(function(s){if(l)return!0;s.preventDefault(),o.addClass("disabled").addClass("loading"),o.prop("disabled","disabled");let e=$('input[name="subscription-intent-token"]'),m=$(".alert-error");m.hide();let h=$('input[name="payment_id"]');if(h.val())return l=!0,$("#subscription-confirm").submit(),!1;c.confirmCardSetup(e.val(),{payment_method:{card:t,billing_details:{name:$('input[name="card-holder-name"]').val()}}}).then(function(d){if(d.error)return o.removeClass("disabled").removeClass("loading"),o.prop("disabled",""),m.text(d.error.message).show(),!1;h.val(d.setupIntent.payment_method),l=!0,$("#subscription-confirm").submit()}.bind(this))}),$(".subscription-form").submit(function(){return o.addClass("disabled").find("span").hide().parent().find(".spinner").show(),!0}),a=$("#coupon-check-btn"),i=$("#coupon-check"),p=$("#coupon-success"),r=$("#coupon-invalid"),u=$("#coupon"),a.click(function(){b()}),i.change(function(){b()}),i.focus(function(){o.addClass("disabled").prop("disabled",!0)}),i.focusout(function(){i.val()||o.removeClass("disabled").prop("disabled",!1)})}function b(){let n=i.val(),s=i.data("url");a.prop("disabled",!0).find(".check").hide().parent().find(".spinner").show(),n||o.removeClass("disabled").prop("disabled",!1),fetch(s+"?coupon="+n).then(e=>e.json()).then(e=>{if(a.prop("disabled",!1).find(".check").show().parent().find(".spinner").hide(),o.removeClass("disabled").prop("disabled",!1),!e.valid){p.hide(),r.html(e.error).show(),u.val(""),f.removeClass("valid-coupon");return}r.hide(),p.html(e.discount).show(),u.val(e.coupon),f.addClass("valid-coupon")}).catch(e=>{a.prop("disabled",!1).find(".check").show().parent().find(".spinner").hide(),e.responseJSON&&r.html(e.responseJSON.message).show()})}function k(){$('input[name="period"]').change(function(){let n=$("#pricing-overview");console.log("checked?",this.checked),this.checked?n.removeClass("period-month").addClass("period-year"):n.removeClass("period-year").addClass("period-month")})}
