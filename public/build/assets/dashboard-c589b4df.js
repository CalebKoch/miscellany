import{a as u}from"./ajax-modal-1230002e.js";import{S as w}from"./sortable.esm-be94e56d.js";let r,d,l,a;var f=new IntersectionObserver(function(t){t.forEach(e=>{e.isIntersecting&&b(t[0].target)})},{threshold:[0]});$(document).ready(function(){$("[data-render]").length>0&&document.querySelectorAll("[data-render]").forEach(t=>{t&&f.observe(t)}),$(".preview-switch").click(function(t){t.preventDefault();var e=$("#widget-preview-body-"+$(this).data("widget"));e.hasClass("max-h-52")?(e.removeClass("max-h-52"),$(this).html('<i class="fa-solid fa-chevron-up"></i>'),$(this).parent().find(".gradient-to-base-100").hide()):(e.addClass("max-h-52"),$(this).html('<i class="fa-solid fa-chevron-down"></i>'),$(this).parent().find(".gradient-to-base-100").show())}),$(".campaign-dashboard-widgets").length===1&&m(),h(),s(),p(),v(),x()});function m(){$("#new-widget"),$("#new-widget-preview"),$("#new-widget-calendar"),$("#new-widget-recent"),r=$("#btn-add-widget"),d=$("#modal-content-buttons"),l=$("#modal-content-target"),a=$("#modal-content-spinner"),$(".widget-list > a").click(function(e){e.preventDefault(),g($(this).data("url"))}),r.click(function(){a.hide(),l.html(""),d.show()});let t=document.getElementById("widgets");new w(t,{handle:".handle",onEnd:function(e){$.post({url:$("#widgets").data("url"),dataType:"json",data:$('input[name="widgets[]"]').serialize()}).done(function(n){n.success&&n.message&&window.showToast(n.message)})}}),$(document).on("shown.bs.modal shown.bs.popover",function(){$("#summernote-config").length>0&&window.initSummernote(),$.each($('[data-img="delete"]'),function(){$(this).click(function(n){n.preventDefault(),$("input[name="+$(this).data("target")+"]")[0].value=1,$(this).parent().parent().hide()})}),c()})}function g(t){$("#edit-widget .modal-content").html(""),d.hide(),a.show(),$.ajax(t).done(function(e){a.hide(),l.html(e),window.initForeignSelect(),window.initTags(),c()})}function c(){$(".recent-entity-type").change(function(){this.value?$(".recent-filters").show():$(".recent-filters").hide()})}function h(){$(".widget-recent-more").click(function(t){t.preventDefault(),$(this).find(".spinner").show(),$(this).find("span").hide(),$.ajax({url:$(this).data("url"),context:this}).done(function(e){$(this).closest(".widget-recent-list").append(e),$(this).remove(),h(),window.ajaxTooltip()})})}function s(){$(".widget-calendar-switch").unbind("click").click(function(t){t.preventDefault();let e=$(this).data("url"),n=$(this).data("widget");$("#widget-body-"+n).hide(),$("#widget-loading-"+n).show(),$.ajax({url:e,method:"POST",context:this}).done(function(i){if(i){let o=$(this).data("widget");$("#widget-loading-"+o).hide(),$("#widget-body-"+o).html(i).show(),window.ajaxTooltip(),s()}})})}function p(){var t=$("#campaign-follow"),e=$("#campaign-follow-text");if(t.length===1){var n=t.data("following");n?e.html(t.data("unfollow")):e.html(t.data("follow")),t.show(),t.click(function(i){i.preventDefault(),$.post({url:$(this).data("url"),method:"POST"}).done(function(o){o.following?e.html(t.data("unfollow")):e.html(t.data("follow"))})})}}function v(){$.each($('[data-toggle="preview"]'),function(){$(this).height()===parseInt($(this).css("max-height"))?$(this).next().removeClass("hidden"):$(this).removeClass("pinned-entity preview")})}function b(t){t=$(t),$.ajax({url:t.data("render"),context:this}).done(function(e){let n=t.data("id");$("#widget-loading-"+n).hide(),$("#widget-body-"+n).html(e).show(),window.ajaxTooltip(),u(),s()})}function x(){document.querySelectorAll("[data-pulse]").forEach(t=>{t.addEventListener("click",y)})}function y(t){t.preventDefault();let e=document.querySelector(this.dataset.pulse),n=this.dataset.content;window.showTooltip(e,{content:n,theme:"kanka",placement:"bottom",allowHTML:!0,arrow:!0,interactive:!0,trigger:"manual"})}
