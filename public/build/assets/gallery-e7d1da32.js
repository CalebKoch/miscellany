import{a as y}from"./index-0b481a1e.js";import"./_commonjsHelpers-725317a4.js";var f,i,s,n,p,l,c,u;$(document).ready(function(){w(),v(),d()});function w(){f=$("#gallery-loader"),i=$("#gallery-images"),s=$("#gallery-search"),l=document.getElementById("gallery-form"),$(".uploader"),n=$(".progress"),$("#file-upload"),p=$(".gallery-error");let o=$("#gallery-config");c=o.data("max"),u=o.data("error"),s.on("blur",function(e){e.preventDefault(),g()}).bind("keydown",function(e){e.key==="Enter"&&(e.preventDefault(),g())}),l.ondrop=e=>{if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.items){let a=new FormData,r=0;if([...e.dataTransfer.items].forEach((t,E)=>{t.kind==="file"&&(a.append("file[]",t.getAsFile()),r++)}),r>c){h();return}m(a),l.classList.remove("drop-shadow","dropping")}else[...e.dataTransfer.files].forEach((a,r)=>{})},l.ondragover=e=>{e.preventDefault(),l.classList.add("drop-shadow","dropping"),console.log("drag start")},l.ondragleave=e=>{l.classList.remove("drop-shadow","dropping"),console.log("drag end")}}function g(){i.hide(),f.show(),$.ajax({url:s.data("url")+"?q="+s.val()}).done(function(o){f.hide(),i.html(o).show(),d()})}function v(){l.onchange=o=>{o.preventDefault();let e=document.getElementById("file-upload");if(e.files.length>c){h();return}var a=new FormData;Array.from(e.files).forEach(r=>{a.append("file[]",r)}),m(a)}}const h=()=>{window.showToast(u,"toast-error")},m=o=>{var e={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(a){let r=Math.round(a.loaded*100/a.total);$(".progress .progress-bar").css("width",r+"%")}};n.show(),console.log("data",o),o.forEach(a=>{console.log("foreach",a)}),y.post(l.action,o,e).then(function(a){console.info("then",a),console.log("data",a.data),n.hide(),a.data.success&&(a.data.images.forEach(r=>{let t=$("li[data-folder]").last();t.length===1?(console.log("last",t[0]),$(r).insertAfter($("li[data-folder]").last())):i.prepend(r)}),d())}).catch(function(a){n.hide(),a.response&&a.response.data.message&&p.text(a.response.data.message).fadeToggle(),d()})};function d(){$("#gallery-images li").unbind("click").on("click",function(){let o=$(this).data("folder");if(o){window.location=o;return}$.ajax({url:$(this).data("url")}).done(function(e){$("#large-modal-content").html(e),$("#large-modal").modal("show")})})}
