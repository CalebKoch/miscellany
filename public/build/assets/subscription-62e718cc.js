let m,g,a,i,c,r,s,p,l;const v=document.getElementById("subscribe-confirm"),b=()=>{h(),S(),window.onEvent(function(){L()})},h=()=>{const e=document.getElementById("stripe-token");m=Stripe(e.value),g=m.elements()},L=()=>{var t;if(i=document.querySelector(".subscription-confirm-button"),document.getElementById("card-element")){if(!a){let o={base:{color:"#555555",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:"#777777"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}};a=g.create("card",{hidePostalCode:!0,style:o})}a.mount("#card-element")}(t=document.getElementById("subscription-confirm"))==null||t.addEventListener("submit",y),c=document.getElementById("coupon-check"),c&&(r=document.getElementById("coupon-success"),s=document.getElementById("coupon-invalid"),p=document.getElementById("coupon"),l=document.getElementById("coupon-validating"),c.addEventListener("change",f),c.addEventListener("focusout",f))},f=e=>{const t=e.target,o=t.value,d=t.dataset.url;o||(i.classList.remove("btn-disabled","loading"),i.disabled=!1),l.classList.remove("hidden"),fetch(d+"&coupon="+o).then(n=>n.json()).then(n=>{if(i.classList.remove("btn-disabled","loading"),i.disabled=!1,l.classList.add("hidden"),!n.valid){r.classList.add("hidden"),s.innerHTML=n.error,s.classList.remove("hidden"),p.value="",v.classList.remove("valid-coupon");return}document.getElementById("pricing-now").innerHTML=n.price,s.classList.add("hidden"),r.innerHTML=n.discount,r.classList.remove("hidden"),p.value=n.coupon,v.classList.add("valid-coupon")}).catch(n=>{l.classList.add("hidden"),n.responseJSON&&(s.innerHTML=n.responseJSON.message,s.classList.remove("hidden"))})},y=e=>{const t=e.target;if(t.dataset.valid)return!0;e.preventDefault(),E(e);const o=document.querySelector('input[name="subscription-intent-token"]'),d=document.querySelector(".alert-error");d.classList.add("hidden");const n=document.querySelector('input[name="payment_id"]');if(n.value)return t.dataset.valid="1",t.requestSubmit(),!1;m.confirmCardSetup(o.value,{payment_method:{card:a,billing_details:{name:document.querySelector('input[name="card-holder-name"]').value}}}).then((function(u){if(u.error)return i.classList.remove("disabled","loading"),i.disabled="",d.innerHTML=u.error.message,d.classList.remove("hidden"),!1;n.value=u.setupIntent.payment_method,t.dataset.valid="1",t.requestSubmit()}).bind(globalThis))};function S(){const e=document.getElementById("pricing-overview"),t=document.querySelector('input[name="period"]');t.addEventListener("change",function(){this.checked?(e.classList.remove("period-month"),e.classList.add("period-year")):(e.classList.remove("period-year"),e.classList.add("period-month"))}),t.checked&&(e.classList.remove("period-month"),e.classList.add("period-year"))}const E=e=>{const o=e.target.querySelector(".subscription-confirm-button");return o.classList.add("disabled","loading"),o.disabled=!0,!0};b();
