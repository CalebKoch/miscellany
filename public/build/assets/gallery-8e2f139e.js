import{a as w}from"./index-0b481a1e.js";import"./_commonjsHelpers-725317a4.js";var f,i,d,n,g,t,p,m;$(document).ready(function(){v(),E(),s()});function v(){f=$("#gallery-loader"),i=$("#gallery-images"),d=$("#gallery-search"),t=document.getElementById("gallery-form"),$(".uploader"),n=$(".progress"),$("#file-upload"),g=$(".gallery-error");let r=$("#gallery-config");p=r.data("max"),m=r.data("error"),d.on("blur",function(e){e.preventDefault(),u()}).bind("keydown",function(e){e.key==="Enter"&&(e.preventDefault(),u())}),t.ondrop=e=>{if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.items){let a=new FormData,o=0;if([...e.dataTransfer.items].forEach((c,F)=>{c.kind==="file"&&(a.append("file[]",c.getAsFile()),o++)}),o>p){h();return}let l=$('input[name="folder_id"]');l&&a.append("folder_id",l.val()),y(a),t.classList.remove("drop-shadow","dropping")}else[...e.dataTransfer.files].forEach((a,o)=>{})},t.ondragover=e=>{e.preventDefault(),t.classList.add("drop-shadow","dropping")},t.ondragleave=e=>{t.classList.remove("drop-shadow","dropping")}}function u(){i.hide(),f.show(),$.ajax({url:d.data("url")+"?q="+d.val()}).done(function(r){f.hide(),i.html(r).show(),s()})}function E(){t.onchange=r=>{r.preventDefault();let e=document.getElementById("file-upload");if(e.files.length>p){h();return}var a=new FormData;Array.from(e.files).forEach(l=>{a.append("file[]",l)});let o=$('input[name="folder_id"]');o&&a.append("folder_id",o.val()),y(a)}}const h=()=>{window.showToast(m,"toast-error")},y=r=>{var e={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(a){let o=Math.round(a.loaded*100/a.total);$(".progress .progress-bar").css("width",o+"%")}};n.show(),w.post(t.action,r,e).then(function(a){n.hide(),a.data.success&&(a.data.images.forEach(o=>{$("li[data-folder]").last().length===1?$(o).insertAfter($("li[data-folder]").last()):i.prepend(o)}),s())}).catch(function(a){n.hide(),a.response&&a.response.data.message&&g.text(a.response.data.message).fadeToggle(),s()})};function s(){$("#gallery-images li").unbind("click").on("click",function(){let r=$(this).data("folder");if(r){window.location=r;return}$.ajax({url:$(this).data("url")}).done(function(e){$("#large-modal-content").html(e),$("#large-modal").modal("show")})})}
