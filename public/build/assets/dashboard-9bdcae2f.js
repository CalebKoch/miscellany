import{a as f}from"./ajax-modal-1230002e.js";import{S as u}from"./sortable.esm-be94e56d.js";var r,d,l,a,w=new IntersectionObserver(function(t){t.forEach(e=>{e.isIntersecting&&b(t[0].target)})},{threshold:[0]});$(document).ready(function(){$(".widget-render").length>0&&document.querySelectorAll(".widget-render").forEach(t=>{t&&w.observe(t)}),$(".preview-switch").click(function(t){t.preventDefault();var e=$("#widget-preview-body-"+$(this).data("widget"));e.hasClass("preview")?(e.removeClass("preview").addClass("full"),$(this).html('<i class="fa-solid fa-chevron-up"></i>')):(e.removeClass("full").addClass("preview"),$(this).html('<i class="fa-solid fa-chevron-down"></i>'))}),$('[data-release="remove"]').click(function(){$.post({url:$(this).data("url"),method:"POST",context:this}).done(function(){$(this).closest(".box").fadeOut("normal",function(){$(this).remove(),$(".dashboard-releases .box").length===0&&$(".dashboard-releases").remove()})})}),$(".campaign-dashboard-widgets").length===1&&g(),h(),s(),p(),v(),x()});function g(){$("#new-widget"),$("#new-widget-preview"),$("#new-widget-calendar"),$("#new-widget-recent"),r=$("#btn-add-widget"),d=$("#modal-content-buttons"),l=$("#modal-content-target"),a=$("#modal-content-spinner"),$(".widget-list > a").click(function(e){e.preventDefault(),m($(this).data("url"))}),r.click(function(){a.hide(),l.html(""),d.show()});let t=document.getElementById("widgets");new u(t,{handle:".handle",onEnd:function(e){$.post({url:$("#widgets").data("url"),dataType:"json",data:$('input[name="widgets[]"]').serialize()}).done(function(n){n.success&&n.message&&window.showToast(n.message)})}}),$(document).on("shown.bs.modal shown.bs.popover",function(){$("#summernote-config").length>0&&window.initSummernote(),$.each($(".img-delete"),function(){$(this).click(function(n){n.preventDefault(),$("input[name="+$(this).data("target")+"]")[0].value=1,$(this).parent().parent().hide()})}),c()})}function m(t){$("#edit-widget .modal-content").html(""),d.hide(),a.show(),$.ajax(t).done(function(e){a.hide(),l.html(e),window.initForeignSelect(),window.initTags(),c()})}function c(){$(".recent-entity-type").change(function(){this.value?$(".recent-filters").show():$(".recent-filters").hide()})}function h(){$(".widget-recent-more").click(function(t){t.preventDefault(),$(this).find(".spinner").show(),$(this).find("span").hide(),$.ajax({url:$(this).data("url"),context:this}).done(function(e){$(this).closest(".widget-recent-list").append(e),$(this).remove(),h(),window.ajaxTooltip()})})}function s(){$(".widget-calendar-switch").unbind("click").click(function(t){t.preventDefault();var e=$(this).data("url"),n=$(this).data("widget");$("#widget-body-"+n).find(".widget-body").hide(),$("#widget-body-"+n).find(".widget-loading").show(),$.ajax({url:e,method:"POST",context:this}).done(function(i){if(i){var o=$(this).data("widget");$("#widget-body-"+o).find(".widget-loading").hide(),$("#widget-body-"+o).find(".widget-body").html(i).show(),$('[data-toggle="tooltip"]').tooltip(),window.ajaxTooltip(),s()}})})}function p(){var t=$("#campaign-follow"),e=$("#campaign-follow-text");if(t.length===1){var n=t.data("following");n?e.html(t.data("unfollow")):e.html(t.data("follow")),t.show(),t.click(function(i){i.preventDefault(),$.post({url:$(this).data("url"),method:"POST"}).done(function(o){o.following?e.html(t.data("unfollow")):e.html(t.data("follow"))})})}}function v(){$.each($('[data-toggle="preview"]'),function(){$(this).height()===parseInt($(this).css("max-height"))?$(this).next().removeClass("hidden"):$(this).removeClass("pinned-entity preview")})}function b(t){t=$(t),$.ajax({url:t.data("url")}).done(function(e){t.find(".widget-loading").hide(),t.find(".widget-body").html(e).show(),$('[data-toggle="tooltip"]').tooltip(),window.ajaxTooltip(),f(),s()})}function x(){$("[data-pulse]").on("click",function(t){t.preventDefault();let e=$(this).data("pulse"),n=$(this).data("content");$(e).popover("show",{content:n,placement:"top"}),setTimeout(function(){$(e).popover("hide")},1500)})}
