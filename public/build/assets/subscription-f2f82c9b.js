var p,v,t,c=!1,e,s,i,u,r,f,d;$(document).ready(function(){C(),k(),d=$("#subscribe-confirm"),d.on("shown.bs.modal",()=>{g()})});function C(){let n=$("#stripe-token");p=Stripe(n.val()),v=p.elements()}function g(){if(e=$(".subscription-confirm-button"),$("#card-element").length===1){if(!t){let a={base:{color:"#555555",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:"#777777"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}};t=v.create("card",{hidePostalCode:!0,style:a})}t.mount("#card-element")}$("#subscription-confirm").submit(function(a){if(c)return!0;a.preventDefault(),e.addClass("disabled").addClass("loading"),e.prop("disabled","disabled");let o=$('input[name="subscription-intent-token"]'),m=$(".alert-error");m.hide();let h=$('input[name="payment_id"]');if(h.val())return c=!0,$("#subscription-confirm").submit(),!1;p.confirmCardSetup(o.val(),{payment_method:{card:t,billing_details:{name:$('input[name="card-holder-name"]').val()}}}).then(function(l){if(l.error)return e.removeClass("disabled").removeClass("loading"),e.prop("disabled",""),m.text(l.error.message).show(),!1;h.val(l.setupIntent.payment_method),c=!0,$("#subscription-confirm").submit()}.bind(this))}),$(".subscription-form").submit(function(){return e.addClass("disabled").find("span").hide().parent().find(".spinner").show(),!0}),s=$("#coupon-check-btn"),i=$("#coupon-check"),u=$("#coupon-success"),r=$("#coupon-invalid"),f=$("#coupon"),s.click(function(){b()}),i.change(function(){b()}),i.focus(function(){e.addClass("disabled").prop("disabled",!0)}),i.focusout(function(){i.val()||e.removeClass("disabled").prop("disabled",!1)})}function b(){let n=i.val(),a=i.data("url");s.prop("disabled",!0).find(".check").hide().parent().find(".spinner").show(),n||e.removeClass("disabled").prop("disabled",!1),$.ajax({url:a+"?coupon="+n,context:this}).done(function(o){if(s.prop("disabled",!1).find(".check").show().parent().find(".spinner").hide(),e.removeClass("disabled").prop("disabled",!1),!o.valid){u.hide(),r.html(o.error).show(),f.val(""),d.removeClass("valid-coupon");return}r.hide(),u.html(o.discount).show(),f.val(o.coupon),d.addClass("valid-coupon")}).fail(function(o){s.prop("disabled",!1).find(".check").show().parent().find(".spinner").hide(),o.responseJSON&&r.html(o.responseJSON.message).show()})}function k(){$('input[name="period"]').change(function(){let n=$("#pricing-overview");console.log("checked?",this.checked),this.checked?n.removeClass("period-month").addClass("period-year"):n.removeClass("period-year").addClass("period-month")})}
