import{a as b}from"./index-0b481a1e.js";import"./_commonjsHelpers-725317a4.js";var c,n,d,i,m,r,u,y;let p,h;$(document).ready(function(){D(),k(),s()});function D(){c=$("#gallery-loader"),n=$("#gallery-images"),d=$("#gallery-search"),p=$("#bulk-delete"),h=$("form#gallery-bulk"),r=document.getElementById("gallery-form"),$(".uploader"),i=$(".progress"),$("#file-upload"),m=$(".gallery-error");let l=$("#gallery-config");u=l.data("max"),y=l.data("error"),d.on("blur",function(a){a.preventDefault(),g()}).bind("keydown",function(a){a.key==="Enter"&&(a.preventDefault(),g())}),r.ondrop=a=>{if(a.preventDefault(),a.stopPropagation(),a.dataTransfer.items){let e=new FormData,t=0;if([...a.dataTransfer.items].forEach((f,F)=>{f.kind==="file"&&(e.append("file[]",f.getAsFile()),t++)}),t>u){w();return}let o=$('input[name="folder_id"]');o&&e.append("folder_id",o.val()),v(e),r.classList.remove("drop-shadow","dropping")}else[...a.dataTransfer.files].forEach((e,t)=>{})},r.ondragover=a=>{a.preventDefault(),r.classList.add("drop-shadow","dropping")},r.ondragleave=a=>{r.classList.remove("drop-shadow","dropping")},h.submit(function(a){a.preventDefault();var e=new FormData;$.each($('li[data-selected="1"]'),function(o){e.append("file[]",$(this).data("id"))});let t=$('input[name="folder_id"]');return t&&e.append("folder_id",t.val()),$.ajax({url:$(this).attr("action"),method:"POST",context:this,data:e,cache:!1,contentType:!1,processData:!1}).done(function(o){return $('li[data-selected="1"]').remove(),document.getElementById("bulk-destroy-dialog").close(),window.showToast(o.toast),!1}),!1})}function g(){n.hide(),c.show(),$.ajax({url:d.data("url")+"?q="+d.val()}).done(function(l){c.hide(),n.html(l).show(),s()})}function k(){r.onchange=l=>{l.preventDefault();let a=document.getElementById("file-upload");if(a.files.length>u){w();return}var e=new FormData;Array.from(a.files).forEach(o=>{e.append("file[]",o)});let t=$('input[name="folder_id"]');t&&e.append("folder_id",t.val()),v(e)}}const w=()=>{window.showToast(y,"toast-error")},v=l=>{var a={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){let t=Math.round(e.loaded*100/e.total);$('[role="progressbar"]').css("width",t+"%")}};i.show(),b.post(r.action,l,a).then(function(e){i.hide(),e.data.success&&(e.data.images.forEach(t=>{$("li[data-folder]").last().length===1?$(t).insertAfter($("li[data-folder]").last()):n.prepend(t)}),s())}).catch(function(e){i.hide(),e.response&&e.response.data.message&&m.text(e.response.data.message).fadeToggle(),s()})};function s(){$("#gallery-images li").unbind("click").on("click",function(l){if(l.shiftKey){if(!$(this).data("id"))return;$(this).toggleClass("border-2 border-blue-500"),$(this).attr("data-selected")==="1"?$(this).attr("data-selected",""):$(this).attr("data-selected",1),E();return}let a=$(this).data("folder");if(a){window.location=a;return}$.ajax({url:$(this).data("url")}).done(function(e){$("#large-modal-content").html(e),$("#large-modal").modal("show")})})}const E=()=>{$('li[data-selected="1"]').length===0?p.hide():p.show()};
