import{a as u}from"./index-0b481a1e.js";import"./_commonjsHelpers-725317a4.js";var d,n,i,t,g,o;$(document).ready(function(){h(),m(),s()});function h(){d=$("#gallery-loader"),n=$("#gallery-images"),i=$("#gallery-search"),o=document.getElementById("gallery-form"),$(".uploader"),t=$(".progress"),$("#file-upload"),g=$(".gallery-error"),i.on("blur",function(e){e.preventDefault(),c()}).bind("keydown",function(e){e.key==="Enter"&&(e.preventDefault(),c())}),o.ondrop=e=>{if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.items){var l=new FormData(o);[...e.dataTransfer.items].forEach((a,r)=>{a.kind==="file"&&l.append("file[]",a.getAsFile())}),p(l),o.classList.remove("drop-shadow","dropping")}else[...e.dataTransfer.files].forEach((a,r)=>{})},o.ondragover=e=>{e.preventDefault(),o.classList.add("drop-shadow","dropping"),console.log("drag start")},o.ondragleave=e=>{o.classList.remove("drop-shadow","dropping"),console.log("drag end")}}function c(){n.hide(),d.show(),$.ajax({url:i.data("url")+"?q="+i.val()}).done(function(e){d.hide(),n.html(e).show(),s()})}function m(){o.onchange=e=>{e.preventDefault();let l=document.getElementById("file-upload");var a=new FormData(o);Array.from(l.files).forEach(r=>{a.append("file[]",r)}),p(a)}}const p=e=>{var l={onUploadProgress:function(a){let r=Math.round(a.loaded*100/a.total);$(".progress .progress-bar").css("width",r+"%")}};t.show(),u.post(o.action,e,l).then(function(a){console.info("then",a),console.log("data",a.data),t.hide(),a.data.success&&(a.data.images.forEach(r=>{let f=$("li[data-folder]").last();f.length===1?(console.log("last",f[0]),$(r).insertAfter($("li[data-folder]").last())):n.prepend(r)}),s())}).catch(function(a){t.hide(),a.response&&a.response.data.message&&g.text(a.response.data.message).fadeToggle(),s()})};function s(){$("#gallery-images li").unbind("click").on("click",function(){let e=$(this).data("folder");if(e){window.location=e;return}$.ajax({url:$(this).data("url")}).done(function(l){$("#large-modal-content").html(l),$("#large-modal").modal("show")})})}
