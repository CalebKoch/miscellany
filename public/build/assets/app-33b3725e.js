import{t as ae,C as ue}from"./tippy.esm-24ef6cb2.js";import{S as Fe}from"./sortable.esm-0d19b1d3.js";import"./dialog-4600fe8d.js";import{d as Se,o as Oe,c as f,a as l,t as p,b as d,n as Q,w as pe,e as v,F as q,r as j,f as P,g as L,h as V,i as Y,j as te,k as qt,v as ve,l as ee,m as Qe,p as ze,q as S,s as At}from"./vue.esm-bundler-77726dd6.js";import{m as Mt}from"./mitt-f7ef348c.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";import{v as Ue}from"./v-click-outside.umd-1708c20a.js";import"./_commonjsHelpers-725317a4.js";const Ke="kanka.default";window.triggerEvent=function(n){n=n||Ke;const e=new Event(n);document.dispatchEvent(e)};window.onEvent=function(n,e){e=e||Ke,document.addEventListener(e,n)};window.onReady=function(n){document.readyState==="complete"||document.readyState==="interactive"?setTimeout(n,1):document.addEventListener("DOMContentLoaded",n)};window.initTags=function(){var n,e;(n=document.querySelectorAll(".form-tags"))==null||n.forEach(function(t){t.classList.contains("select2-hidden-accessible")||t.dataset.loaded!==1&&(t.dataset.loaded=1,$(t).select2({tags:t.dataset.allowNew,allowClear:t.dataset.allowClear,dropdownParent:t.dataset.dropdownParent||"",minimumInputLength:0,ajax:{quietMillis:500,delay:500,url:t.dataset.url,dataType:"json",data:function(i){var s;return{q:(s=i.term)==null?void 0:s.trim()}},processResults:function(i){return{results:i}},cache:!0},createTag:function(i){var o;const s=(o=i.term)==null?void 0:o.trim();return s===""?null:{id:s,text:s,newTag:!0}},templateResult:function(i){const s=document.createElement("span");return s.classList.add("block","grow","text-left"),s.innerHTML=i.text,i.colour&&(s.classList.add("flex","gap-2","items-center","text-left"),s.innerHTML="<span class='rounded-full flex-none w-6 h-6 "+i.colour+"' /></span><span class='grow'>"+i.text+"</span>"),s},templateSelection:function(i,s){if(i.newTag){const a=document.createElement("span");a.classList.add("new-tag"),a.title=t.dataset.newTag,a.innerHTML=i.text+' <i class="fa-solid fa-plus-circle" aria-hidden="true"></i>'}let o=i.element,r=[];return i.colour?r=i.colour.trim().split(" "):o.dataset.colour&&(r=o.dataset.colour.trim().split(" ")),r.length>0&&r.forEach(a=>{a.trim().length!==0&&s[0].classList.add(a)}),s[0].classList.add("text-left"),i.text}}))}),(e=document.querySelectorAll(".position-dropdown"))==null||e.forEach(function(t){t.classList.contains("select2-hidden-accessible")||t.dataset.loaded!==1&&(t.dataset.loaded=1,$(t).select2({tags:!0,allowClear:!0,dropdownParent:t.dataset.dropdownParent||"",placeholder:t.dataset.placeholder,minimumInputLength:0,createTag:function(i){var o;const s=(o=i.term)==null?void 0:o.trim();return s===""?null:{id:s,text:s,newTag:!0}}}))})};window.initTags();/*! Select2 4.0.13 | https://github.com/select2/select2/blob/master/LICENSE.md */(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;n.define("select2/i18n/de",[],function(){return{errorLoading:function(){return"Die Ergebnisse konnten nicht geladen werden."},inputTooLong:function(e){return"Bitte "+(e.input.length-e.maximum)+" Zeichen weniger eingeben"},inputTooShort:function(e){return"Bitte "+(e.minimum-e.input.length)+" Zeichen mehr eingeben"},loadingMore:function(){return"Lade mehr Ergebnisse…"},maximumSelected:function(e){var t="Sie können nur "+e.maximum+" Element";return e.maximum!=1&&(t+="e"),t+=" auswählen"},noResults:function(){return"Keine Übereinstimmungen gefunden"},searching:function(){return"Suche…"},removeAllItems:function(){return"Entferne alle Elemente"}}}),n.define,n.require})();/*! Select2 4.0.13 | https://github.com/select2/select2/blob/master/LICENSE.md */(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;n.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var t=e.input.length-e.maximum,i="Please delete "+t+" character";return t!=1&&(i+="s"),i},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(e){var t="You can only select "+e.maximum+" item";return e.maximum!=1&&(t+="s"),t},noResults:function(){return"No results found"},searching:function(){return"Searching…"},removeAllItems:function(){return"Remove all items"}}}),n.define,n.require})();/*! Select2 4.0.13 | https://github.com/select2/select2/blob/master/LICENSE.md */(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;n.define("select2/i18n/es",[],function(){return{errorLoading:function(){return"No se pudieron cargar los resultados"},inputTooLong:function(e){var t=e.input.length-e.maximum,i="Por favor, elimine "+t+" car";return i+=t==1?"ácter":"acteres"},inputTooShort:function(e){var t=e.minimum-e.input.length,i="Por favor, introduzca "+t+" car";return i+=t==1?"ácter":"acteres"},loadingMore:function(){return"Cargando más resultados…"},maximumSelected:function(e){var t="Sólo puede seleccionar "+e.maximum+" elemento";return e.maximum!=1&&(t+="s"),t},noResults:function(){return"No se encontraron resultados"},searching:function(){return"Buscando…"},removeAllItems:function(){return"Eliminar todos los elementos"}}}),n.define,n.require})();/*! Select2 4.0.13 | https://github.com/select2/select2/blob/master/LICENSE.md */(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;n.define("select2/i18n/fr",[],function(){return{errorLoading:function(){return"Les résultats ne peuvent pas être chargés."},inputTooLong:function(e){var t=e.input.length-e.maximum;return"Supprimez "+t+" caractère"+(t>1?"s":"")},inputTooShort:function(e){var t=e.minimum-e.input.length;return"Saisissez au moins "+t+" caractère"+(t>1?"s":"")},loadingMore:function(){return"Chargement de résultats supplémentaires…"},maximumSelected:function(e){return"Vous pouvez seulement sélectionner "+e.maximum+" élément"+(e.maximum>1?"s":"")},noResults:function(){return"Aucun résultat trouvé"},searching:function(){return"Recherche en cours…"},removeAllItems:function(){return"Supprimer tous les éléments"}}}),n.define,n.require})();/*! Select2 4.0.13 | https://github.com/select2/select2/blob/master/LICENSE.md */(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;n.define("select2/i18n/it",[],function(){return{errorLoading:function(){return"I risultati non possono essere caricati."},inputTooLong:function(e){var t=e.input.length-e.maximum,i="Per favore cancella "+t+" caratter";return i+=t!==1?"i":"e"},inputTooShort:function(e){return"Per favore inserisci "+(e.minimum-e.input.length)+" o più caratteri"},loadingMore:function(){return"Caricando più risultati…"},maximumSelected:function(e){var t="Puoi selezionare solo "+e.maximum+" element";return e.maximum!==1?t+="i":t+="o",t},noResults:function(){return"Nessun risultato trovato"},searching:function(){return"Sto cercando…"},removeAllItems:function(){return"Rimuovi tutti gli oggetti"}}}),n.define,n.require})();/*! Select2 4.0.13 | https://github.com/select2/select2/blob/master/LICENSE.md */(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;n.define("select2/i18n/nl",[],function(){return{errorLoading:function(){return"De resultaten konden niet worden geladen."},inputTooLong:function(e){return"Gelieve "+(e.input.length-e.maximum)+" karakters te verwijderen"},inputTooShort:function(e){return"Gelieve "+(e.minimum-e.input.length)+" of meer karakters in te voeren"},loadingMore:function(){return"Meer resultaten laden…"},maximumSelected:function(e){var t=e.maximum==1?"kan":"kunnen",i="Er "+t+" maar "+e.maximum+" item";return e.maximum!=1&&(i+="s"),i+=" worden geselecteerd"},noResults:function(){return"Geen resultaten gevonden…"},searching:function(){return"Zoeken…"},removeAllItems:function(){return"Verwijder alle items"}}}),n.define,n.require})();/*! Select2 4.0.13 | https://github.com/select2/select2/blob/master/LICENSE.md */(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;n.define("select2/i18n/pl",[],function(){var e=["znak","znaki","znaków"],t=["element","elementy","elementów"],i=function(s,o){return s===1?o[0]:s>1&&s<=4?o[1]:s>=5?o[2]:void 0};return{errorLoading:function(){return"Nie można załadować wyników."},inputTooLong:function(s){var o=s.input.length-s.maximum;return"Usuń "+o+" "+i(o,e)},inputTooShort:function(s){var o=s.minimum-s.input.length;return"Podaj przynajmniej "+o+" "+i(o,e)},loadingMore:function(){return"Trwa ładowanie…"},maximumSelected:function(s){return"Możesz zaznaczyć tylko "+s.maximum+" "+i(s.maximum,t)},noResults:function(){return"Brak wyników"},searching:function(){return"Trwa wyszukiwanie…"},removeAllItems:function(){return"Usuń wszystkie przedmioty"}}}),n.define,n.require})();/*! Select2 4.0.13 | https://github.com/select2/select2/blob/master/LICENSE.md */(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;n.define("select2/i18n/pt-BR",[],function(){return{errorLoading:function(){return"Os resultados não puderam ser carregados."},inputTooLong:function(e){var t=e.input.length-e.maximum,i="Apague "+t+" caracter";return t!=1&&(i+="es"),i},inputTooShort:function(e){return"Digite "+(e.minimum-e.input.length)+" ou mais caracteres"},loadingMore:function(){return"Carregando mais resultados…"},maximumSelected:function(e){var t="Você só pode selecionar "+e.maximum+" ite";return e.maximum==1?t+="m":t+="ns",t},noResults:function(){return"Nenhum resultado encontrado"},searching:function(){return"Buscando…"},removeAllItems:function(){return"Remover todos os itens"}}}),n.define,n.require})();/*! Select2 4.0.13 | https://github.com/select2/select2/blob/master/LICENSE.md */(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;n.define("select2/i18n/ru",[],function(){function e(t,i,s,o){return t%10<5&&t%10>0&&t%100<5||t%100>20?t%10>1?s:i:o}return{errorLoading:function(){return"Невозможно загрузить результаты"},inputTooLong:function(t){var i=t.input.length-t.maximum,s="Пожалуйста, введите на "+i+" символ";return s+=e(i,"","a","ов"),s+=" меньше"},inputTooShort:function(t){var i=t.minimum-t.input.length,s="Пожалуйста, введите ещё хотя бы "+i+" символ";return s+=e(i,"","a","ов")},loadingMore:function(){return"Загрузка данных…"},maximumSelected:function(t){var i="Вы можете выбрать не более "+t.maximum+" элемент";return i+=e(t.maximum,"","a","ов")},noResults:function(){return"Совпадений не найдено"},searching:function(){return"Поиск…"},removeAllItems:function(){return"Удалить все элементы"}}}),n.define,n.require})();/*! Select2 4.0.13 | https://github.com/select2/select2/blob/master/LICENSE.md */(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var n=jQuery.fn.select2.amd;n.define("select2/i18n/sk",[],function(){var e={2:function(t){return t?"dva":"dve"},3:function(){return"tri"},4:function(){return"štyri"}};return{errorLoading:function(){return"Výsledky sa nepodarilo načítať."},inputTooLong:function(t){var i=t.input.length-t.maximum;return i==1?"Prosím, zadajte o jeden znak menej":i>=2&&i<=4?"Prosím, zadajte o "+e[i](!0)+" znaky menej":"Prosím, zadajte o "+i+" znakov menej"},inputTooShort:function(t){var i=t.minimum-t.input.length;return i==1?"Prosím, zadajte ešte jeden znak":i<=4?"Prosím, zadajte ešte ďalšie "+e[i](!0)+" znaky":"Prosím, zadajte ešte ďalších "+i+" znakov"},loadingMore:function(){return"Načítanie ďalších výsledkov…"},maximumSelected:function(t){return t.maximum==1?"Môžete zvoliť len jednu položku":t.maximum>=2&&t.maximum<=4?"Môžete zvoliť najviac "+e[t.maximum](!1)+" položky":"Môžete zvoliť najviac "+t.maximum+" položiek"},noResults:function(){return"Nenašli sa žiadne položky"},searching:function(){return"Vyhľadávanie…"},removeAllItems:function(){return"Odstráňte všetky položky"}}}),n.define,n.require})();window.initForeignSelect=function(){const n=document.querySelectorAll("select.select2");n.length!==0&&(n.forEach(e=>{if(e.classList.contains("select2-hidden-accessible"))return;if(e.classList.contains("campaign-genres")){$(e).select2({tags:!1,allowClear:!0,dropdownParent:"",width:"100%",maximumSelectionLength:3});return}const t=e.dataset.url,i=e.dataset.allowClear,s=e.dataset.dropdownParent||"",o=e.dataset.placeholder;if(!t){$(e).select2({tags:!1,placeholder:o,allowClear:i??!1,language:e.dataset.language,minimumInputLength:0,dropdownParent:s,width:"100%"});return}$(e).select2({tags:!1,placeholder:o,allowClear:i||!0,language:e.dataset.language,minimumInputLength:0,dropdownParent:s,width:"100%",ajax:{delay:500,quietMillis:500,url:t,dataType:"json",data:function(r){var a;return{q:(a=r.term)==null?void 0:a.trim()}},processResults:function(r){return{results:r}},error:function(r){return r.status===503&&window.showToast(r.responseJSON.message,"error"),{results:[]}},cache:!0},templateResult:It,templateSelection:Dt,createTag:function(r){return null}})}),jt(),Ht())};const It=n=>{const e=document.createElement("span");return n.image?(e.classList.add("flex","gap-2","items-center","text-left"),e.innerHTML="<img src='"+n.image+"' class='rounded-full flex-none w-6 h-6'/><span class='grow'>"+n.text+"</span>"):e.innerHTML=n.text,e},Dt=n=>{if(!n.id)return n.text;const e=document.createElement("span");return e.innerHTML=n.text,e},jt=()=>{const n=document.querySelectorAll("select.select2-local");n.length!==0&&n.forEach(e=>{$(e).select2({placeholder:e.dataset.placeholder,language:e.dataset.language,allowClear:!0})})},Ht=()=>{const n=document.querySelectorAll("select.select2-colour");n.length!==0&&n.forEach(e=>{$(e).select2({placeholder:e.dataset.placeholder,language:e.dataset.language,allowClear:!1,templateResult:Pe,templateSelection:Pe})})},Pe=n=>{if(n.id==="none")return n.text;const e=document.createElement("span");return e.innerHTML='<div class="badge label bg-'+n.id+'"> </div>'+n.text,e};Array.prototype.find||(Array.prototype.find=function(n){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof n!="function")throw new TypeError("predicate must be a function");for(var e=Object(this),t=e.length>>>0,i=arguments[1],s,o=0;o<t;o++)if(s=e[o],n.call(i,s,o,e))return s});if(window&&typeof window.CustomEvent!="function"){let n=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i};typeof window.Event<"u"&&(n.prototype=window.Event.prototype),window.CustomEvent=n}class oe{constructor(e){this.tribute=e,this.tribute.events=this}static keys(){return[{key:9,value:"TAB"},{key:8,value:"DELETE"},{key:13,value:"ENTER"},{key:27,value:"ESCAPE"},{key:32,value:"SPACE"},{key:38,value:"UP"},{key:40,value:"DOWN"}]}bind(e){e.boundKeydown=this.keydown.bind(e,this),e.boundKeyup=this.keyup.bind(e,this),e.boundInput=this.input.bind(e,this),e.addEventListener("keydown",e.boundKeydown,!1),e.addEventListener("keyup",e.boundKeyup,!1),e.addEventListener("input",e.boundInput,!1)}unbind(e){e.removeEventListener("keydown",e.boundKeydown,!1),e.removeEventListener("keyup",e.boundKeyup,!1),e.removeEventListener("input",e.boundInput,!1),delete e.boundKeydown,delete e.boundKeyup,delete e.boundInput}keydown(e,t){e.shouldDeactivate(t)&&(e.tribute.isActive=!1,e.tribute.hideMenu());let i=this;e.commandEvent=!1,oe.keys().forEach(s=>{s.key===t.keyCode&&(e.commandEvent=!0,e.callbacks()[s.value.toLowerCase()](t,i))})}input(e,t){e.inputEvent=!0,e.keyup.call(this,e,t)}click(e,t){let i=e.tribute;if(i.menu&&i.menu.contains(t.target)){let s=t.target;for(t.preventDefault(),t.stopPropagation();s.nodeName.toLowerCase()!=="li";)if(s=s.parentNode,!s||s===i.menu)throw new Error("cannot find the <li> container for the click");i.selectItemAtIndex(s.getAttribute("data-index"),t),i.hideMenu()}else i.current.element&&!i.current.externalTrigger&&(i.current.externalTrigger=!1,setTimeout(()=>i.hideMenu()))}keyup(e,t){if(e.inputEvent&&(e.inputEvent=!1),e.updateSelection(this),t.keyCode!==27){if(!e.tribute.allowSpaces&&e.tribute.hasTrailingSpace){e.tribute.hasTrailingSpace=!1,e.commandEvent=!0,e.callbacks().space(t,this);return}if(!e.tribute.isActive)if(e.tribute.autocompleteMode)e.callbacks().triggerChar(t,this,"");else{let i=e.getKeyCode(e,this,t);if(isNaN(i)||!i)return;let s=e.tribute.triggers().find(o=>o.charCodeAt(0)===i);typeof s<"u"&&e.callbacks().triggerChar(t,this,s)}e.tribute.current.mentionText.length<e.tribute.current.collection.menuShowMinLength||((e.tribute.current.trigger||e.tribute.autocompleteMode)&&e.commandEvent===!1||e.tribute.isActive&&t.keyCode===8)&&e.tribute.showMenuFor(this,!0)}}shouldDeactivate(e){if(!this.tribute.isActive)return!1;if(this.tribute.current.mentionText.length===0){let t=!1;return oe.keys().forEach(i=>{e.keyCode===i.key&&(t=!0)}),!t}return!1}getKeyCode(e,t,i){let s=e.tribute,o=s.range.getTriggerInfo(!1,s.hasTrailingSpace,!0,s.allowSpaces,s.autocompleteMode);return o?o.mentionTriggerChar.charCodeAt(0):!1}updateSelection(e){this.tribute.current.element=e;let t=this.tribute.range.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);t&&(this.tribute.current.selectedPath=t.mentionSelectedPath,this.tribute.current.mentionText=t.mentionText,this.tribute.current.selectedOffset=t.mentionSelectedOffset)}callbacks(){return{triggerChar:(e,t,i)=>{let s=this.tribute;s.current.trigger=i;let o=s.collection.find(r=>r.trigger===i);s.current.collection=o,s.current.mentionText.length>=s.current.collection.menuShowMinLength&&s.inputEvent&&s.showMenuFor(t,!0)},enter:(e,t)=>{this.tribute.isActive&&this.tribute.current.filteredItems&&(e.preventDefault(),e.stopPropagation(),setTimeout(()=>{this.tribute.selectItemAtIndex(this.tribute.menuSelected,e),this.tribute.hideMenu()},0))},escape:(e,t)=>{this.tribute.isActive&&(e.preventDefault(),e.stopPropagation(),this.tribute.isActive=!1,this.tribute.hideMenu())},tab:(e,t)=>{this.callbacks().enter(e,t)},space:(e,t)=>{this.tribute.isActive&&(this.tribute.spaceSelectsMatch?this.callbacks().enter(e,t):this.tribute.allowSpaces||(e.stopPropagation(),setTimeout(()=>{this.tribute.hideMenu(),this.tribute.isActive=!1},0)))},up:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let i=this.tribute.current.filteredItems.length,s=this.tribute.menuSelected;i>s&&s>0?(this.tribute.menuSelected--,this.setActiveLi()):s===0&&(this.tribute.menuSelected=i-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight)}},down:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let i=this.tribute.current.filteredItems.length-1,s=this.tribute.menuSelected;i>s?(this.tribute.menuSelected++,this.setActiveLi()):i===s&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0)}},delete:(e,t)=>{this.tribute.isActive&&this.tribute.current.mentionText.length<1?this.tribute.hideMenu():this.tribute.isActive&&this.tribute.showMenuFor(t)}}}setActiveLi(e){let t=this.tribute.menu.querySelectorAll("li"),i=t.length>>>0;e&&(this.tribute.menuSelected=parseInt(e));for(let s=0;s<i;s++){let o=t[s];if(s===this.tribute.menuSelected){o.classList.add(this.tribute.current.collection.selectClass);let r=o.getBoundingClientRect(),a=this.tribute.menu.getBoundingClientRect();if(r.bottom>a.bottom){let u=r.bottom-a.bottom;this.tribute.menu.scrollTop+=u}else if(r.top<a.top){let u=a.top-r.top;this.tribute.menu.scrollTop-=u}}else o.classList.remove(this.tribute.current.collection.selectClass)}}getFullHeight(e,t){let i=e.getBoundingClientRect().height;if(t){let s=e.currentStyle||window.getComputedStyle(e);return i+parseFloat(s.marginTop)+parseFloat(s.marginBottom)}return i}}class Pt{constructor(e){this.tribute=e,this.tribute.menuEvents=this,this.menu=this.tribute.menu}bind(e){this.menuClickEvent=this.tribute.events.click.bind(null,this),this.menuContainerScrollEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.showMenuFor(this.tribute.current.element,!1)},300,!1),this.windowResizeEvent=this.debounce(()=>{this.tribute.isActive&&this.tribute.range.positionMenuAtCaret(!0)},300,!1),this.tribute.range.getDocument().addEventListener("MSPointerDown",this.menuClickEvent,!1),this.tribute.range.getDocument().addEventListener("mousedown",this.menuClickEvent,!1),window.addEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.addEventListener("scroll",this.menuContainerScrollEvent,!1):window.addEventListener("scroll",this.menuContainerScrollEvent)}unbind(e){this.tribute.range.getDocument().removeEventListener("mousedown",this.menuClickEvent,!1),this.tribute.range.getDocument().removeEventListener("MSPointerDown",this.menuClickEvent,!1),window.removeEventListener("resize",this.windowResizeEvent),this.menuContainer?this.menuContainer.removeEventListener("scroll",this.menuContainerScrollEvent,!1):window.removeEventListener("scroll",this.menuContainerScrollEvent)}debounce(e,t,i){var s;return()=>{var o=this,r=arguments,a=()=>{s=null,i||e.apply(o,r)},u=i&&!s;clearTimeout(s),s=setTimeout(a,t),u&&e.apply(o,r)}}}class Nt{constructor(e){this.tribute=e,this.tribute.range=this}getDocument(){let e;return this.tribute.current.collection&&(e=this.tribute.current.collection.iframe),e?e.contentWindow.document:document}positionMenuAtCaret(e){let t=this.tribute.current,i,s=this.getTriggerInfo(!1,this.tribute.hasTrailingSpace,!0,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(typeof s<"u"){if(!this.tribute.positionMenu){this.tribute.menu.style.cssText="display: block;";return}this.isContentEditable(t.element)?i=this.getContentEditableCaretPosition(s.mentionPosition):i=this.getTextAreaOrInputUnderlinePosition(this.tribute.current.element,s.mentionPosition),this.tribute.menu.style.cssText=`top: ${i.top}px;
                                     left: ${i.left}px;
                                     right: ${i.right}px;
                                     bottom: ${i.bottom}px;
                                     position: absolute;
                                     display: block;`,i.left==="auto"&&(this.tribute.menu.style.left="auto"),i.top==="auto"&&(this.tribute.menu.style.top="auto"),e&&this.scrollIntoView(),window.setTimeout(()=>{let o={width:this.tribute.menu.offsetWidth,height:this.tribute.menu.offsetHeight},r=this.isMenuOffScreen(i,o),a=window.innerWidth>o.width&&(r.left||r.right),u=window.innerHeight>o.height&&(r.top||r.bottom);(a||u)&&(this.tribute.menu.style.cssText="display: none",this.positionMenuAtCaret(e))},0)}else this.tribute.menu.style.cssText="display: none"}get menuContainerIsBody(){return this.tribute.menuContainer===document.body||!this.tribute.menuContainer}selectElement(e,t,i){let s,o=e;if(t)for(var r=0;r<t.length;r++){if(o=o.childNodes[t[r]],o===void 0)return;for(;o.length<i;)i-=o.length,o=o.nextSibling;o.childNodes.length===0&&!o.length&&(o=o.previousSibling)}let a=this.getWindowSelection();s=this.getDocument().createRange(),s.setStart(o,i),s.setEnd(o,i),s.collapse(!0);try{a.removeAllRanges()}catch{}a.addRange(s),e.focus()}replaceTriggerText(e,t,i,s,o){let r=this.getTriggerInfo(!0,i,t,this.tribute.allowSpaces,this.tribute.autocompleteMode);if(r!==void 0){let a=this.tribute.current,u=new CustomEvent("tribute-replaced",{detail:{item:o,instance:a,context:r,event:s}});if(this.isContentEditable(a.element)){let c=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:" ";e+=c;let h=r.mentionPosition+r.mentionText.length;this.tribute.autocompleteMode||(h+=r.mentionTriggerChar.length),this.pasteHtml(e,r.mentionPosition,h)}else{let c=this.tribute.current.element,h=typeof this.tribute.replaceTextSuffix=="string"?this.tribute.replaceTextSuffix:" ";e+=h;let g=r.mentionPosition,m=r.mentionPosition+r.mentionText.length+h.length;this.tribute.autocompleteMode||(m+=r.mentionTriggerChar.length-1),c.value=c.value.substring(0,g)+e+c.value.substring(m,c.value.length),c.selectionStart=g+e.length,c.selectionEnd=g+e.length}a.element.dispatchEvent(new CustomEvent("input",{bubbles:!0})),a.element.dispatchEvent(u)}}pasteHtml(e,t,i){let s,o;o=this.getWindowSelection(),s=this.getDocument().createRange(),s.setStart(o.anchorNode,t),s.setEnd(o.anchorNode,i),s.deleteContents();let r=this.getDocument().createElement("div");r.innerHTML=e;let a=this.getDocument().createDocumentFragment(),u,c;for(;u=r.firstChild;)c=a.appendChild(u);s.insertNode(a),c&&(s=s.cloneRange(),s.setStartAfter(c),s.collapse(!0),o.removeAllRanges(),o.addRange(s))}getWindowSelection(){return this.tribute.collection.iframe?this.tribute.collection.iframe.contentWindow.getSelection():window.getSelection()}getNodePositionInParent(e){if(e.parentNode===null)return 0;for(var t=0;t<e.parentNode.childNodes.length;t++)if(e.parentNode.childNodes[t]===e)return t}getContentEditableSelectedPath(e){let t=this.getWindowSelection(),i=t.anchorNode,s=[],o;if(i!=null){let r,a=i.contentEditable;for(;i!==null&&a!=="true";)r=this.getNodePositionInParent(i),s.push(r),i=i.parentNode,i!==null&&(a=i.contentEditable);return s.reverse(),o=t.getRangeAt(0).startOffset,{selected:i,path:s,offset:o}}}getTextPrecedingCurrentSelection(){let e=this.tribute.current,t="";if(this.isContentEditable(e.element)){let i=this.getWindowSelection().anchorNode;if(i!=null){let s=i.textContent,o=this.getWindowSelection().getRangeAt(0).startOffset;s&&o>=0&&(t=s.substring(0,o))}}else{let i=this.tribute.current.element;if(i){let s=i.selectionStart;i.value&&s>=0&&(t=i.value.substring(0,s))}}return t}getLastWordInText(e){e=e.replace(/\u00A0/g," ");let t=e.split(/\s+/),i=t.length-1;return t[i].trim()}getTriggerInfo(e,t,i,s,o){let r=this.tribute.current,a,u,c;if(!this.isContentEditable(r.element))a=this.tribute.current.element;else{let m=this.getContentEditableSelectedPath(r);m&&(a=m.selected,u=m.path,c=m.offset)}let h=this.getTextPrecedingCurrentSelection(),g=this.getLastWordInText(h);if(o)return{mentionPosition:h.length-g.length,mentionText:g,mentionSelectedElement:a,mentionSelectedPath:u,mentionSelectedOffset:c};if(h!=null){let m=-1,k;if(this.tribute.collection.forEach(w=>{let E=w.trigger,_=w.requireLeadingSpace?this.lastIndexWithLeadingSpace(h,E):h.lastIndexOf(E);_>m&&(m=_,k=E,i=w.requireLeadingSpace)}),m>=0&&(m===0||!i||/[\xA0\s]/g.test(h.substring(m-1,m)))){let w=h.substring(m+k.length,h.length);k=h.substring(m,m+k.length);let E=w.substring(0,1),_=w.length>0&&(E===" "||E===" ");t&&(w=w.trim());let M=s?/[^\S ]/g:/[\xA0\s]/g;if(this.tribute.hasTrailingSpace=M.test(w),!_&&(e||!M.test(w)))return{mentionPosition:m,mentionText:w,mentionSelectedElement:a,mentionSelectedPath:u,mentionSelectedOffset:c,mentionTriggerChar:k}}}}lastIndexWithLeadingSpace(e,t){let i=e.split("").reverse().join(""),s=-1;for(let o=0,r=e.length;o<r;o++){let a=o===e.length-1,u=/\s/.test(i[o+1]),c=!0;for(let h=t.length-1;h>=0;h--)if(t[h]!==i[o-h]){c=!1;break}if(c&&(a||u)){s=e.length-1-o;break}}return s}isContentEditable(e){return e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA"}isMenuOffScreen(e,t){let i=window.innerWidth,s=window.innerHeight,o=document.documentElement,r=(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0),a=(window.pageYOffset||o.scrollTop)-(o.clientTop||0),u=typeof e.top=="number"?e.top:a+s-e.bottom-t.height,c=typeof e.right=="number"?e.right:e.left+t.width,h=typeof e.bottom=="number"?e.bottom:e.top+t.height,g=typeof e.left=="number"?e.left:r+i-e.right-t.width;return{top:u<Math.floor(a),right:c>Math.ceil(r+i),bottom:h>Math.ceil(a+s),left:g<Math.floor(r)}}getMenuDimensions(){let e={width:null,height:null};return this.tribute.menu.style.cssText=`top: 0px;
                                 left: 0px;
                                 position: fixed;
                                 display: block;
                                 visibility; hidden;`,e.width=this.tribute.menu.offsetWidth,e.height=this.tribute.menu.offsetHeight,this.tribute.menu.style.cssText="display: none;",e}getTextAreaOrInputUnderlinePosition(e,t,i){let s=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"],o=window.mozInnerScreenX!==null,r=this.getDocument().createElement("div");r.id="input-textarea-caret-position-mirror-div",this.getDocument().body.appendChild(r);let a=r.style,u=window.getComputedStyle?getComputedStyle(e):e.currentStyle;a.whiteSpace="pre-wrap",e.nodeName!=="INPUT"&&(a.wordWrap="break-word"),a.position="absolute",a.visibility="hidden",s.forEach(y=>{a[y]=u[y]}),o?(a.width=`${parseInt(u.width)-2}px`,e.scrollHeight>parseInt(u.height)&&(a.overflowY="scroll")):a.overflow="hidden",r.textContent=e.value.substring(0,t),e.nodeName==="INPUT"&&(r.textContent=r.textContent.replace(/\s/g," "));let c=this.getDocument().createElement("span");c.textContent=e.value.substring(t)||".",r.appendChild(c);let h=e.getBoundingClientRect(),g=document.documentElement,m=(window.pageXOffset||g.scrollLeft)-(g.clientLeft||0),k=(window.pageYOffset||g.scrollTop)-(g.clientTop||0),w=0,E=0;this.menuContainerIsBody&&(w=h.top,E=h.left);let _={top:w+k+c.offsetTop+parseInt(u.borderTopWidth)+parseInt(u.fontSize)-e.scrollTop,left:E+m+c.offsetLeft+parseInt(u.borderLeftWidth)},M=window.innerWidth,B=window.innerHeight,I=this.getMenuDimensions(),D=this.isMenuOffScreen(_,I);D.right&&(_.right=M-_.left,_.left="auto");let F=this.tribute.menuContainer?this.tribute.menuContainer.offsetHeight:this.getDocument().body.offsetHeight;if(D.bottom){let y=this.tribute.menuContainer?this.tribute.menuContainer.getBoundingClientRect():this.getDocument().body.getBoundingClientRect(),b=F-(B-y.top);_.bottom=b+(B-h.top-c.offsetTop),_.top="auto"}return D=this.isMenuOffScreen(_,I),D.left&&(_.left=M>I.width?m+M-I.width:m,delete _.right),D.top&&(_.top=B>I.height?k+B-I.height:k,delete _.bottom),this.getDocument().body.removeChild(r),_}getContentEditableCaretPosition(e){let t,i=this.getWindowSelection();t=this.getDocument().createRange(),t.setStart(i.anchorNode,e),t.setEnd(i.anchorNode,e),t.collapse(!1);let s=t.getBoundingClientRect(),o=document.documentElement,r=(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0),a=(window.pageYOffset||o.scrollTop)-(o.clientTop||0),u=s.left,c=s.top,h={left:u+r,top:c+s.height+a},g=window.innerWidth,m=window.innerHeight,k=this.getMenuDimensions(),w=this.isMenuOffScreen(h,k);w.right&&(h.left="auto",h.right=g-s.left-r);let E=this.tribute.menuContainer?this.tribute.menuContainer.offsetHeight:this.getDocument().body.offsetHeight;if(w.bottom){let _=this.tribute.menuContainer?this.tribute.menuContainer.getBoundingClientRect():this.getDocument().body.getBoundingClientRect(),M=E-(m-_.top);h.top="auto",h.bottom=M+(m-s.top)}return w=this.isMenuOffScreen(h,k),w.left&&(h.left=g>k.width?r+g-k.width:r,delete h.right),w.top&&(h.top=m>k.height?a+m-k.height:a,delete h.bottom),this.menuContainerIsBody||(h.left=h.left?h.left-this.tribute.menuContainer.offsetLeft:h.left,h.top=h.top?h.top-this.tribute.menuContainer.offsetTop:h.top),h}scrollIntoView(e){let t=20,i,s=100,o=this.menu;if(typeof o>"u")return;for(;i===void 0||i.height===0;)if(i=o.getBoundingClientRect(),i.height===0&&(o=o.childNodes[0],o===void 0||!o.getBoundingClientRect))return;let r=i.top,a=r+i.height;if(r<0)window.scrollTo(0,window.pageYOffset+i.top-t);else if(a>window.innerHeight){let u=window.pageYOffset+i.top-t;u-window.pageYOffset>s&&(u=window.pageYOffset+s);let c=window.pageYOffset-(window.innerHeight-a);c>u&&(c=u),window.scrollTo(0,c)}}}class Bt{constructor(e){this.tribute=e,this.tribute.search=this}simpleFilter(e,t){return t.filter(i=>this.test(e,i))}test(e,t){return this.match(e,t)!==null}match(e,t,i){i=i||{},t.length;let s=i.pre||"",o=i.post||"",r=i.caseSensitive&&t||t.toLowerCase();if(i.skip)return{rendered:t,score:0};e=i.caseSensitive&&e||e.toLowerCase();let a=this.traverse(r,e,0,0,[]);return a?{rendered:this.render(t,a.cache,s,o),score:a.score}:null}traverse(e,t,i,s,o){if(t.length===s)return{score:this.calculateScore(o),cache:o.slice()};if(e.length===i||t.length-s>e.length-i)return;let r=t[s],a=e.indexOf(r,i),u,c;for(;a>-1;){if(o.push(a),c=this.traverse(e,t,a+1,s+1,o),o.pop(),!c)return u;(!u||u.score<c.score)&&(u=c),a=e.indexOf(r,a+1)}return u}calculateScore(e){let t=0,i=1;return e.forEach((s,o)=>{o>0&&(e[o-1]+1===s?i+=i+1:i=1),t+=i}),t}render(e,t,i,s){var o=e.substring(0,t[0]);return t.forEach((r,a)=>{o+=i+e[r]+s+e.substring(r+1,t[a+1]?t[a+1]:e.length)}),o}filter(e,t,i){return i=i||{},t.reduce((s,o,r,a)=>{let u=o;i.extract&&(u=i.extract(o),u||(u=""));let c=this.match(e,u,i);return c!=null&&(s[s.length]={string:c.rendered,score:c.score,index:r,original:o}),s},[]).sort((s,o)=>{let r=o.score-s.score;return r||s.index-o.index})}}class K{constructor({values:e=null,iframe:t=null,selectClass:i="highlight",containerClass:s="tribute-container",itemClass:o="",trigger:r="@",autocompleteMode:a=!1,selectTemplate:u=null,menuItemTemplate:c=null,lookup:h="key",fillAttr:g="value",collection:m=null,menuContainer:k=null,noMatchTemplate:w=null,requireLeadingSpace:E=!0,allowSpaces:_=!1,replaceTextSuffix:M=null,positionMenu:B=!0,spaceSelectsMatch:I=!1,searchOpts:D={},menuItemLimit:F=null,menuShowMinLength:y=0}){if(this.autocompleteMode=a,this.menuSelected=0,this.current={},this.inputEvent=!1,this.isActive=!1,this.menuContainer=k,this.allowSpaces=_,this.replaceTextSuffix=M,this.positionMenu=B,this.hasTrailingSpace=!1,this.spaceSelectsMatch=I,this.autocompleteMode&&(r="",_=!1),e)this.collection=[{trigger:r,iframe:t,selectClass:i,containerClass:s,itemClass:o,selectTemplate:(u||K.defaultSelectTemplate).bind(this),menuItemTemplate:(c||K.defaultMenuItemTemplate).bind(this),noMatchTemplate:(b=>typeof b=="string"?b.trim()===""?null:b:typeof b=="function"?b.bind(this):w||(function(){return"<li>No Match Found!</li>"}).bind(this))(w),lookup:h,fillAttr:g,values:e,requireLeadingSpace:E,searchOpts:D,menuItemLimit:F,menuShowMinLength:y}];else if(m)this.autocompleteMode&&console.warn("Tribute in autocomplete mode does not work for collections"),this.collection=m.map(b=>({trigger:b.trigger||r,iframe:b.iframe||t,selectClass:b.selectClass||i,containerClass:b.containerClass||s,itemClass:b.itemClass||o,selectTemplate:(b.selectTemplate||K.defaultSelectTemplate).bind(this),menuItemTemplate:(b.menuItemTemplate||K.defaultMenuItemTemplate).bind(this),noMatchTemplate:(T=>typeof T=="string"?T.trim()===""?null:T:typeof T=="function"?T.bind(this):w||(function(){return"<li>No Match Found!</li>"}).bind(this))(w),lookup:b.lookup||h,fillAttr:b.fillAttr||g,values:b.values,requireLeadingSpace:b.requireLeadingSpace,searchOpts:b.searchOpts||D,menuItemLimit:b.menuItemLimit||F,menuShowMinLength:b.menuShowMinLength||y}));else throw new Error("[Tribute] No collection specified.");new Nt(this),new oe(this),new Pt(this),new Bt(this)}get isActive(){return this._isActive}set isActive(e){if(this._isActive!=e&&(this._isActive=e,this.current.element)){let t=new CustomEvent(`tribute-active-${e}`);this.current.element.dispatchEvent(t)}}static defaultSelectTemplate(e){return typeof e>"u"?`${this.current.collection.trigger}${this.current.mentionText}`:this.range.isContentEditable(this.current.element)?'<span class="tribute-mention">'+(this.current.collection.trigger+e.original[this.current.collection.fillAttr])+"</span>":this.current.collection.trigger+e.original[this.current.collection.fillAttr]}static defaultMenuItemTemplate(e){return e.string}static inputTypes(){return["TEXTAREA","INPUT"]}triggers(){return this.collection.map(e=>e.trigger)}attach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let i=e.length;for(var t=0;t<i;++t)this._attach(e[t])}else this._attach(e)}_attach(e){e.hasAttribute("data-tribute")&&console.warn("Tribute was already bound to "+e.nodeName),this.ensureEditable(e),this.events.bind(e),e.setAttribute("data-tribute",!0)}ensureEditable(e){if(K.inputTypes().indexOf(e.nodeName)===-1)if(e.contentEditable)e.contentEditable=!0;else throw new Error("[Tribute] Cannot bind to "+e.nodeName)}createMenu(e){let t=this.range.getDocument().createElement("div"),i=this.range.getDocument().createElement("ul");return t.className=e,t.appendChild(i),this.menuContainer?this.menuContainer.appendChild(t):this.range.getDocument().body.appendChild(t)}showMenuFor(e,t){if(this.isActive&&this.current.element===e&&this.current.mentionText===this.currentMentionTextSnapshot)return;this.currentMentionTextSnapshot=this.current.mentionText,this.menu||(this.menu=this.createMenu(this.current.collection.containerClass),e.tributeMenu=this.menu,this.menuEvents.bind(this.menu)),this.isActive=!0,this.menuSelected=0,this.current.mentionText||(this.current.mentionText="");const i=s=>{if(!this.isActive)return;let o=this.search.filter(this.current.mentionText,s,{pre:this.current.collection.searchOpts.pre||"<span>",post:this.current.collection.searchOpts.post||"</span>",skip:this.current.collection.searchOpts.skip,extract:u=>{if(typeof this.current.collection.lookup=="string")return u[this.current.collection.lookup];if(typeof this.current.collection.lookup=="function")return this.current.collection.lookup(u,this.current.mentionText);throw new Error("Invalid lookup attribute, lookup must be string or function.")}});this.current.collection.menuItemLimit&&(o=o.slice(0,this.current.collection.menuItemLimit)),this.current.filteredItems=o;let r=this.menu.querySelector("ul");if(this.range.positionMenuAtCaret(t),!o.length){let u=new CustomEvent("tribute-no-match",{detail:this.menu});this.current.element.dispatchEvent(u),typeof this.current.collection.noMatchTemplate=="function"&&!this.current.collection.noMatchTemplate()||!this.current.collection.noMatchTemplate?this.hideMenu():typeof this.current.collection.noMatchTemplate=="function"?r.innerHTML=this.current.collection.noMatchTemplate():r.innerHTML=this.current.collection.noMatchTemplate;return}r.innerHTML="";let a=this.range.getDocument().createDocumentFragment();o.forEach((u,c)=>{let h=this.range.getDocument().createElement("li");h.setAttribute("data-index",c),h.className=this.current.collection.itemClass,h.addEventListener("mousemove",g=>{let[m,k]=this._findLiTarget(g.target);g.movementY!==0&&this.events.setActiveLi(k)}),this.menuSelected===c&&h.classList.add(this.current.collection.selectClass),h.innerHTML=this.current.collection.menuItemTemplate(u),a.appendChild(h)}),r.appendChild(a)};typeof this.current.collection.values=="function"?this.current.collection.values(this.current.mentionText,i):i(this.current.collection.values)}_findLiTarget(e){if(!e)return[];const t=e.getAttribute("data-index");return t?[e,t]:this._findLiTarget(e.parentNode)}showMenuForCollection(e,t){e!==document.activeElement&&this.placeCaretAtEnd(e),this.current.collection=this.collection[t||0],this.current.externalTrigger=!0,this.current.element=e,e.isContentEditable?this.insertTextAtCursor(this.current.collection.trigger):this.insertAtCaret(e,this.current.collection.trigger),this.showMenuFor(e)}placeCaretAtEnd(e){if(e.focus(),typeof window.getSelection<"u"&&typeof document.createRange<"u"){var t=document.createRange();t.selectNodeContents(e),t.collapse(!1);var i=window.getSelection();i.removeAllRanges(),i.addRange(t)}else if(typeof document.body.createTextRange<"u"){var s=document.body.createTextRange();s.moveToElementText(e),s.collapse(!1),s.select()}}insertTextAtCursor(e){var t,i;t=window.getSelection(),i=t.getRangeAt(0),i.deleteContents();var s=document.createTextNode(e);i.insertNode(s),i.selectNodeContents(s),i.collapse(!1),t.removeAllRanges(),t.addRange(i)}insertAtCaret(e,t){var i=e.scrollTop,s=e.selectionStart,o=e.value.substring(0,s),r=e.value.substring(e.selectionEnd,e.value.length);e.value=o+t+r,s=s+t.length,e.selectionStart=s,e.selectionEnd=s,e.focus(),e.scrollTop=i}hideMenu(){this.menu&&(this.menu.style.cssText="display: none;",this.isActive=!1,this.menuSelected=0,this.current={})}selectItemAtIndex(e,t){if(e=parseInt(e),typeof e!="number"||isNaN(e))return;let i=this.current.filteredItems[e],s=this.current.collection.selectTemplate(i);s!==null&&this.replaceText(s,t,i)}replaceText(e,t,i){this.range.replaceTriggerText(e,!0,!0,t,i)}_append(e,t,i){if(typeof e.values=="function")throw new Error("Unable to append to values, as it is a function.");i?e.values=t:e.values=e.values.concat(t)}append(e,t,i){let s=parseInt(e);if(typeof s!="number")throw new Error("please provide an index for the collection to update.");let o=this.collection[s];this._append(o,t,i)}appendCurrent(e,t){if(this.isActive)this._append(this.current.collection,e,t);else throw new Error("No active state. Please use append instead and pass an index.")}detach(e){if(!e)throw new Error("[Tribute] Must pass in a DOM node or NodeList.");if(typeof jQuery<"u"&&e instanceof jQuery&&(e=e.get()),e.constructor===NodeList||e.constructor===HTMLCollection||e.constructor===Array){let i=e.length;for(var t=0;t<i;++t)this._detach(e[t])}else this._detach(e)}_detach(e){this.events.unbind(e),e.tributeMenu&&this.menuEvents.unbind(e.tributeMenu),setTimeout(()=>{e.removeAttribute("data-tribute"),this.isActive=!1,e.tributeMenu&&e.tributeMenu.remove()})}}function Rt(){const n=".kanka-mentions",e=document.querySelector(n);if(!e)return;const t=e.dataset.remote,i=new K({values:function(r,a){o(r,u=>a(u))},lookup:"name",menuShowMinLength:3,selectTemplate:function(r){return"["+r.original.model_type+":"+r.original.id+"]"},noMatchTemplate:function(){return null}});document.querySelectorAll(n).forEach(r=>{r.dataset.mentions!=="1"&&(r.dataset.mentions=1,i.attach(r))});function o(r,a){let u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){let h=JSON.parse(u.responseText);a(h)}else u.status===403&&a([])};let c=t+"?q="+r;u.open("GET",c,!0),u.send()}}const We=()=>{document.querySelectorAll("form[data-shortcut]").forEach(function(e){Ft(e)})},Ve=()=>{document.addEventListener("keydown",function(n){const e=n.target,t=document.getElementById("primary-dialog"),i=document.querySelector(".quick-creator-button");let s=document.querySelector('[data-keyboard="edit"]');if(n.key==="]"){if(se(e))return;n.preventDefault();const o=document.querySelector(".sidebar-toggle");o.click(),o.blur()}else if(n.key==="k"){if(se(e))return;n.preventDefault(),document.getElementById("entity-lookup").focus()}else if(n.key==="n"&&!(n.ctrlKey||n.metaKey)&&!n.altKey&&i){if(se(e)||t!=null&&t.open)return;i.click()}else if(n.key==="e"&&!(n.ctrlKey||n.metaKey)&&s){if(se(e)||t!=null&&t.open)return;s.click()}else n.key==="Escape"&&(t==null?void 0:t.classList.contains("qq-modal-selection").length)===1&&window.closeDialog(t)})},se=n=>!n||n.length===0?!1:["input","textarea","select"].includes(n.tagName.toLowerCase())||n.getAttribute("contentEditable")==="true"?!0:!!n.classList.contains("CodeMirror"),Ft=n=>{n.dataset.shortcutInit||(n.dataset.shortcutInit=1,document.addEventListener("keydown",function(e){if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="s")return e.preventDefault(),n.dataset.unload&&(window.entityFormHasUnsavedChanges=!1),e.shiftKey?de("submit-update"):e.altKey&&de("submit-new"),n.requestSubmit(),console.log("requested tos ubmit",n),!1;if((e.ctrlKey||e.metaKey)&&e.altKey&&e.key==="c")return n.dataset.unload&&(window.entityFormHasUnsavedChanges=!1),de("submit-copy"),n.submit(),!1}))},de=n=>{const e=document.getElementById("form-submit-main");e&&(e.name=n,document.getElementById("submit-mode").name=n)},$e=()=>{document.querySelectorAll('input[data-paste="fontawesome"]').forEach(function(e){e.addEventListener("paste",function(t){t.preventDefault();const i=(t.clipboardData||window.clipboardData).getData("text");if(i.startsWith('<i class="fa')||i.startsWith('<i class="ra')){const s=document.createElement("div");s.innerHTML=i;let r=s.querySelector("i").getAttribute("class");if(r){e.value=r;return}}e.value=i})})};We();Ve();$e();window.onEvent(function(){$e(),Ve(),We()});let fe;function Ot(){window.onEvent(function(){Ye()})}function Qt(){const n=document.querySelector('#form-entry input[name="name"]');n&&(n.dataset.liveDisabled||n.addEventListener("focusout",function(e){if(!n.value)return;const t=this.dataset.duplicate,i=document.querySelector(t);if(!i)return;const s=this.dataset.live+"?q="+encodeURIComponent(this.value)+"&type="+this.dataset.type+"&exclude="+this.dataset.id;i.classList.add("hidden");const o=i.querySelector(".duplicates");fetch(s).then(r=>r.json()).then(r=>{o.innerHTML="",r.forEach(a=>{const u=document.createElement("a");u.href=a.url,u.text=a.name,o.appendChild(u)}),r.length>0&&i.classList.remove("hidden")})}))}const Ye=()=>{if(fe=document.querySelectorAll(".form-submit-actions"),fe.length===0)return;let n=document.getElementById("form-submit-main"),e=document.getElementById("submit-mode");if(e===void 0)throw new Error("No submit mode hidden input found");fe.forEach(t=>{t.addEventListener("click",function(i){return i.preventDefault(),e.name=t.dataset.action,n.click(),!1})})};function zt(){if(document.querySelectorAll('form[data-unload="1"]').length===0)return;const e=document.querySelector("#form-submit-main");document.querySelectorAll('form[data-unload="1"] input, form[data-unload="1"] select, form[data-unload="1"] textarea').forEach(i=>{i.dataset.skipUnsaved||i.classList.contains("form-control")||(i.addEventListener("change",function(){window.entityFormHasUnsavedChanges=!0}),i.classList.contains("select2")&&(i.onchange=()=>{window.entityFormHasUnsavedChanges=!0}))}),e&&window.addEventListener("beforeunload",function(i){window.entityFormHasUnsavedChanges&&(i.preventDefault(),i.returnValue="Unsaved data warning")})}const Ut=()=>{document.querySelectorAll(".dynamic-row-add").forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();const i=e.dataset.target,s=e.dataset.template,o=document.createElement("div");return o.innerHTML=document.querySelector("#"+s).innerHTML,document.querySelector("."+i).append(o),Ne(),window.triggerEvent(),!1})}),Ne()},Ne=()=>{document.querySelectorAll(".dynamic-row-delete").forEach(e=>{e.dataset.init!==1&&(e.dataset.init=1,e.addEventListener("click",function(t){t.preventDefault(),e.closest(".parent-delete-row").remove()}),e.addEventListener("keydown",function(t){t.key==="Enter"&&e.click()}))})};Ut();Ye();zt();Ot();Qt();const Ge=()=>{const n=document.querySelector(".btn-post-collapse");n==null||n.addEventListener("click",function(t){t.preventDefault(),document.querySelectorAll(".element-toggle").forEach(s=>{s.classList.add("animate-collapsed"),document.querySelector(s.dataset.target).classList.add("hidden")})});const e=document.querySelector(".btn-post-expand");e==null||e.addEventListener("click",function(t){t.preventDefault(),document.querySelectorAll(".element-toggle").forEach(s=>{s.classList.remove("animate-collapsed"),document.querySelector(s.dataset.target).classList.remove("hidden")})})},Xe=()=>{const n=document.querySelector(".story-load-more");n==null||n.addEventListener("click",function(e){return e.preventDefault(),this.classList.add("loading"),axios.get(this.dataset.url).then(t=>{n.parentNode.remove(),console.log(t),document.querySelector(".entity-posts").insertAdjacentHTML("beforeend",t.data),Xe(),Ge(),window.triggerEvent()}).catch(()=>{n.classList.remove("loading")}),!1})},Kt=()=>{const n=document.querySelector(".domain-trust");n&&n.addEventListener("click",function(e){const t="kanka_trusted_domains";let i=document.cookie.match("(^|;) ?"+t+"=([^;]*)(;|$)");i=i?i[2]:"";const s=n.dataset.domain;i.includes(s)||(i&&(i+="|"),i+=s);let o=new Date;o.setTime(o.getTime()+30*24*60*60*1e3),document.cookie=t+"="+i+";path=/;expires="+o.toUTCString()+";sameSite=Strict"})};Ge();Xe();Kt();const Ze=document.querySelectorAll(".post-perm-add"),Wt=()=>{window.onEvent(function(){$t()}),Ze.length!==0&&(Vt(),Je())},Vt=()=>{Ze.forEach(n=>{n.addEventListener("click",function(e){e.preventDefault();let t=this.dataset.type,i=document.querySelector('select[name="'+t+'"]');if(!i||!i.value)return!1;let s=i.textContent;const r=document.getElementById("post-perm-"+t+"-template").cloneNode(!0);return r.classList.remove("hidden"),r.removeAttribute("id"),r.innerHTML=r.innerHTML.replace(/\$SELECTEDID\$/g,i.value).replace(/\$SELECTEDNAME\$/g,s),document.getElementById("post-perm-target").insertAdjacentElement("afterend",r),document.getElementById("post-new-"+t).close(),Je(),i.value="",i.dispatchEvent(new Event("change")),!1})})},Je=()=>{const n=document.querySelectorAll(".post-delete-perm");console.log(n),n.forEach(e=>{e.addEventListener("click",function(t){console.log("clicking"),e.closest(".perm-row").remove(),t.preventDefault(),e.removeEventListener("click",arguments.callee)})})},$t=()=>{const n=document.querySelector("form.post-visibility");n&&(n.onsubmit=function(e){return e.preventDefault(),axios.post(this.getAttribute("action"),{visibility_id:this.querySelector('[name="visibility_id"]').value}).then(t=>{document.getElementById("primary-dialog").close(),document.getElementById("visibility-icon-"+t.data.post_id).innerHTML=t.data.icon,window.showToast(t.data.toast)}),!1})};Wt();const Yt=()=>{let n=document.getElementById("post-layout-selector");if(!n)return;const e=document.querySelector(".field-entry"),t=document.querySelector(".field-location"),i=document.querySelector(".field-display"),s=document.querySelector("#post-layout-subform");n.addEventListener("change",function(o){o.preventDefault(),this.value===""?(e.style.removeProperty("display"),e.style.removeProperty("display"),i.style.removeProperty("display"),s.style.display="none"):(e.style.display="none",t.style.display="none",i.style.display="none",s.style.removeProperty("display"))})};Yt();const Gt=()=>{if(!document.querySelector("#calendar-year-switcher"))return;document.querySelectorAll(".calendar-event-block").forEach(e=>{e.dataset.toggle!=="dialog"&&e.dataset.url&&e.addEventListener("click",function(){window.location=e.dataset.url})})},et=()=>{var o,r,a;const n=document.querySelector('select[name="recurring_periodicity"]');if(!n)return;n.onchange=function(){const u=document.querySelector(".field-recurring-until");n.value?u.classList.remove("hidden"):u.classList.add("hidden")};const e=document.querySelector("#calendar-event-first"),t=document.querySelector(".calendar-new-event-field"),i=document.querySelector(".calendar-existing-event-field"),s=document.querySelector("#calendar-event-subform");(o=document.querySelector("#calendar-action-existing"))==null||o.addEventListener("click",function(u){u.preventDefault(),e.classList.add("!hidden"),t.classList.add("hidden"),i.classList.remove("hidden"),s.classList.remove("hidden")}),(r=document.querySelector("#calendar-action-new"))==null||r.addEventListener("click",function(u){u.preventDefault(),e.classList.add("!hidden"),t.classList.remove("hidden"),i.classList.add("hidden"),s.classList.remove("hidden")}),(a=document.querySelector("#calendar-event-switch"))==null||a.addEventListener("click",function(u){u.preventDefault(),s.classList.add("hidden"),e.classList.remove("!hidden"),i.classList.remove("hidden"),t.classList.remove("hidden")})},Xt=()=>{document.querySelector('[data-shortcut="previous"]')&&document.addEventListener("keydown",function(n){if((n.ctrlKey||n.metaKey)&&n.which===37){const e=document.querySelector('[data-shortcut="previous"]');e.classList.add("loading"),e.click()}else if((n.ctrlKey||n.metaKey)&&n.which===39){const e=document.querySelector('[data-shortcut="next"]');e.classList.add("loading"),e.click()}})};Gt();Xt();document.querySelector('select[name="recurring_periodicity"]')&&et();window.onEvent(function(){et()});let W,ye,A,he,U,z,N,O,re,G;window.onEvent(function(){Jt()});const Zt=()=>{W=document.querySelector("#entity-calendar-form-add"),A=document.querySelector('select[name="calendar_id"]'),he=document.querySelector('input[name="calendar_id"]'),document.querySelector(".entity-calendar-modal-form"),G=document.querySelector(".entity-calendar-subform"),O=document.querySelector("#entity-calendar-form-cancel"),ye=document.querySelector(".entity-calendar-form"),z=document.querySelector('input[name="calendar_year"]'),U=document.querySelector('[name="calendar_month"]'),N=document.querySelector("#reminder_day"),re=document.querySelector(".entity-calendar-loading"),W&&(W.addEventListener("click",function(n){n.preventDefault(),W.classList.add("hidden"),ye.classList.remove("hidden");let e=W.dataset.defaultCalendar;return e&&(he.value=e,O==null||O.classList.remove("hidden"),G.classList.remove("hidden"),le(e)),!1}),O.addEventListener("click",function(n){n.preventDefault(),A.value=null,he.value=null,O.classList.add("hidden"),be()})),A&&(A.onchange=n=>{if(G.classList.add("hidden"),!A.value)return be(),!1;z=document.querySelector('input[name="calendar_year"]'),U=document.querySelector('[name="calendar_month"]'),N=document.querySelector("#reminder_day"),!z&&document.querySelector('input[name="year"]')&&(z=document.querySelector('input[name="year"]'),U=document.querySelector('select[name="month"]'),N=document.querySelector("#reminder_day")),le(A.value)}),tt()},Jt=()=>{if(!document.getElementById("entity-calendar-modal-add"))return;W=document.querySelector("input[name=calendar-data-url]"),A=document.querySelector('select[name="calendar_id"]'),z=document.querySelector('input[name="year"]'),U=document.querySelector('select[name="month"]'),N=document.querySelector("#reminder_day"),re=document.querySelector(".entity-calendar-loading"),G=document.querySelector(".entity-calendar-subform"),A&&(A.onchange=e=>{if(G.classList.add("hidden"),!A.value){be();return}le(A.value)},A!=null&&A.value&&(O==null||O.classList.remove("hidden"),G.classList.remove("hidden"),le(A.value)));const n=document.querySelector('.entity-calendar-subform input[name="length"]');n&&n.addEventListener("focusout",function(){if(!this.value)return;const e=this.dataset.url.replace("/0/","/"+A.value+"/"),t={day:N.value,month:U.value,year:z.value,length:this.value};axios.get(e,{data:t}).then(i=>{const s=document.querySelector(".length-warning");i.data.overflow==!0?s.classList.remove("hidden"):s.classList.add("hidden")})}),tt()},le=n=>{re.classList.remove("hidden"),n=parseInt(n);const e=document.querySelector('input[name="calendar-data-url"]').dataset.url.replace("/0/","/"+n+"/");fetch(e).then(t=>t.json()).then(t=>{let i=N.value;z.innerHTML="",U.innerHTML="",N.innerHTML="";let s=1,o=1;i||(i=t.current.day);let r=parseInt(t.current.month);Object.entries(t.months).forEach((h,g)=>{const m=document.createElement("option");m.text=h[1].name,m.value=g+1,h[0]===r&&(m.selected=!0),m.dataset.length=h[1].length,U.appendChild(m),s===r&&(o=h[1].length),s++});for(let h=1;h<o;h++){const g=document.createElement("option");g.text=h,g.value=h,h==i&&(g.selected=!0),N.appendChild(g)}re.classList.add("hidden"),G.classList.remove("hidden"),z.value=t.current.year;const u=document.querySelector("select.reminder-periodicity");for(;u.options.length>0;)u.options.remove(0);Object.entries(t.recurring).forEach((h,g)=>{const m=document.createElement("option");m.value=h[0],m.text=h[1],u.appendChild(m)}),document.querySelector("#reminder_length").value=1,t.length===1&&(U.value=t[0].id)})},be=()=>{ye.classList.add("hidden"),W.classList.remove("hidden"),document.querySelector('[name="calendar_day"]').value=null,document.querySelector('[name="calendar_month"]').value=null,document.querySelector('input[name="calendar_year"]').value=null,document.querySelector('select[name="calendar_id"]').value=null},tt=()=>{const n=document.querySelector("#reminder_month");n&&n.addEventListener("change",function(e){const i=n.options[n.selectedIndex].dataset.length;en(i)})},en=n=>{let e=parseInt(N.value);n=parseInt(n),e>n&&(e=n),N.innerHTML="";for(let t=1;t<=n;t++){const i=document.createElement("option");i.text=t,i.value=t,t==e&&(i.selected=!0),N.appendChild(i)}};Zt();const nt=document.querySelector("dialog#edit-warning"),we=300*1e3;let tn=document.querySelector('input[name="edit-warning"]'),it,_e=!0;const nn=()=>{nt&&(window.openDialog("edit-warning",tn.dataset.url),window.onEvent(function(){sn()}),on())};function sn(){_e=!1;const n=document.getElementById("entity-edit-warning-ignore");n.addEventListener("click",function(e){e.preventDefault(),_e=!0,axios.post(n.dataset.url).then(()=>{nt.close()})})}const on=()=>{const n=document.getElementById("editing-keep-alive");n&&(it=n.dataset.url,setTimeout(xe,we))},xe=()=>{if(!_e){setTimeout(xe,we);return}axios.post(it).then(()=>{setTimeout(xe,we)})};window.onReady(()=>{nn()});let J,st,ot,ne;const Ee=()=>{st=document.querySelector("#qq-modal-loading"),ot=document.querySelector("#qq-modal-selection"),ne=document.querySelector("#qq-modal-form"),document.querySelectorAll('[data-toggle="entity-creator"]').forEach(n=>{n.addEventListener("click",rn)})},rn=n=>{var i;n.preventDefault();const e=n.currentTarget;return e.dataset.type==="inline"?(document.querySelector(".quick-creator-body").classList.add("hidden"),(i=document.querySelector(".quick-creator-footer"))==null||i.classList.add("hidden"),document.querySelector(".quick-creator-loading").classList.remove("!hidden")):ln(),axios.get(e.dataset.url).then(s=>{st.classList.add("!hidden"),ot.classList.add("!hidden"),ne.innerHTML=s.data,ne.classList.remove("!hidden"),Te(),Ce(),window.triggerEvent()}),!1},rt=()=>{const n=document.querySelector("#qq-name-field");!n||n.dataset.init==="1"||(n.dataset.init="1",n.addEventListener("focusout",function(){if(!this.value)return;const e=this.parentNode.querySelector(".duplicate-entity-warning");e.classList.add("hidden");const t=this.dataset.live+"?q="+this.value+"&type="+this.dataset.type;axios.get(t).then(i=>{if(i.data.length===0){e.classList.add("hidden");return}const s=Object.keys(i.data).map(function(o){return'<a href="'+i.data[o].url+'">'+i.data[o].name+"</a>"}).join(", ");n.parentNode.querySelector(".duplicate-entities").innerHTML=s,e.classList.remove("hidden")})}))},ln=()=>{document.querySelector("#qq-modal-form").classList.add("!hidden"),document.querySelector("#qq-modal-selection").classList.add("!hidden"),document.querySelector("#qq-modal-loading").classList.remove("!hidden")},Te=()=>{J=document.querySelectorAll(".quick-creator-submit"),J.length!==0&&(rt(),Ce(),J.forEach(n=>{n.addEventListener("click",function(e){let t=this.value;return t&&(document.querySelector('#entity-creator-form [name="action"]').value=t),!0})}),document.getElementById("entity-creator-form").onsubmit=function(n){const e=n.target;n.preventDefault(),J.forEach(s=>s.classList.add("btn-disabled","loading")),document.querySelectorAll("div.text-error").forEach(s=>s.remove());const i=new FormData(e);axios.post(e.getAttribute("action"),i).then(s=>{var r,a;if(typeof s.data=="object"){if(s.data.redirect){window.location.replace(s.data.redirect);return}let u=new Option(s.data._name,s.data._id),c=document.querySelector("#"+s.data._target);if(s.data._multi){let m=c.value;m.push(s.data._id),c.appendChild(u),c.value=m}else{for(;c.options.length>0;)c.options.remove(0);c.appendChild(u),c.value=s.data._id}c.dispatchEvent(new Event("change"));const h=document.querySelector("#qq-modal-form");h&&(h.innerHTML="",h.classList.remove("!hidden")),(r=document.querySelector("#qq-modal-loading"))==null||r.classList.add("!hidden"),(a=document.querySelector("#qq-modal-selection"))==null||a.classList.remove("!hidden"),document.getElementById("primary-dialog").close(),ke();return}let o=document.getElementById("qq-modal-form");o.innerHTML=s.data,window.triggerEvent(),Ee(),ke()}).catch(s=>{s.response&&window.formErrorHandler(s.response,e),J.forEach(o=>o.classList.remove("btn-disabled","loading")),document.querySelector('#entity-creator-form [name="action"]').value=""})})},Ce=()=>{var n;document.querySelectorAll(".qq-mode-toggle").forEach(e=>{e.addEventListener("click",function(t){var i;t.preventDefault(),!this.classList.contains("active")&&(document.querySelector(".qq-mode-toggle").classList.remove("active"),this.classList.add("active"),document.querySelector(".quick-creator-body").classList.add("hidden"),(i=document.querySelector(".quick-creator-footer"))==null||i.classList.add("hidden"),document.querySelector(".quick-creator-loading").classList.remove("!hidden"),axios.get(this.dataset.url).then(s=>{ne.innerHTML=s.data,ne.classList.remove("!hidden"),ke(),window.triggerEvent()}))})}),(n=document.querySelector(".qq-action-more"))==null||n.addEventListener("click",function(e){e.preventDefault(),this.classList.add("hidden"),document.querySelector(".qq-more-fields").classList.remove("hidden")}),Ee()},ke=()=>{Ce(),rt(),Te()},an=()=>{document.querySelectorAll(".quick-creator-subform").forEach(e=>{e.addEventListener("click",t=>{window.openDialog("primary-dialog",e.dataset.url)})})};window.onEvent(function(){Ee(),Te()});an();const lt=()=>{const n=document.querySelectorAll("[data-bulk-action]");n==null||n.forEach(t=>{t.addEventListener("click",i=>{i.preventDefault(),dn(t.dataset.bulkAction)})});const e=document.querySelectorAll(".bulk-print");e==null||e.forEach(t=>{t.addEventListener("click",i=>{i.preventDefault(),t.closest("form").requestSubmit()})})},cn=()=>{un();const n=document.querySelectorAll("input[name='model[]']");n==null||n.forEach(e=>{e.addEventListener("change",t=>{t.preventDefault(),qe()})})},un=()=>{const n=document.querySelector("#datagrid-select-all");n&&n.dataset.loaded!=="1"&&(n.dataset.loaded="1",n.addEventListener("click",function(e){const t=document.querySelectorAll("input[name='model[]']");n.checked?t==null||t.forEach(i=>{i.checked=!0}):t==null||t.forEach(i=>{i.checked=!1}),qe()}))},dn=n=>{let e=[];const t=document.querySelectorAll("input[name='model[]']");t==null||t.forEach(i=>{i.checked&&e.push(i.value)}),n==="ajax"?window.onEvent(function(){document.querySelector('#primary-dialog input[name="models"]').value=e.toString()}):document.querySelector("#datagrid-bulk-"+n+"-models").value=e.toString()},qe=()=>{let n=!0;const e=document.querySelectorAll("input[name='model[]']");e==null||e.forEach(i=>{i.checked&&(n=!1)});const t=document.querySelectorAll(".datagrid-bulk-actions .btn2");t==null||t.forEach(i=>{n?(i.disabled=!0,i.classList.add("btn-disabled")):(i.disabled=!1,i.classList.remove("btn-disabled","disabled"))})},fn=()=>{const n=document.querySelector(".list-treeview");if(!n)return;let e=n.dataset.url;document.querySelectorAll(".table-nested > tbody > tr").forEach(function(i){let s=i.dataset.children;parseInt(s)>0&&(i.classList.add("tr-hover"),i.classList.add("cursor-pointer"),i.addEventListener("click",function(o){const r=o.target;o.target.type!=="checkbox"&&r.dataset.tree!=="escape"&&(window.location=e+"?parent_id="+i.dataset.id+"&m=table")}))})};cn();lt();qe();fn();window.onEvent(function(){lt()});let Z;const hn=new IntersectionObserver(function(n){n.forEach(e=>{e.isIntersecting===!0&&Ae(e.target)})},{threshold:[0]}),at=()=>{const n=document.querySelectorAll('table[data-render="datagrid2"]');n==null||n.forEach(e=>{Ae(e)})},Ae=n=>{n.dataset.initiated!=="1"&&(n.dataset.initiayed="1",mn(n),pn(n),n.dataset.url&&Le(n,n))},mn=n=>{var e,t;(e=n.querySelectorAll("thead a"))==null||e.forEach(i=>{i.dataset.loaded!=="1"&&(i.dataset.loaded="1",i.addEventListener("click",function(s){s.preventDefault(),Le(i,n)}))}),(t=n.parentNode.querySelectorAll('nav[role="navigation"] a'))==null||t.forEach(i=>{i.dataset.loaded!=="1"&&(i.dataset.loaded="1",i.addEventListener("click",s=>{s.preventDefault(),Le(i,n)}))})},gn=()=>{const n=document.querySelectorAll('[data-render="datagrid2-onload"]');n.length!==0&&n.forEach(e=>{hn.observe(e)})},Le=(n,e)=>{var i,s,o;(i=e.querySelector("thead"))==null||i.classList.add("hidden"),(s=e.querySelector("tbody"))==null||s.classList.add("hidden"),(o=e.querySelector("tfoot"))==null||o.classList.remove("hidden");let t=n.getAttribute("href");n.dataset.url&&(t=n.dataset.url),e.parentNode&&axios.get(t).then(r=>{const a=e.parentNode;r.data.html&&(a.innerHTML=r.data.html),r.data.deletes&&(document.querySelector("#datagrid-delete-forms").innerHTML=r.data.deletes),r.data.url&&window.history.pushState({},"",r.data.url);const u=a.querySelector('[data-render="datagrid2"]');Ae(u),window.triggerEvent()}).catch(r=>{console.error("datagrid2 error",e,e.parentNode)})},pn=n=>{var s;const e=n.parentNode,t=e.querySelectorAll(".datagrid-bulk");t==null||t.forEach(o=>{vn(n,o)});const i=e.querySelectorAll(".datagrid-submit");i==null||i.forEach(o=>{o.addEventListener("click",function(r){var u;r.preventDefault(),Z=o.closest("form");const a=Z.querySelector('input[name="action"]');if(a.value=o.dataset.action,o.dataset.action==="delete")return window.openDialog("datagrid-bulk-delete"),!1;(u=n.parentNode.querySelectorAll(".datagrid-bulk-actions .btn2"))==null||u.forEach(c=>c.classList.add("btn-disabled")),n.parentNode.querySelector(".datagrid-bulk-actions .btn2").classList.add("loading"),Z.submit()})}),(s=document.querySelector("#datagrid-action-confirm"))==null||s.addEventListener("click",function(){window.closeDialog("datagrid-bulk-delete"),Z.submit()})},vn=(n,e)=>{e.dataset.loaded!=="1"&&(e.dataset.loaded="1",e.addEventListener("click",function(t){t.preventDefault(),Z=n.closest("form"),axios.post(Z.getAttribute("action")+"?action=edit",{model:yn(n)}).done(i=>{const s=document.getElementById("primary-dialog");s.innerHTML=i.data,window.openDialog("primary-dialog"),window.triggerEvent()})}))},yn=n=>{let e=[];const t=n.querySelectorAll("input[name='model[]']");return t==null||t.forEach(i=>{i.checked&&e.push(i.value)}),e};gn();at();window.onEvent(function(){at()});const ct=()=>{document.querySelectorAll('[data-animate="collapse"]').forEach(t=>{t.addEventListener("click",bn)}),document.querySelectorAll('[data-animate="reveal"]').forEach(t=>{t.addEventListener("change",wn)})};function bn(n){let e=this.dataset.target;e||(e=this.hash),document.querySelectorAll(e).forEach(i=>{i.classList.toggle("hidden")}),this.classList.toggle("animate-collapsed")}function wn(n){let e=document.querySelector(this.dataset.target);this.value?e.classList.remove("hidden"):e.classList.add("hidden")}window.onEvent(function(){ct()});ct();const _n=()=>{const n=document.getElementById("bookmark-selector");if(!n)return!1;n.addEventListener("change",function(e){e.preventDefault();let t=n.options[n.selectedIndex];document.querySelectorAll(".bookmark-subform").forEach(o=>{o.classList.add("hidden")});let s=document.querySelector(t.dataset.target);s&&s.classList.remove("hidden")})},xn=()=>{const n=document.getElementById("entity-selector");if(n)n.value!==""&&document.getElementById("filter-subform").style.removeProperty("display");else return!1;n.addEventListener("change",function(){n.value===""?document.getElementById("filter-subform").style.display="none":document.getElementById("filter-subform").style.removeProperty("display")})};_n();xn();const kn=()=>{let n=document.getElementById("webhook-selector");if(!n)return!1;n.addEventListener("change",function(e){var i;e.preventDefault();let t=this.options[this.selectedIndex];document.querySelector(".webhook-subform").classList.add("hidden"),(i=document.querySelector(t.dataset.target))==null||i.classList.remove("hidden")})};kn();window.onEvent(function(){ut()});const ut=()=>{document.querySelectorAll(".form-members").forEach(e=>{if(e.dataset.loaded===1)return;e.dataset.loaded=1;let t=e.dataset.allowClear;$(e).select2({tags:!0,allowClear:t||!0,minimumInputLength:2,ajax:{quietMillis:500,delay:500,url:e.dataset.url,dataType:"json",data:function(i){var s;return{q:(s=i.term)==null?void 0:s.trim()}},processResults:function(i){return{results:i}},cache:!0},createTag:function(){}})})};ut();const Ln=()=>{if(!document.getElementById("campaign-modules"))return;document.querySelectorAll('input[name="enabled"]').forEach(function(t){Sn(t)})},Sn=n=>{n.addEventListener("change",function(e){e.preventDefault(),n.closest(".toggle").classList.add("!hidden"),n.closest(".box-module").querySelector(".action-loading").classList.remove("hidden"),axios.post(n.dataset.url).then(t=>{n.closest(".toggle").classList.remove("!hidden"),n.closest(".box-module").querySelector(".action-loading").classList.add("hidden"),t.data.success&&(t.data.status?n.closest(".box-module").classList.add("module-enabled"):n.closest(".box-module").classList.remove("module-enabled"),window.showToast(t.data.toast))})})},En=()=>{document.querySelectorAll(".public-permission").forEach(e=>{e.addEventListener("click",Tn)})},Tn=n=>{n.preventDefault();let e=n.currentTarget;e.querySelector(".module-icon").classList.add("hidden"),e.querySelector(".loading-animation").classList.remove("hidden"),axios.post(e.dataset.url).then(t=>{e.querySelector(".module-icon").classList.remove("hidden"),e.querySelector(".loading-animation").classList.add("hidden"),t.data.success&&(t.data.status?e.classList.add("enabled"):e.classList.remove("enabled"),window.showToast(t.data.toast))})},Cn=()=>{document.querySelectorAll(".codemirror").forEach(function(e){CodeMirror.fromTextArea(document.getElementById(e.id),{extraKeys:{"Ctrl-Space":"autocomplete"},lineNumbers:!0,lineWrapping:!0,theme:"dracula"})})},qn=()=>{let n=[].slice.call(document.querySelectorAll(".nested-sortable"));for(let e=0;e<n.length;e++)new Fe(n[e],{group:"nested",handle:".dnd-handle",animation:150,fallbackOnBody:!0,swapThreshold:.65,onMove:function(t,i){let s=t.dragged,r=t.related.parentNode.closest(".fixed-position")!=null;return!(s.classList.contains("fixed-position")&&r)}})},An=()=>{const n=document.querySelector("form#campaign-style");n&&n.addEventListener("submit",function(e){let t=document.querySelector(n.dataset.error);return document.querySelector('textarea[name="content"]').value.length<n.dataset.maxContent?(t.classList.add("hidden"),!0):(t.classList.remove("hidden"),e.preventDefault(),!1)})},Mn=()=>{const n=document.querySelector('input[name="vanity"]');n&&n.addEventListener("focusout",function(e){let t=this.value,i=document.getElementById("vanity-error"),s=document.getElementById("vanity-success"),o=document.getElementById("vanity-loading");if(i.innerHTML="",i.classList.add("hidden"),s.classList.add("hidden"),!t)return;s.classList.remove("hidden");let r={};r.vanity=t,axios.post(this.dataset.url,r).then(a=>{n.value=a.data.vanity,s.querySelector("code").innerHTML=a.data.vanity,i.classList.add("hidden"),o.classList.add("hidden"),s.classList.remove("hidden")}).catch(a=>{let u="";a.response.data.errors.vanity.forEach(c=>u+=c+" "),i.innerHTML=u,i.classList.remove("hidden"),s.classList.add("hidden"),o.classList.add("hidden")})})},In=()=>{document.querySelectorAll(".permission-toggle").forEach(e=>{e.addEventListener("change",function(t){let i=this.dataset.action;document.querySelectorAll('input[data-action="'+i+'"]').forEach(o=>{this.checked?o.checked=!0:o.checked=!1})})})};Ln();Cn();qn();En();An();Mn();In();const dt=()=>{document.querySelectorAll("[data-clipboard]").forEach(e=>{e.addEventListener("click",Dn,!1)})};function Dn(n){n.preventDefault(),jn(this.dataset.clipboard,this);let e=this.dataset.toast;return e&&window.showToast(e),!1}async function jn(n,e){if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(n);else{const t=document.createElement("textarea");t.value=n,t.style.position="absolute",t.style.left="-999999px",e.append(t),t.select();try{document.execCommand("copy")}catch(i){console.error(i)}finally{t.remove()}}}dt();window.onEvent(function(){dt()});const ft=()=>{document.querySelectorAll('.toast-container [data-toggle="dismiss"]').forEach(e=>{e.dataset.init!=="1"&&(e.dataset.init="1",e.addEventListener("click",function(t){t.preventDefault();let i=e.closest(".toast-message");i.classList.remove("opacity-100"),i.classList.add("opacity-0"),setTimeout(function(){i.remove()},150)}))})};window.showToast=function(n,e){e=e||"bg-success text-success-content",e==="error"&&(e="bg-error text-error-content");const t=document.createElement("div");t.classList.add("opacity-100","duration-150","transition-opacity","rounded"),e&&e.split(" ").forEach(s=>{t.classList.add(s)}),t.innerHTML='<div class="toast-message p-2 flex gap-2 items-center"><span class="grow"> '+n+'</span><span class="flex-none"><i class="fa-regular fa-circle-xmark cursor-pointer " data-toggle="dismiss"></i></span></div>',document.querySelector(".toast-container").appendChild(t),setTimeout(function(){t.classList.remove("opacity-100"),t.classList.add("opacity-0"),setTimeout(function(){t.remove()},150)},3e3),ft()};ft();const Hn=()=>{document.querySelectorAll(".banner-notification-dismiss").forEach(n=>{n.addEventListener("click",Pn,!1)}),document.querySelectorAll('[data-dismiss="tutorial"]').forEach(n=>{n.addEventListener("click",Nn,!1)})};function Pn(n){n.preventDefault();let e=this.dataset.dismiss;axios.post(this.dataset.url).then(()=>{if(!e)return;let t=document.querySelector(e);t&&t.classList.add("hidden")})}function Nn(n){n.preventDefault();let e=this.dataset.target;axios.post(this.dataset.url).then(()=>{if(!e)return;let t=document.querySelector(e);t&&t.classList.add("hidden")})}Hn();let ht;const Bn=()=>{const n=document.getElementById("element-era-id");n&&(ht=n.value,n.addEventListener("change",function(){Rn(n.value)}))},Rn=n=>{n=parseInt(n);let e=document.querySelector('input[name="era-data-url"]').dataset.url.replace("/0/","/"+n+"/"),t=document.querySelector('input[name="oldPosition"]').dataset.url;axios.get(e).then(i=>{let s=document.querySelector('select[name="position"]');s.innerHTML="";let o=1;Object.entries(i.data.positions).forEach(function(a,u){const c=document.createElement("option");c.text=a[1],t&&!u&&ht==n&&(c.value=1,s.appendChild(c)),u&&(c.value=o,s.appendChild(c)),o++})})};Bn();window.initSortable=function(){let n=document.querySelectorAll(".sortable-elements");n.length!==0&&n.forEach(e=>{let t={},i=e.dataset.handle;i&&(t.handle=i),Fe.create(e,t)})};window.initSortable();window.formErrorHandler=function(n,e){document.querySelectorAll(".input-error").forEach(c=>{c.classList.remove("input-error")});const i=document.querySelector(".text-error");i&&i.remove();const s=e.querySelector(".btn-primary");if(s&&(s.disabled=!1,s.classList.remove("loading")),n.status===503){window.showToast(n.data.message,"error");return}if(n.status===403){document.querySelector("#entity-form-403-error").classList.remove("hidden");return}if(!n.data.errors){window.showToast("Backend error","error");return}const o=n.data.errors;let r=[];const a=Object.keys(o);let u=!0;a.forEach(function(c){let h=document.querySelector('[name="'+c+'"]');if(h){h.classList.add("input-error");const g=document.createElement("div");g.classList.add("text-error"),g.innerHTML=o[c][0],h.parentNode.append(g)}else u=!1,r.push(o[c][0]);window.showToast(o[c][0],"error")}),!u&&genericError&&(genericError.innerHTML="",r.forEach(function(c){genericError.append(c)}),document.querySelector("#entity-form-generic-error").classList.remove("hidden")),Fn(e,o)};const Fn=(n,e)=>{const t=Object.keys(e)[0],i=n.querySelector('[name="'+t+'"]');if(!i)return;if(!n.querySelector(".tab-content")){Be(i);return}document.querySelector(".tab-content .active").classList.remove("active"),document.querySelector(".nav-tabs li.active").classList.remove("active");const s=document.querySelector('[name="'+t+'"').closest(".tab-pane");s&&(s.classList.add("active"),document.querySelector('a[href="#'+s.id+'"]').closest("li").classList.add("active")),Be(i)},Be=n=>{n.focus(),n.scrollIntoView({behavior:"smooth"})};window.onEvent(function(){mt()});const mt=()=>{document.querySelectorAll('[data-toggle="private"]').forEach(e=>{On(e)})},On=n=>{n.dataset.togglerinit!=="1"&&(n.dataset.togglerinit="1",n.addEventListener("click",function(e){const t=n.previousElementSibling;n.classList.contains("fa-lock-keyhole")?(n.classList.remove("fa-lock-keyhole","fa-solid"),n.classList.add("fa-unlock-keyhole","fa-regular"),n.setAttribute("title",n.dataset.public),t.value=0):(n.classList.remove("fa-unlock-keyhole","fa-regular"),n.classList.add("fa-lock-keyhole","fa-solid"),n.setAttribute("title",n.dataset.private),t.value=1)}))},Qn=()=>{const n=document.querySelector('input[data-toggle="entity-privacy"]');n&&n.addEventListener("change",function(){let e=document.getElementById("entity-is-private");this.checked?e.classList.remove("hidden"):e.classList.add("hidden")})};mt();Qn();const zn={class:"mx-5"},Un=["data-title"],Kn=l("svg",{class:"h-6 w-6 transition-all duration-150 hover:rotate-45","data-sidebar":"collapse",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 50 50"},[l("path",{d:"M 7.71875 6.28125 L 6.28125 7.71875 L 23.5625 25 L 6.28125 42.28125 L 7.71875 43.71875 L 25 26.4375 L 42.28125 43.71875 L 43.71875 42.28125 L 26.4375 25 L 43.71875 7.71875 L 42.28125 6.28125 L 25 23.5625 Z"})],-1),Wn=l("svg",{class:"h-6 w-6 transition-all duration-150 hover:rotate-90","data-sidebar":"expand",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 50 50"},[l("path",{d:"M 0 9 L 0 11 L 50 11 L 50 9 Z M 0 24 L 0 26 L 50 26 L 50 24 Z M 0 39 L 0 41 L 50 41 L 50 39 Z"})],-1),Vn={class:"sr-only"},$n=Se({__name:"NavToggler",props:{text:null,title:null},setup(n){const e=n,t=()=>{const o=document.querySelector("body");o.classList.contains("sidebar-collapse")?(o.classList.remove("sidebar-collapse"),i(!1)):(o.classList.add("sidebar-collapse"),i(!0))},i=o=>{let r=new Date;const a=90;r.setTime(r.getTime()+a*24*60*60*1e3);let u=" expires="+r.toGMTString(),c=location.protocol==="https:"?"secure; ":"";document.cookie="toggleState="+(o?"collapsed":"open")+"; path=/; "+c+"samesite=lax; "+u},s=()=>{let r=new RegExp("toggleState=([^;]+)").exec(document.cookie);(r!=null?decodeURI(r[1]):null)==="collapsed"&&document.querySelector("body").classList.add("sidebar-collapse")};return Oe(()=>{s()}),(o,r)=>(d(),f("div",zn,[l("span",{role:"button",class:"sidebar-toggle text-center cursor-pointer fill-current hover:text-primary-focus","data-toggle":"tooltip","data-title":e.title,"data-placement":"right","data-html":"true",tabindex:"3",onClick:r[0]||(r[0]=a=>t())},[Kn,Wn,l("span",Vn,p(e.text),1)],8,Un)]))}}),Yn={props:["entity"],methods:{backgroundImage:function(n){return"url('"+n.image+"')"},preview:function(n){this.emitter.emit("preview",n)}}},Gn=["data-id"],Xn={class:"flex-none"},Zn=["href","title"],Jn={class:"flex-grow truncate pl-1"},ei=["title","innerHTML"],ti=["innerHTML"];function ni(n,e,t,i,s,o){return d(),f("div",{class:"flex justify-center gap-1 cursor-pointer hover:bg-base-200 rounded w-full","data-id":t.entity.id,onClick:e[1]||(e[1]=r=>o.preview(t.entity))},[l("div",Xn,[l("a",{href:t.entity.link,style:Q({backgroundImage:o.backgroundImage(t.entity)}),onClick:e[0]||(e[0]=pe(()=>{},["stop"])),title:t.entity.name,class:"rounded cover-background block h-16 w-16"},null,12,Zn)]),l("div",Jn,[l("div",{class:"font-extrabold entity-name truncate",title:t.entity.name,innerHTML:t.entity.name},null,8,ei),l("div",{class:"entity-type text-xs",innerHTML:t.entity.type},null,8,ti)])],8,Gn)}const gt=X(Yn,[["render",ni]]),ii={props:["entity"],components:{LookupEntity:gt},data(){return{focus_profile:!0,focus_pins:!1,focus_access:!1}},methods:{hasTitle(){return this.entity.title},tagClass(n){let e="inline-block rounded-xl px-3 py-1 bg-base-100 text-base-content text-xs";return n.colour&&(e+=" bg-"+n.colour,n.colour==="black"&&(e+=" text-white")),e},backgroundImage:function(){return"url('"+this.entity.image+"')"},tabClass:function(n){let e="p-1 px-1 mx-1 pt-2 select-none text-center truncate border-b-2 border-solid border-r-0 border-t-0 border-l-0";return n==="profile"&&this.focus_profile||n==="links"&&this.focus_pins||n==="access"&&this.focus_access?e+=" font-black border-slate-600":e+=" cursor-pointer border-base-100",e},switchTab:function(n){this.focus_profile=!1,this.focus_pins=!1,this.focus_access=!1,n==="profile"?this.focus_profile=!0:n==="links"?this.focus_pins=!0:n==="access"&&(this.focus_access=!0)},profileClass:function(n){return"entity-profile-"+n.slug}}},si={class:"entity-header p-3 bg-entity-focus"},oi={class:"w-full flex items-center"},ri=["href","title","innerHTML"],li={key:0,class:"fa-solid fa-skull mx-2","aria-hidden":"true"},ai=["href"],ci=l("i",{class:"fa-solid fa-external-link","aria-hidden":"true","aria-label":"Open in a new window"},null,-1),ui=[ci],di=["innerHTML"],fi={key:1,class:"my-1 w-full flex flex-wrap gap-1"},hi=["href","data-tag-id","data-tag-slug","innerHTML"],mi=["href","data-tag"],gi=l("i",{class:"fa-duotone circle-location-arrow","aria-hidden":"true","aria-label":"Location"},null,-1),pi=["href","title"],vi={class:"entity-sections"},yi={class:"tabs flex my-2 justify-center items-center border-solid border-slate-600 border-b-2 border-r-0 border-t-0 border-l-0"},bi={key:0,class:"tab-profile p-5 flex flex-col gap-5"},wi={key:0,class:"entity-pinned-attributes flex flex-col gap-3"},_i=["data-attribute","data-target"],xi={class:"inline-block uppercase font-extrabold mr-1"},ki=["innerHTML"],Li={key:1},Si={class:"flex flex-col gap-3"},Ei={class:"uppercase font-extrabold truncate"},Ti={key:1,class:"tab-links p-3"},Ci={key:0,class:"text-center italic"};function qi(n,e,t,i,s,o){const r=Y("LookupEntity");return d(),f(q,null,[l("div",si,[l("div",oi,[l("a",{class:"text-2xl font-extrabold entity-name",href:t.entity.link,title:t.entity.name,innerHTML:t.entity.name},null,8,ri),t.entity.is_dead?(d(),f("i",li)):v("",!0),l("a",{class:"ml-2 text-xs",target:"_blank",href:t.entity.link},ui,8,ai)]),o.hasTitle()?(d(),f("div",{key:0,class:"block w-full",innerHTML:t.entity.title},null,8,di)):v("",!0),t.entity.tags.length>0?(d(),f("div",fi,[(d(!0),f(q,null,j(t.entity.tags,a=>(d(),f("a",{class:L(o.tagClass(a)),href:a.link,"data-tag-id":a.id,"data-tag-slug":a.slug,innerHTML:a.name},null,10,hi))),256))])):v("",!0),t.entity.location?(d(),f("a",{key:2,class:"block w-full cursor-pointer my-2",href:t.entity.location.link,"data-tag":t.entity.id},[gi,P(" "+p(t.entity.location.name),1)],8,mi)):v("",!0),t.entity.image?(d(),f("a",{key:3,href:t.entity.link,style:Q({backgroundImage:o.backgroundImage()}),title:t.entity.name,class:"rounded cover-background block w-full aspect-square"},null,12,pi)):v("",!0)]),l("div",vi,[l("div",yi,[l("div",{class:L(o.tabClass("profile")),onClick:e[0]||(e[0]=a=>o.switchTab("profile"))},p(t.entity.texts.profile),3),l("div",{class:L(o.tabClass("links")),onClick:e[1]||(e[1]=a=>o.switchTab("links"))},p(t.entity.texts.connections),3),l("div",{class:L(o.tabClass("access")),onClick:e[2]||(e[2]=a=>o.switchTab("access"))},null,2)]),s.focus_profile?(d(),f("div",bi,[t.entity.attributes.length>0?(d(),f("div",wi,[(d(!0),f(q,null,j(t.entity.attributes,a=>(d(),f("div",{class:"","data-attribute":a.name,"data-target":a.id},[l("span",xi,p(a.name),1),l("span",{innerHTML:a.value},null,8,ki)],8,_i))),256))])):v("",!0),t.entity.attributes.length>0?(d(),f("hr",Li)):v("",!0),l("div",Si,[(d(!0),f(q,null,j(t.entity.profile,a=>(d(),f("div",{class:L(["",o.profileClass(a)])},[l("div",Ei,p(a.field),1),l("div",null,p(a.value),1)],2))),256))])])):v("",!0),s.focus_pins?(d(),f("div",Ti,[(d(!0),f(q,null,j(t.entity.connections,a=>(d(),V(r,{entity:a},null,8,["entity"]))),256)),t.entity.connections.length===0?(d(),f("p",Ci,p(t.entity.texts["no-connections"]),1)):v("",!0)])):v("",!0)])],64)}const Ai=X(ii,[["render",qi]]),Mi={directives:{clickOutside:Ue.directive},props:{api_lookup:String,api_recent:String,placeholder:String,keyboard_tooltip:String},components:{LookupEntity:gt,EntityPreview:Ai},data(){return{has_drawer:!1,term:null,show_loading:!1,show_recent:!1,show_preview:!1,show_results:!1,show_bookmarks:!1,recent:[],bookmarks:[],indexes:[],results:[],cached:{},has_recent:!1,texts:{},timeout_id:null,preview_entity:null}},watch:{term(n,e){this.termChanged()}},methods:{termChanged(){this.term.trim().length<3||(this.timeout_id!==void 0&&clearTimeout(this.timeout_id),this.show_loading=!0,this.timeout_id=setTimeout(()=>this.lookup(),500))},lookup(){let n=this.term.trim(),e=n.toLowerCase().replace(/ /g,"-").replace(/ [^\w-]+/g,"");if(this.cached[e])return this.displayCached(e);fetch(this.api_lookup+"?"+new URLSearchParams({q:n,v2:!0})).then(t=>t.json()).then(t=>this.parseLookupResponse(t,e))},focus(){this.api_recent&&(this.show_preview=!1,this.has_drawer=!0,this.fetch())},escape(){this.timeout_id!==void 0&&clearTimeout(this.timeout_id),this.close()},fetch(){if(this.has_recent){this.show_recent=!0;return}this.show_loading=!0,fetch(this.api_recent).then(n=>n.json()).then(n=>{this.recent=n.recent,this.bookmarks=n.bookmarks,this.indexes=n.indexes,this.texts.recents=n.texts.recents,this.texts.results=n.texts.results,this.texts.hint=n.texts.hint,this.texts.bookmarks=n.texts.bookmarks,this.texts.index=n.texts.index,this.texts.keyboard=n.texts.keyboard,this.texts.empty_results=n.texts.empty_results,this.texts.fulltext=n.texts.fulltext,this.texts.fulltext_route=n.fulltext_route,this.show_loading=!1,this.show_recent=!0,this.has_recent=!0,this.bookmarks.length>0?this.show_bookmarks=!0:this.show_bookmarks=!1}).catch(n=>{this.show_loading=!1,this.show_recent=!0,this.has_recent=!1})},parseLookupResponse(n,e){this.results=n.entities,this.cached[e]=n.entities,this.showResults()},displayCached(n){this.results=this.cached[n],this.showResults()},showResults(){this.timeout_id=null,this.show_preview=!1,this.show_loading=!1,this.show_results=!0},loadPreview(n){this.show_loading=!0,fetch(n.preview).then(e=>e.json()).then(e=>this.parsePreviewResponse(e))},parsePreviewResponse(n){this.preview_entity=n,this.show_loading=!1,this.show_preview=!0,this.show_recent=!1},onClickOutside(n){this.close()},close(){this.show_recent=!1,this.show_loading=!1,this.show_preview=!1,this.$refs.searchField.blur()},showBookmarks(){this.show_bookmarks=!0},searchFullTextUrl(){return`${this.texts.fulltext_route}?term=${this.term}`},showIndexes(){this.show_bookmarks=!1},modeClass(n){return n&&this.show_bookmarks||!n&&!this.show_bookmarks?" underline":""}},mounted(){this.emitter.on("preview",n=>{this.loadPreview(n)})}},Ii={class:"flex grow mr-2"},Di={class:"relative grow field flex items-center"},ji=["placeholder"],Hi={class:"absolute right-1 hidden md:inline"},Pi=["data-title"],Ni={key:0,class:"search-drawer absolute top-0 left-0 mt-12 h-sidebar w-sidebar bg-navbar bg-base-100 shadow-r overflow-y-auto"},Bi={key:0,class:"text-center"},Ri=l("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true","aria-label":"Loading"},null,-1),Fi=[Ri],Oi={key:1,class:"search-recent bg-lookup p-2 min-h-full shadow-r flex flex-col items-stretch"},Qi={key:0,class:"flex-none"},zi={class:"italic text-xs text-center"},Ui={class:"grow flex flex-col gap-5 p-2"},Ki={key:0,class:"search-results flex flex-col gap-2"},Wi={class:"text-sm uppercase"},Vi={key:0,class:"text-neutral-content text-sm"},$i=["href"],Yi={key:1,class:"recent-searches flex flex-col gap-2"},Gi={class:"text-sm uppercase"},Xi={key:2,class:"flex gap-5 justify-center"},Zi={key:3,class:"flex flex-col gap-4"},Ji=["href","title"],es=["innerHTML"],ts={key:4,class:"flex flex-col gap-4"},ns=["href","title"],is=["innerHTML"],ss={key:1,class:"flex-none text-xs text-center"},os=l("hr",null,null,-1),rs=["innerHTML"],ls={key:2,class:"search-preview bg-lookup min-h-full shadow-r"};function as(n,e,t,i,s,o){const r=Y("LookupEntity"),a=Y("EntityPreview"),u=Qe("click-outside");return te((d(),f("div",Ii,[l("div",Di,[te(l("input",{type:"text",class:"leading-4 w-20 md:w-full",maxlength:"25",ref:"searchField",id:"entity-lookup","onUpdate:modelValue":e[0]||(e[0]=c=>s.term=c),onClick:e[1]||(e[1]=c=>o.focus()),onFocus:e[2]||(e[2]=c=>o.focus()),onKeydown:e[3]||(e[3]=qt(c=>o.escape(),["esc"])),placeholder:t.placeholder},null,40,ji),[[ve,s.term]]),l("span",Hi,[l("span",{class:"flex-none keyboard-shortcut py-1",id:"lookup-kb-shortcut","data-toggle":"tooltip","data-title":t.keyboard_tooltip,"data-html":"true","data-placement":"bottom"}," K ",8,Pi)])]),s.show_recent||s.show_loading||s.show_preview?(d(),f("aside",Ni,[s.show_loading?(d(),f("div",Bi,Fi)):v("",!0),s.show_recent?(d(),f("div",Oi,[s.show_results?v("",!0):(d(),f("div",Qi,[l("p",zi,p(s.texts.hint),1)])),l("div",Ui,[s.show_results?(d(),f("div",Ki,[l("div",Wi,p(s.texts.results),1),s.results.length===0?(d(),f("div",Vi,p(s.texts.empty_results),1)):(d(!0),f(q,{key:1},j(s.results,c=>(d(),V(r,{entity:c},null,8,["entity"]))),256)),l("a",{class:"grow text-sm uppercase hover:underline",href:o.searchFullTextUrl()},p(s.texts.fulltext),9,$i)])):v("",!0),s.recent.length>0?(d(),f("div",Yi,[l("div",Gi,p(s.texts.recents),1),(d(!0),f(q,null,j(s.recent,c=>(d(),V(r,{entity:c},null,8,["entity"]))),256))])):v("",!0),s.bookmarks.length>0?(d(),f("div",Xi,[s.bookmarks.length>0?(d(),f("button",{key:0,class:L(["grow text-sm uppercase hover:underline",this.modeClass(!0)]),onClick:e[4]||(e[4]=c=>o.showBookmarks())},p(s.texts.bookmarks),3)):v("",!0),l("button",{class:L(["grow text-sm uppercase hover:underline",this.modeClass(!1)]),onClick:e[5]||(e[5]=c=>o.showIndexes())},p(s.texts.index),3)])):v("",!0),s.show_bookmarks?(d(),f("div",Zi,[(d(!0),f(q,null,j(s.bookmarks,c=>(d(),f("a",{href:c.url,onClick:e[6]||(e[6]=pe(()=>{},["stop"])),title:c.text,class:"flex gap-2 items-center"},[l("i",{class:L(["w-4",c.icon]),"aria-hidden":"true"},null,2),l("span",{innerHTML:c.text},null,8,es)],8,Ji))),256))])):(d(),f("div",ts,[(d(!0),f(q,null,j(s.indexes,c=>(d(),f("a",{href:c.url,onClick:e[7]||(e[7]=pe(()=>{},["stop"])),title:c.name,class:"flex gap-2 items-center"},[l("i",{class:L(["w-4 text-center",c.icon]),"aria-hidden":"true"},null,2),l("span",{innerHTML:c.name},null,8,is)],8,ns))),256))]))]),s.show_loading?v("",!0):(d(),f("div",ss,[os,l("p",{class:"italic text-xs text-center",innerHTML:s.texts.keyboard},null,8,rs)]))])):v("",!0),s.show_preview?(d(),f("div",ls,[ee(a,{entity:s.preview_entity},null,8,["entity"])])):v("",!0)])):v("",!0)])),[[u,o.onClickOutside]])}const cs=X(Mi,[["render",as]]),us={props:["campaign"],methods:{backgroundImage:function(n){return n.image?"url("+n.image+")":""},campaignClass:function(n){return"campaign flex items-end border border-solid rounded-lg cover-background relative h-24 overflow-hidden text-break shadow-xs hover:shadow-md border-0"+(n.is_boosted?" boosted":"")}}},ds=["href","title"],fs=["innerHTML"];function hs(n,e,t,i,s,o){return d(),f("a",{class:L(o.campaignClass(t.campaign)),href:t.campaign.url,style:Q({backgroundImage:o.backgroundImage(t.campaign)}),title:t.campaign.name},[l("div",{class:"flex items-end justify-center name w-full text-xs p-2 pt-6 text-center",innerHTML:t.campaign.name},null,8,fs)],14,ds)}const ms=X(us,[["render",hs]]),gs={props:["notification"],data(){return{is_dismissed:!1,is_loading:!1}},methods:{backgroundClass:function(n){let e="notification bg-base-200 flex justify-center items-center p-2 rounded-md";return n.is_read?e:e+" unread"},iconClass:function(n){return"fa-solid fa-"+n.icon},dismiss:function(n){this.is_loading=!0,axios.post(n.dismiss).then(()=>{this.is_dismissed=!0,this.emitter.emit("read_notification",n)})}}},ps=["data-id"],vs={class:"flex-none p-2"},ys=["innerHTML","href"],bs=["title"],ws=l("i",{class:"fa-solid fa-times","aria-hidden":"true"},null,-1),_s=[ws],xs={key:1,class:"flex-none p-2"},ks=l("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1),Ls=[ks],Ss=["data-id"],Es={class:"flex-none p-2"},Ts=["innerHTML"],Cs=["title"],qs=l("i",{class:"fa-solid fa-times","aria-hidden":"true"},null,-1),As=[qs],Ms={key:1,class:"flex-none p-2"},Is=l("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1),Ds=[Is];function js(n,e,t,i,s,o){return t.notification.url&&!s.is_dismissed?(d(),f("div",{key:0,class:L(o.backgroundClass(t.notification)),"data-id":t.notification.id},[l("div",vs,[l("i",{class:L(o.iconClass(t.notification)),"aria-hidden":"true"},null,2)]),l("a",{class:"flex-grow p-2 break-all",innerHTML:t.notification.text,href:t.notification.url},null,8,ys),this.is_loading?(d(),f("div",xs,Ls)):(d(),f("div",{key:0,class:"flex-none p-2 cursor-pointer dismissable",onClick:e[0]||(e[0]=r=>o.dismiss(t.notification)),title:t.notification.dismiss_text},_s,8,bs))],10,ps)):s.is_dismissed?v("",!0):(d(),f("div",{key:1,class:L(o.backgroundClass(t.notification)),"data-id":t.notification.id},[l("div",Es,[l("i",{class:L(o.iconClass(t.notification)),"aria-hidden":"true"},null,2)]),l("div",{class:"flex-grow p-2",innerHTML:t.notification.text},null,8,Ts),this.is_loading?(d(),f("div",Ms,Ds)):(d(),f("div",{key:0,class:"flex-none p-2 cursor-pointer dismissable",onClick:e[1]||(e[1]=r=>o.dismiss(t.notification)),title:t.notification.dismiss_text},As,8,Cs))],10,Ss))}const Hs=X(gs,[["render",js]]),Ps={props:["release"],data(){return{is_dismissed:!1,is_loading:!1}},methods:{backgroundClass:function(n){return"release bg-base-200 flex justify-center items-center p-2  rounded-md"},dismiss:function(n){this.is_loading=!0,axios.post(n.dismiss).then(()=>{this.is_dismissed=!0,this.emitter.emit("read_release",n)})}}},Ns=["data-id"],Bs={class:"flex-grow p-2"},Rs=["innerHTML","href"],Fs=["innerHTML"],Os=["title"],Qs=l("i",{class:"fa-solid fa-times","aria-hidden":"true"},null,-1),zs=[Qs],Us={key:1,class:"flex-none p-2"},Ks=l("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1),Ws=[Ks];function Vs(n,e,t,i,s,o){return s.is_dismissed?v("",!0):(d(),f("div",{key:0,class:L(o.backgroundClass(t.release)),"data-id":t.release.id},[l("div",Bs,[l("a",{innerHTML:t.release.title,class:"font-bold cursor-pointer block w-full",href:t.release.url,target:"_blank"},null,8,Rs),l("p",{innerHTML:t.release.text},null,8,Fs)]),this.is_loading?(d(),f("div",Us,Ws)):(d(),f("div",{key:0,class:"flex-none p-2 cursor-pointer dismissable",onClick:e[0]||(e[0]=r=>o.dismiss(t.release)),title:t.release.dismiss_text},zs,8,Os))],10,Ns))}const $s=X(Ps,[["render",Vs]]),Ys=l("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[l("g",{transform:"translate(-219.000000, -200.000000)",fill:"currentcolor"},[l("g",{id:"icons",transform:"translate(56.000000, 160.000000)"},[l("path",{d:"M181.9,54 L179.8,54 C178.63975,54 177.7,54.895 177.7,56 L177.7,58 C177.7,59.105 178.63975,60 179.8,60 L181.9,60 C183.06025,60 184,59.105 184,58 L184,56 C184,54.895 183.06025,54 181.9,54 M174.55,54 L172.45,54 C171.28975,54 170.35,54.895 170.35,56 L170.35,58 C170.35,59.105 171.28975,60 172.45,60 L174.55,60 C175.71025,60 176.65,59.105 176.65,58 L176.65,56 C176.65,54.895 175.71025,54 174.55,54 M167.2,54 L165.1,54 C163.93975,54 163,54.895 163,56 L163,58 C163,59.105 163.93975,60 165.1,60 L167.2,60 C168.36025,60 169.3,59.105 169.3,58 L169.3,56 C169.3,54.895 168.36025,54 167.2,54 M181.9,47 L179.8,47 C178.63975,47 177.7,47.895 177.7,49 L177.7,51 C177.7,52.105 178.63975,53 179.8,53 L181.9,53 C183.06025,53 184,52.105 184,51 L184,49 C184,47.895 183.06025,47 181.9,47 M174.55,47 L172.45,47 C171.28975,47 170.35,47.895 170.35,49 L170.35,51 C170.35,52.105 171.28975,53 172.45,53 L174.55,53 C175.71025,53 176.65,52.105 176.65,51 L176.65,49 C176.65,47.895 175.71025,47 174.55,47 M167.2,47 L165.1,47 C163.93975,47 163,47.895 163,49 L163,51 C163,52.105 163.93975,53 165.1,53 L167.2,53 C168.36025,53 169.3,52.105 169.3,51 L169.3,49 C169.3,47.895 168.36025,47 167.2,47 M181.9,40 L179.8,40 C178.63975,40 177.7,40.895 177.7,42 L177.7,44 C177.7,45.105 178.63975,46 179.8,46 L181.9,46 C183.06025,46 184,45.105 184,44 L184,42 C184,40.895 183.06025,40 181.9,40 M174.55,40 L172.45,40 C171.28975,40 170.35,40.895 170.35,42 L170.35,44 C170.35,45.105 171.28975,46 172.45,46 L174.55,46 C175.71025,46 176.65,45.105 176.65,44 L176.65,42 C176.65,40.895 175.71025,40 174.55,40 M169.3,42 L169.3,44 C169.3,45.105 168.36025,46 167.2,46 L165.1,46 C163.93975,46 163,45.105 163,44 L163,42 C163,40.895 163.93975,40 165.1,40 L167.2,40 C168.36025,40 169.3,40.895 169.3,42"})])])],-1),Gs=[Ys],Xs={__name:"GridSvg",props:{size:Number},setup(n){const e=n;function t(){return"w-"+e.size+" h-"+e.size}return(i,s)=>(d(),f("svg",{class:L(t()),viewBox:"0 -0.5 21 21",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true"},Gs,2))}},Zs={directives:{clickOutside:Ue.directive},props:{user_id:{type:String},api:{type:String},fetch:{type:String},initials:{type:String},avatar:{type:String},campaign_id:void 0,has_alerts:{type:Boolean}},components:{GridSvg:Xs,Campaign:ms,Notification:Hs,Release:$s},data(){return{alert_delta:60*1e3,is_loading:!1,is_expanded:!1,has_data:!1,view_campaigns:!1,view_profile:!1,profile:{},campaigns:{},notifications:{},marketplace:{},releases:{},show_alerts:!1,is_loaded:!1}},methods:{openCampaigns:function(){this.view_campaigns=!0,this.view_profile=!1,this.loadData()},openProfile:function(){this.view_profile=!0,this.view_campaigns=!1,this.loadData()},loadData:function(){this.is_expanded=!0,!this.has_data&&(this.is_loading=!0,fetch(this.api).then(n=>n.json()).then(n=>{this.profile=n.profile,this.campaigns=n.campaigns,this.notifications=n.notifications,this.marketplace=n.marketplace,this.releases=n.releases,this.show_alerts=n.has_unread,this.has_data=!0,this.is_loading=!1,this.is_loaded=!0}))},blockClass:function(n){return n?"block p-4 flex-grow items-center focus:box-shadow":"block p-4  items-center bg-base-200 cursor-pointer flex-none focus:box-shadow"},logout:function(){document.getElementById("logout-form").submit()},onClickOutside(n){this.is_expanded=!1},readRelease:function(n){let e=this.releases.releases.findIndex(t=>t.id===n.id);this.releases.releases.slice(e,1),this.updateUnread()},readNotification:function(n){let e=this.notifications.messages.findIndex(t=>t.id==n.id);this.notifications.messages.slice(e,1),this.updateUnread()},updateUnread:function(){this.notifications.messages.length===0&&this.releases.releases.length===0&&(this.show_alerts=!1)},updateAlerts:function(){let n=localStorage.getItem("last_notification-"+this.user_id),t=new Date().getTime()-60*5e3;if(!n||n<t)this.fetchAlerts();else if(this.show_alerts=localStorage.getItem("notification-has-alerts-"+this.user_id)==="true",this.queueFetch(),!this.is_loaded)return},fetchAlerts:function(){let n=new Date().getTime();localStorage.setItem("last_notification-"+this.user_id,n),fetch(this.fetch).then(e=>e.json()).then(e=>{localStorage.setItem("notification-has-alerts-"+this.user_id,e.has_alerts),this.updateAlerts()})},queueFetch:function(){let n=this;setTimeout((function(){n.updateAlerts()}).bind(this),this.alert_delta)},showInitials:function(){return this.avatar.startsWith("/images/")},profilePictureUrl:function(){return"url("+this.avatar+")"}},mounted(){this.emitter.on("read_release",n=>{this.readRelease(n)}),this.emitter.on("read_notification",n=>{this.readNotification(n)}),this.show_alerts=this.has_alerts,this.queueFetch()}},Js={class:"nav-switcher flex items-center justify-center h-12"},eo=l("span",{class:"sr-only"},"Campaigns",-1),to={class:"indicator relative inline-flex w-max"},no={key:0,class:"notification-badge left-auto top-auto w-fit inline-flex absolute content-center items-center z-10"},io={key:1,class:"profile-box rounded-lg p-2 text-center font-bold"},so={key:0,class:"navigation-drawer bg-base-100 h-full overflow-y-auto fixed top-0 right-0 rounded-l-2xl shadow-lg"},oo={key:0,class:"temporary p-8 text-center"},ro=l("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1),lo=[ro],ao={key:1,class:""},co={class:"header flex"},uo={key:0,class:"full flex items-center gap-4"},fo={class:"flex-none"},ho={class:"flex-grow"},mo={class:"font-bold"},go=["title"],po={key:0,class:"full flex items-center gap-4"},vo={key:0,class:"flex-none profile-box rounded-lg p-2 text-center uppercase font-bold"},yo={class:"flex-grow"},bo={class:"font-bold"},wo=["title"],_o={key:0,class:"flex-none profile-box rounded-lg p-2 text-center uppercase font-bold"},xo={key:0,class:"profile p-5 flex flex-col gap-5"},ko={key:0,class:"notifications"},Lo={class:"flex w-full py-2"},So={class:"flex-grow uppercase font-bold"},Eo={class:"flex-grow text-right"},To=["href"],Co={class:"flex flex-col gap-2"},qo={key:0,class:"no-notifications help-block text-neutral-content italic"},Ao={key:1,class:"releases"},Mo={class:"flex w-full py-2"},Io={class:"flex-grow uppercase font-bold"},Do={class:"flex flex-col gap-2"},jo={key:2,class:"marketplace"},Ho={class:"flex w-full py-2"},Po={class:"flex-grow uppercase font-bold"},No={class:"flex-grow text-right"},Bo=["href"],Ro={class:"grid grid-cols-3 gap-2"},Fo=["href"],Oo=l("div",{class:"icon bg-base-200 rounded-full w-14 h-14 text-3xl aspect-square flex justify-center items-center"},[l("i",{class:"fa-solid fa-palette","aria-hidden":"true"})],-1),Qo={class:"text-muted text-xs"},zo=["href"],Uo=l("div",{class:"icon bg-base-200 rounded-full w-14 h-14 text-3xl aspect-square flex justify-center items-center"},[l("i",{class:"fa-solid fa-columns","aria-hidden":"true"})],-1),Ko={class:"text-muted text-xs"},Wo=["href"],Vo=l("div",{class:"icon bg-base-200 rounded-full w-14 h-14 text-3xl aspect-square flex justify-center items-center"},[l("i",{class:"fa-solid fa-dice-d20","aria-hidden":"true"})],-1),$o={class:"text-muted text-xs"},Yo={key:3,class:"subscription"},Go={class:"uppercase font-bold py-2"},Xo=["href"],Zo={class:"flex-none p-2"},Jo=["src","alt"],er={class:"flex-grow p-2"},tr={class:"font-bold text-lg"},nr={key:0,class:"more"},ir=l("br",null,null,-1),sr={key:1,class:"more"},or={class:"link flex gap-1 items-center"},rr=l("i",{class:"fa-duotone fa-credit-card","aria-hidden":"true"},null,-1),lr=l("i",{class:"fa-brands fa-paypal","aria-hidden":"true"},null,-1),ar={key:4,class:"m-0 p-0 list-none flex flex-col gap-2"},cr=["href"],ur=l("i",{class:"fa-solid fa-cog mr-3","aria-hidden":"true"},null,-1),dr=["href"],fr=l("i",{class:"fa-solid fa-user mr-3","aria-hidden":"true"},null,-1),hr=["href"],mr=l("i",{class:"fa-solid fa-question-circle mr-3","aria-hidden":"true"},null,-1),gr=l("i",{class:"fa-solid fa-sign-out mr-3","aria-hidden":"true"},null,-1),pr={key:5,class:"m-0 p-0 list-none flex flex-col gap-2"},vr=["href"],yr=l("i",{class:"fa-solid fa-sign-out-alt mr-3","aria-hidden":"true"},null,-1),br={key:1,class:"campaigns p-5"},wr={key:0,class:"campaigns flex flex-col gap-5"},_r={class:"flex flex-col gap-2"},xr={class:"flex w-full"},kr={class:"flex-grow uppercase font-bold"},Lr={key:0,class:"flex-grow text-right"},Sr=["href"],Er={class:"grid grid-cols-2 md:grid-cols-3 gap-5"},Tr=["href"],Cr={class:"text-xs text-break uppercase"},qr=l("i",{class:"fa-solid fa-plus","aria-hidden":"true",style:{display:"none"}},null,-1),Ar={key:0},Mr={class:"flex flex-col gap-2"},Ir={key:0,class:"uppercase"},Dr={key:1,class:"grid grid-cols-2 md:grid-cols-3 gap-5 following"},jr=["href"],Hr={class:"text-xs uppercase text-break"};function Pr(n,e,t,i,s,o){const r=Y("GridSvg"),a=Y("Notification"),u=Y("Release"),c=Y("Campaign"),h=Qe("click-outside");return d(),f(q,null,[l("div",Js,[l("div",{class:"campaigns inline cursor-pointer text-center px-3 text-2xl hover:text-primary-focus",onClick:e[0]||(e[0]=g=>o.openCampaigns()),"aria-label":"Switch campaigns",tabindex:"0",role:"button"},[ee(r,{size:7}),eo]),l("div",{class:"profile inline cursor-pointer text-center uppercase pt-1",onClick:e[1]||(e[1]=g=>o.openProfile()),"aria-label":"Profile settings",tabindex:"0",role:"button"},[l("div",to,[s.show_alerts?(d(),f("span",no)):v("",!0),o.showInitials()?(d(),f("div",io,p(t.initials),1)):(d(),f("div",{key:2,class:"w-9 h-9 rounded-lg cover-background",style:Q({backgroundImage:o.profilePictureUrl()})},null,4))])])]),s.is_expanded?te((d(),f("div",so,[s.is_loading?(d(),f("div",oo,lo)):(d(),f("div",ao,[l("div",co,[l("div",{class:L(o.blockClass(s.view_campaigns)),onClick:e[2]||(e[2]=g=>o.openCampaigns()),tabindex:"0",role:"button","aria-label":"Campaign list"},[s.view_campaigns?(d(),f("div",uo,[l("div",fo,[ee(r,{size:6})]),l("div",ho,[l("div",mo,p(s.campaigns.texts.campaigns),1),l("div",null,p(s.campaigns.texts.count),1)])])):(d(),f("div",{key:1,class:"flex items-center justify-center h-full",title:s.campaigns.texts.campaigns},[ee(r,{size:6})],8,go))],2),l("div",{class:L(o.blockClass(s.view_profile)),onClick:e[3]||(e[3]=g=>o.openProfile()),tabindex:"0",role:"button","aria-label":"Profile pane"},[s.view_profile?(d(),f("div",po,[o.showInitials()?(d(),f("div",vo,p(t.initials),1)):(d(),f("div",{key:1,class:"flex-none w-9 h-9 rounded-lg cover-background",style:Q({backgroundImage:o.profilePictureUrl()})},null,4)),l("div",yo,[l("div",bo,p(s.profile.name),1),l("div",null,p(s.profile.created),1)])])):(d(),f("div",{key:1,class:"",title:s.profile.your_profile},[o.showInitials()?(d(),f("div",_o,p(t.initials),1)):(d(),f("div",{key:1,class:"flex-none w-9 h-9 rounded-lg cover-background",style:Q({backgroundImage:o.profilePictureUrl()})},null,4))],8,wo))],2)]),s.view_profile?(d(),f("div",xo,[s.notifications.title?(d(),f("div",ko,[l("div",Lo,[l("div",So,p(s.notifications.title),1),l("div",Eo,[l("a",{href:s.notifications.all.url},p(s.notifications.all.text),9,To)])]),l("div",Co,[(d(!0),f(q,null,j(s.notifications.messages,g=>(d(),V(a,{notification:g},null,8,["notification"]))),256))]),s.notifications.messages.length===0?(d(),f("div",qo,p(s.notifications.none),1)):v("",!0)])):v("",!0),s.releases.title&&s.releases.releases.length>0?(d(),f("div",Ao,[l("div",Mo,[l("div",Io,p(s.releases.title),1)]),l("div",Do,[(d(!0),f(q,null,j(s.releases.releases,g=>(d(),V(u,{release:g},null,8,["release"]))),256))])])):v("",!0),!s.profile.is_impersonating&&s.marketplace.title?(d(),f("div",jo,[l("div",Ho,[l("div",Po,p(s.marketplace.title),1),l("div",No,[l("a",{href:s.marketplace.explore.url,target:"_blank"},p(s.marketplace.explore.text),9,Bo)])]),l("div",Ro,[l("a",{href:s.marketplace.themes.url,class:"border py-2 items-center justify-center rounded-md hover:shadow-md flex flex-col gap-1",target:"_blank"},[Oo,l("div",null,p(s.marketplace.themes.title),1),l("div",Qo,p(s.marketplace.themes.number),1)],8,Fo),l("a",{href:s.marketplace.sheets.url,class:"border py-2 items-center justify-center rounded-md hover:shadow-md flex flex-col gap-1",target:"_blank"},[Uo,l("div",null,p(s.marketplace.sheets.title),1),l("div",Ko,p(s.marketplace.sheets.number),1)],8,zo),l("a",{href:s.marketplace.content.url,class:"border py-2 items-center justify-center rounded-md hover:shadow-md flex flex-col gap-1",target:"_blank"},[Vo,l("div",null,p(s.marketplace.content.title),1),l("div",$o,p(s.marketplace.content.number),1)],8,Wo)])])):v("",!0),!s.profile.is_impersonating&&s.profile.subscription?(d(),f("div",Yo,[l("div",Go,p(s.profile.subscription.title),1),l("a",{class:"border rounded-lg flex justify-center items-center hover:shadow-md",href:s.profile.urls.subscription},[l("div",Zo,[l("img",{class:"w-16 h-16",src:s.profile.subscription.image,alt:s.profile.subscription.tier},null,8,Jo)]),l("div",er,[l("div",tr,p(s.profile.subscription.tier),1),s.profile.subscription.tier!=="Kobold"?(d(),f("div",nr,[P(p(s.profile.subscription.created),1),ir,P(" "+p(s.profile.subscription.boosters),1)])):(d(),f("div",sr,[P(p(s.profile.subscription.call_to_action)+" ",1),l("div",or,[P(p(s.profile.subscription.call_to_action_2)+" ",1),rr,lr])]))])],8,Xo)])):v("",!0),s.profile.is_impersonating?(d(),f("ul",pr,[l("li",null,[l("a",{href:s.profile.return.url,class:""},[yr,P(" "+p(s.profile.return.name),1)],8,vr)])])):(d(),f("ul",ar,[l("li",null,[l("a",{href:s.profile.urls.settings.url,class:"p-2 block"},[ur,P(" "+p(s.profile.urls.settings.name),1)],8,cr)]),l("li",null,[l("a",{href:s.profile.urls.profile.url,class:"p-2 block"},[fr,P(" "+p(s.profile.urls.profile.name),1)],8,dr)]),l("li",null,[l("a",{href:s.profile.urls.help.url,class:"p-2 block",target:"_blank"},[mr,P(" "+p(s.profile.urls.help.name),1)],8,hr)]),l("li",null,[l("a",{href:"#",onClick:e[4]||(e[4]=g=>o.logout()),class:"p-2 block"},[gr,P(" "+p(s.profile.urls.logout.name),1)])])]))])):(d(),f("div",br,[s.profile.is_impersonating?v("",!0):(d(),f("div",wr,[l("div",_r,[l("div",xr,[l("div",kr,p(s.campaigns.texts.campaigns),1),s.campaigns.member.length>0?(d(),f("div",Lr,[l("a",{href:s.campaigns.urls.reorder},p(s.campaigns.texts.reorder),9,Sr)])):v("",!0)]),l("div",Er,[(d(!0),f(q,null,j(s.campaigns.member,g=>(d(),V(c,{campaign:g},null,8,["campaign"]))),256)),l("a",{href:s.campaigns.urls.new,class:"new-campaign flex items-center text-center border-dashed border rounded-lg h-24 p-2 overflow-hidden"},[l("span",Cr,[qr,P(" "+p(s.campaigns.texts.new),1)])],8,Tr)])]),s.profile.is_impersonating?v("",!0):(d(),f("hr",Ar)),l("div",Mr,[s.profile.is_impersonating?v("",!0):(d(),f("p",Ir,p(s.campaigns.texts.followed),1)),s.profile.is_impersonating?v("",!0):(d(),f("div",Dr,[(d(!0),f(q,null,j(s.campaigns.following,g=>(d(),V(c,{campaign:g},null,8,["campaign"]))),256)),l("a",{href:s.campaigns.urls.follow,class:"new-campaign flex items-center text-center border-dashed border rounded-lg h-24 p-2 overflow-hidden"},[l("span",Hr,p(s.campaigns.texts.follow),1)],8,jr)]))])]))]))]))])),[[h,o.onClickOutside]]):v("",!0)],64)}const Nr=X(Zs,[["render",Pr]]),Br=Mt(),ie=ze({});ie.config.globalProperties.emitter=Br;ie.component("nav-toggler",$n);ie.component("nav-search",cs);ie.component("nav-switcher",Nr);ie.mount("#header");const Rr={key:0},Fr=l("i",{class:"fa-solid fa-spin fa-spinner2","aria-label":"Loading"},null,-1),Or=[Fr],Qr={class:"bg-base-200 sm:rounded-t"},zr=l("h4",null," Gallery ",-1),Ur=l("i",{class:"fa-regular fa-circle-xmark","aria-hidden":"true"},null,-1),Kr=l("span",{class:"sr-only"},"Close",-1),Wr=[Ur,Kr],Vr={class:"max-w-4xl"},$r={key:0,class:"flex gap-1 w-full"},Yr={class:"grow"},Gr=l("i",{class:"fa-solid fa-grid-2","aria-label":"Large images"},null,-1),Xr=[Gr],Zr=l("i",{class:"fa-solid fa-grid-4","aria-label":"Small images"},null,-1),Jr=[Zr],el={key:1,class:"md:h-36 md:w-80 text-center flex items-center justify-center w-full"},tl=l("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1),nl=[tl],il=["onClick"],sl=["title"],ol=["innerHTML"],rl=["innerHTML"],ll=Se({__name:"Browser",props:{api:null,opened:{type:Boolean}},emits:["selected","closed"],setup(n,{emit:e}){const t=n,i=S(!0),s=S(!1),o=S(),r=S([]),a=S(""),u=S(""),c=S(null),h=S(null),g=300,m=S("large"),k=()=>{i.value=!0,o.value.showModal(),o.value.addEventListener("click",function(y){let b=this.getBoundingClientRect();!(b.top<=y.clientY&&y.clientY<=b.top+b.height&&b.left<=y.clientX&&y.clientX<=b.left+b.width)&&y.target.tagName==="DIALOG"&&w()}),axios.get(t.api).then(y=>{r.value=y.data.images,i.value=!1}).catch(y=>{i.value=!1,y.response.status===403&&(h.value=y.response.data.message)})},w=()=>{o.value.close(),e("closed")},E=y=>(y=y??"",m.value==="large"?"w-48 h-36 "+y:"w-20 h-16 "+y),_=y=>(y=y??"",m.value==="large"?"w-48 "+y:"w-20 text-xs "+y),M=()=>m.value==="small"?"flex flex-wrap gap-2 md:gap-3":"flex flex-wrap gap-2 md:gap-5",B=y=>{if(y.folder){i.value=!0,axios.get(y.url).then(b=>{r.value=b.data.images,i.value=!1});return}e("selected",y),w()};At(()=>t.opened,(y,b)=>{y&&k()});const I=y=>{a.value=y.target.value,c.value&&clearTimeout(c.value),c.value=setTimeout(()=>{D()},g)},D=()=>{u.value!=a.value&&(u.value=a.value,s.value=!0,axios.get(t.api+"?term="+u.value).then(y=>{r.value=y.data.images,s.value=!1}))},F=y=>{m.value=y};return(y,b)=>(d(),f(q,null,[i.value?(d(),f("div",Rr,Or)):v("",!0),l("dialog",{class:"dialog rounded-2xl text-center",id:"gallery-dialog",ref_key:"galleryDialog",ref:o,"aria-modal":"true","aria-labelledby":"modal-card-label"},[l("header",Qr,[zr,l("button",{type:"button",class:"text-base-content",onClick:b[0]||(b[0]=T=>w()),title:"Close"},Wr)]),l("article",Vr,[!i.value&&!h.value?(d(),f("div",$r,[l("div",Yr,[l("input",{type:"text",class:"w-full",placeholder:"Search for an image in the gallery",onInput:I},null,32)]),m.value!=="large"?(d(),f("div",{key:0,class:"flex-none cursor-pointer btn2 btn-ghost btn-sm",onClick:b[1]||(b[1]=T=>F("large"))},Xr)):v("",!0),m.value!=="small"?(d(),f("div",{key:1,class:"flex-none cursor-pointer btn2 btn-ghost btn-sm",onClick:b[2]||(b[2]=T=>F("small"))},Jr)):v("",!0)])):v("",!0),i.value||s.value?(d(),f("div",el,nl)):(d(),f("div",{key:2,class:L(M())},[(d(!0),f(q,null,j(r.value,T=>(d(),f("div",{class:"cursor-pointer shadow rounded overflow-hidden hover:shadow-lg",onClick:Ie=>B(T)},[T.folder?(d(),f("div",{key:1,class:L(E("flex items-center align-middle justify-center text-4xl"))},[l("i",{class:L(T.icon),"aria-label":"Folder"},null,2)],2)):(d(),f("div",{key:0,class:L(E("cover-background")),style:Q({backgroundImage:"url("+T.thumbnail+")"})},null,6)),l("div",{class:L(_("truncate p-2")),title:T.name},[l("span",{innerHTML:T.name},null,8,ol)],10,sl)],8,il))),256)),h.value?(d(),f("div",{key:0,class:"alert alert-error p-2 rounded",innerHTML:h.value},null,8,rl)):v("",!0)],2))])],512)],64))}}),al={key:0},cl=l("i",{class:"fa-solid fa-spin fa-spinner2","aria-label":"Loading"},null,-1),ul=[cl],dl={key:1,class:"flex items-center gap-1"},fl=["accept"],hl={key:2,class:"flex items-center gap-1"},ml={key:0,class:"fa-solid fa-spin fa-spinner","aria-label":"Downloading"},gl={key:3,class:"flex items-center gap-1"},pl={key:0,class:"flex gap-2 flex-col w-full"},vl={class:"progress h-1 w-full"},yl=l("span",{class:"sr-only"},null,-1),bl=[yl],wl=l("span",{class:"grow"},"Cancel",-1),_l=["innerHTML"],xl=["name"],kl={key:2,type:"hidden",name:"remove-image",value:"1"},Ll=Se({__name:"Selection",props:{file:null,url:null,accepts:null,uuid:null,thumbnail:null,browse:null,field:null,old:null},setup(n){const e=n,t=S(!0),i=S(!1),s=S(!1),o=S(),r=S(),a=S(),u=S(),c=S(),h=S(!1),g=S(0),m=S(null);let k;const w=S(null),E=S(!1),_=S(!1);Oe(()=>{t.value=!1,u.value=e.thumbnail,c.value=e.uuid,e.old==="true"&&(E.value=!0)});const M=()=>{let x="relative flex items-end align-middle rounded overflow-hidden";return D()?x+=" cover-background preview-bg w-48 h-36 p-2 ":x+="w-full",x},B=()=>s.value?"hidden":"flex gap-2 flex-col w-full",I=()=>E.value||c.value!==null&&c.value!=="",D=()=>m.value||E.value?!0:c.value!==null&&c.value!=="",F=()=>{c.value=null,u.value=null,E.value&&(E.value=!1,_.value=!0)},y=()=>m.value?"url('"+m.value+"')":u.value?"url('"+u.value+"')":"",b=()=>g.value+"%",T=()=>{h.value=!0},Ie=()=>{!o.value||o.value==k||(i.value=!0,r.value.disabled=!0,k=o.value,axios.post(e.url,{url:o.value}).then(x=>{r.value.disabled=!1,i.value=!1,o.value=null,u.value=x.data.thumbnail,c.value=x.data.uuid}).catch(x=>{r.value.disabled=!1,i.value=!1,r.value.focus(),De(x)}))},Et=async x=>{const C=x.target.files[0];if(!C){s.value=!1;return}const H=new FileReader;H.onload=R=>{m.value=R.target.result},H.readAsDataURL(C),s.value=!0,document.addEventListener("keydown",ce),w.value=axios.CancelToken.source(),a.value.disabled=!0;const He=new FormData;He.append("file",C),axios.post(e.file,He,{headers:{"Content-Type":"multipart/form-data"},cancelToken:w.value.token,onUploadProgress:function(R){g.value=Math.round(R.loaded*100/R.total)}}).then(R=>{s.value=!1,a.value.disabled=!1,a.value=null,u.value=R.data.thumbnail,c.value=R.data.uuid,m.value=null,document.removeEventListener("keydown",ce)}).catch(R=>{s.value=!1,a.value.disabled=!1,m.value=null,axios.isCancel(R)?a.value=null:De(R),document.removeEventListener("keydown",ce)})},De=x=>{if(!x.response)return;if(x.response.data.error){window.showToast(x.response.data.error,"error");return}if(x.response&&x.response.status===403&&x.response.data.message){window.showToast(x.response.data.message,"error");return}Object.keys(x.response.data.errors).forEach(H=>{window.showToast(x.response.data.errors[H][0],"error")})},Tt=x=>{c.value=x.uuid,u.value=x.thumbnail},Ct=()=>{h.value=!1},ce=x=>{x.key==="Escape"&&s.value&&je()},je=x=>{w.value.cancel("Upload canceled by user.")};return(x,C)=>(d(),f(q,null,[t.value?(d(),f("div",al,ul)):(d(),f("div",{key:1,class:L(M()),style:Q({backgroundImage:y()})},[l("div",{class:L(B())},[D()?(d(),f("div",{key:0,class:"rounded p-2 cursor-pointer backdrop-blur backdrop-opacity-30 bg-red-700/50 text-white hover:backdrop-opacity-100 transition",onClick:C[0]||(C[0]=H=>F())}," Remove ")):v("",!0),I()?v("",!0):(d(),f("div",dl,[l("input",{type:"file",accept:e.accepts,class:"w-full",onChange:Et,ref_key:"fileField",ref:a},null,40,fl)])),I()?v("",!0):(d(),f("div",hl,[te(l("input",{ref_key:"urlField",ref:r,type:"text",class:"w-full","onUpdate:modelValue":C[1]||(C[1]=H=>o.value=H),onBlur:C[2]||(C[2]=H=>Ie()),placeholder:"Upload an image from a URL"},null,544),[[ve,o.value]]),i.value?(d(),f("i",ml)):v("",!0)])),I()?v("",!0):(d(),f("div",gl,[l("span",{role:"button",class:"btn2 btn-default btn-sm",onClick:C[3]||(C[3]=H=>T())},"From gallery")]))],2),s.value?(d(),f("div",pl,[l("div",vl,[l("div",{class:"h-1 bg-accent shadow-sm",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100",style:Q({width:b()})},bl,4)]),l("div",{class:"rounded p-2 cursor-pointer backdrop-blur backdrop-opacity-30 bg-red-700/50 text-white hover:backdrop-opacity-100 transition flex items-center gap-2",onClick:C[4]||(C[4]=H=>je())},[wl,l("span",{class:"text-xs flex-none",innerHTML:b()},null,8,_l)])])):v("",!0)],6)),te(l("input",{type:"hidden",name:e.field,"onUpdate:modelValue":C[5]||(C[5]=H=>c.value=H)},null,8,xl),[[ve,c.value]]),_.value?(d(),f("input",kl)):v("",!0),ee(ll,{api:e.browse,opened:h.value,onSelected:Tt,onClosed:Ct},null,8,["api","opened"])],64))}}),pt=()=>{document.querySelectorAll(".gallery-selection").forEach(e=>{const t=ze({});t.component("gallery-selection",Ll),t.mount(e)})};pt();window.onEvent(function(){pt()});const me=Array(),vt=()=>{document.querySelectorAll('[data-toggle="tooltip-ajax"]').forEach(e=>{e.dataset.loaded!=="1"&&(e.dataset.loaded="1",ae(e,{theme:"kanka",placement:e.dataset.direction??"bottom",allowHTML:!0,interactive:!0,delay:500,appendTo:e.dataset.append??document.body,content:'<i class="fa-solid fa-spin fa-spinner" aria-hidden="true" aria-label="loading..." />',arrow:!0,onShow(t){let i=e.dataset.id;if(i&&i in me){t.setContent(me[i]);return}fetch(e.dataset.url).then(s=>s.json()).then(s=>{t.setContent(s[0]),me[i]=s[0]}).catch(s=>{t.setContent(`Failed loading tooltip. ${s}`)})}}))})},yt=()=>{let n=document.querySelectorAll('[data-toggle="tooltip"]');n.forEach(e=>{Re(e)}),n=document.querySelectorAll("[data-tooltip]"),n.forEach(e=>{Re(e)})},Re=n=>{ae(n,{content:n.dataset.title??n.title,theme:"kanka",delay:250,placement:n.dataset.direction??"bottom",allowHTML:n.dataset.html??!1,appendTo:n.dataset.append??document.body,arrow:!0})},bt=()=>{document.querySelectorAll("[data-dropdown]").forEach(e=>{if(e.dataset.loaded==="1")return;let t=e.parentNode.querySelectorAll(".dropdown-menu")[0];e.dataset.loaded="1",ae(e,{content:'<div class="dd-menu flex flex-col gap-1 max-w-2xl">'+t.innerHTML+"</div>",theme:"kanka-dropdown",placement:e.dataset.direction??"bottom",zIndex:890,allowHTML:!0,arrow:!0,interactive:!0,trigger:"click",onShown(i){window.triggerEvent()}})})},Sl=(n,e)=>{ae(n,e).show()};yt();vt();bt();window.initTooltips=yt;window.ajaxTooltip=vt;window.showTooltip=Sl;window.initDropdowns=bt;const wt=()=>{document.querySelectorAll('form[data-maintenance="1"]').forEach(function(e){e.addEventListener("submit",El)})},El=n=>{window.entityFormHasUnsavedChanges=!1,n.preventDefault();const e=n.target;Tl(e);let t=new FormData(e);axios.post(e.getAttribute("action"),t).then(()=>{e.submit()}).catch(i=>{i.response&&window.formErrorHandler(i.response,e),Cl(e)})},Tl=n=>{n.querySelectorAll(".btn-primary").forEach((t,i)=>{i===0&&t.classList.add("loading"),t.classList.add("btn-disabled")})},Cl=n=>{n.querySelectorAll(".btn-primary").forEach(t=>{t.classList.remove("btn-disabled","loading")})};wt();window.onEvent(function(){wt()});window.onEvent(function(){window.initForeignSelect(),window.initTags(),window.initDialogs(),window.initTooltips(),window.ajaxTooltip(),window.initDropdowns(),window.initSortable(),Me(),_t(),kt(),xt(),Lt(),St(),jl()});function ql(){let n=document.getElementById("ad-client");n&&fetch(n.src,{}).catch(()=>{let e=document.getElementById("adblock-plea");e&&e.classList.remove("hidden")})}function _t(){ue.init(),ue({el:".spectrum",format:"hex",alpha:!1,theme:"pill",clearButton:!0,closeButton:!0}),document.querySelectorAll(".spectrum").forEach(n=>{n.dataset.init!=="1"&&(n.dataset.init=1,n.addEventListener("click",function(e){ue({parent:n.dataset.appendTo??".container"})}),n.addEventListener("close",e=>{e.stopPropagation()}))})}const Al=()=>{const n=document.querySelectorAll(".nav-tabs li a");n==null||n.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault();const i=e.closest(".nav-tabs-custom");i.querySelectorAll(".nav-tabs li").forEach(function(o){o.classList.remove("active")}),e.parentNode.classList.add("active"),i.querySelectorAll(".tab-pane").forEach(function(o){o.classList.remove("active")}),document.querySelector(e.getAttribute("href")).classList.add("active")})})},xt=()=>{var n;(n=document.querySelectorAll('[data-img="delete"]'))==null||n.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),document.querySelector("input[name="+e.dataset.target+"]").value=1,e.closest(".preview").classList.add("hidden")})})},Me=()=>{document.querySelectorAll(".pagination-ajax-links a").forEach(function(n){n.dataset.loaded!=="1"&&(n.dataset.loaded="1",n.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(".pagination-ajax-body");t.querySelector(".modal-loading").classList.remove("hidden"),t.querySelector(".pagination-ajax-content").classList.add("hidden"),fetch(n.getAttribute("href")).then(i=>i.text()).then(i=>{t.parentNode.innerHTML=i,Me(),window.triggerEvent()})}))})},kt=()=>{var n,e;(n=document.querySelectorAll('[data-toggle="confirm-delete"]'))==null||n.forEach(function(t){t.dataset.loaded!=="1"&&(t.dataset.loaded="1",t.addEventListener("click",function(i){if(i.preventDefault(),t.dataset.confirming==="1"){t.classList.add("loading"),t.innerHTML="";const s=document.querySelector(t.dataset.target);s?s.requestSubmit():console.error("Unknown target",s);return}t.dataset.confirming="1",t.querySelector("span").classList.add("md:inline"),t.querySelector("span").innerHTML=t.dataset.confirm}))}),(e=document.querySelectorAll('a[data-toggle="delete-form"]'))==null||e.forEach(function(t){t.dataset.loaded!=="1"&&(t.dataset.loaded="1",t.addEventListener("click",function(i){i.preventDefault(),document.querySelector(t.dataset.target).requestSubmit()}))})},Ml=()=>{var n;(n=document.querySelector(".submenu-switcher"))==null||n.addEventListener("change",function(e){e.preventDefault();const t=e.target,i=t.options[t.selectedIndex];window.location.href=i.dataset.route})},Il=()=>{let n=0;const e={window:window.innerHeight,header:document.querySelector("header")?ge(document.querySelector("header")):0,footer:document.querySelector(".main-footer")?ge(document.querySelector(".main-footer")):0,sidebar:document.querySelector(".main-sidebar .sidebar")?ge(document.querySelector(".main-sidebar .sidebar")):0,controlSidebar:n},t=Dl(e),i=document.querySelector(".content-wrapper");t===e.controlSidebar?i.style.minHeight=t:t===e.window?i.style.minHeight=t-e.header-e.footer:i.style.minHeight=t-e.header},ge=(n,e=!1)=>{let t=n.getBoundingClientRect().height;if(e){const i=getComputedStyle(n);t+=parseInt(i.marginTop)+parseInt(i.marginBottom)}return t},Dl=n=>{let e=0;return Object.keys(n).forEach(t=>{n[t]>e&&(e=n[t])}),e},Lt=()=>{document.querySelectorAll(".btn-feedback").forEach(e=>{e.dataset.feedback||(e.dataset.feedback=1,e.addEventListener("click",i=>{i.target.classList.add("loading")},!1))});const n=document.getElementById("quick-privacy-select");n&&n.addEventListener("change",function(){const e=this.dataset.url;axios.post(e).then(t=>{window.showToast(t.data.toast);let i=document.querySelector("body");t.data.status?i.classList.add("kanka-entity-private"):i.classList.remove("kanka-entity-private")})})},St=()=>{document.querySelectorAll("[data-dismisses]").forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();let i=document.querySelector(this.dataset.dismisses);i.classList.remove("opacity-100"),i.classList.add("opacity-0"),setTimeout(function(){i.remove()},150)})})},jl=()=>{const n=document.querySelector(".btn-manage-perm");n&&n.addEventListener("click",function(e){e.preventDefault(),window.closeDialog("primary-dialog");let t=n.dataset.target;document.querySelector(t).click()})};Il();window.initForeignSelect();window.initDialogs();_t();Ml();Al();Rt();Me();kt();xt();Lt();St();ql();
