import"./sortable.esm-be94e56d.js";import{d as u}from"./mention-5d95822d.js";var n=-1e3,s=!1,a;$(document).ready(function(){if(h(),$("#add_attribute_target").length===0)return;c();let i=$("[data-max-fields]");i.length===1&&(s=i.data("max-fields"),a=$(".alert-too-many-fields"))});function c(){var i=$("#add_attribute_target");o(),$(".add_attribute").click(function(t){if(t.preventDefault(),s!==!1)if($("form :input").length+4>s){a.show();return}else a.hide();n-=1;let l=$($(this).data("template")).clone().removeClass("hidden").removeAttr("id"),e=l.html().replace(/\$TMP_ID\$/g,n);return l.html(e).insertBefore(i),o(),u(),!1}),$("#attributes-delete-all-confirm-submit").click(function(t){return t.preventDefault(),$(this).siblings('input[name="delete-all-attributes"]').val(1),$("#entity-attributes-all .attribute_delete").click(),$("#attributes-delete-all-confirm").modal("hide"),a&&a.hide(),$(this).closest("dialog")[0].close(),window.scrollTo({top:0,behavior:"smooth"}),!1}),$.each($('[data-toggle="private"]'),function(){$(this).hasClass("fa-lock")?$(this).prop("title",$(this).data("private")):$(this).prop("title",$(this).data("public"))})}function o(){$.each($(".attribute_delete"),function(){$(this).unbind("click"),$(this).on("click",function(){$(this).parent().parent().remove(),a&&a.hide()})}),$('[data-toggle="private"]').unbind("click").click(function(){$(this).hasClass("fa-lock")?($(this).removeClass("fa-lock").addClass("fa-unlock-alt").prop("title",$(this).data("public")),$(this).prev("input:hidden").val("0"),window.showToast($(this).data("unlock"))):($(this).removeClass("fa-unlock-alt").addClass("fa-lock").prop("title",$(this).data("private")),$(this).prev("input:hidden").val("1"),window.showToast($(this).data("lock")))}),$('[data-toggle="star"]').unbind("click").click(function(){$(this).hasClass("fa-regular")?($(this).removeClass("fa-regular").addClass("fa-solid").prop("title",$(this).data("entry")),$(this).prev("input:hidden").val("1"),window.showToast($(this).data("pin"))):($(this).removeClass("fa-solid").addClass("fa-regular").prop("title",$(this).data("tab")),$(this).prev("input:hidden").val("0"),window.showToast($(this).data("unpin")))})}var r,d;function h(){let i=$('[name="live-attribute-config"]');if(i.length===0)return;r=i.data("live"),d=$("#live-attribute-modal");let t=1;$.each($(".live-edit"),function(){$(this).addClass("live-edit-parsed"),$(this).attr("data-uid",t),t++}),$(".live-edit-parsed").unbind("click").click(function(){let l=$(this).data("id");$(this).data("uid");let e=r+"?id="+l+"&uid="+$(this).data("uid");$(document).on("shown.bs.modal",function(){f()}),window.openDialog("live-attribute-modal",e)})}const f=()=>{d.find("form").submit(function(i){return i.preventDefault(),$.ajax({method:"POST",context:this,url:$(this).attr("action"),data:$(this).serialize()}).done(function(t){d.find("article").html(""),document.getElementById("live-attribute-modal").close();let e=$('[data-uid="'+t.uid+'"]');e.html(t.value),t.value?e.removeClass("empty-value"):e.addClass("empty-value"),window.showToast(t.success)}).fail(function(t){d.find(".modal-content").html(""),d.modal("hide")}),!1})};
